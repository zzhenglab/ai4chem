
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Lecture 3 - SMILES and RDKit &#8212; My sample book</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.8ecb98da25f57f5357bf6f572d296f466b2cfe2517ffebfabe82451661e28f02.css?v=6644e6bb" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js?v=36754332"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'lecture-03';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Lecture 4 - Chemical Structure Identifier" href="lecture-04.html" />
    <link rel="prev" title="Lecture 2 - Pandas and Plotting" href="lecture-02.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/logo.png" class="logo__image only-light" alt="My sample book - Home"/>
    <script>document.write(`<img src="_static/logo.png" class="logo__image only-dark" alt="My sample book - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    Welcome to CHEM 5080: AI for Chemistry
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="lecture-01.html">Lecture 1 - Python Primer</a></li>
<li class="toctree-l1"><a class="reference internal" href="lecture-02.html">Lecture 2 - Pandas and Plotting</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Lecture 3 - SMILES and RDKit</a></li>
<li class="toctree-l1"><a class="reference internal" href="lecture-04.html">Lecture 4 - Chemical Structure Identifier</a></li>
<li class="toctree-l1"><a class="reference internal" href="lecture-05.html">Lecture 5 - Regression and Classification</a></li>
<li class="toctree-l1"><a class="reference internal" href="lecture-06.html">Lecture 6 - Cross-Validation</a></li>
<li class="toctree-l1"><a class="reference internal" href="lecture-07.html">Lecture 7 - Decision Trees and Random Forests</a></li>
<li class="toctree-l1"><a class="reference internal" href="lecture-08.html">Lecture 8 - Neural Networks</a></li>
<li class="toctree-l1"><a class="reference internal" href="lecture-09.html">Lecture 9 - Graph Neural Networks</a></li>
<li class="toctree-l1"><a class="reference internal" href="lecture-10.html">Lecture 10 - Property &amp; Reaction Prediction</a></li>
<li class="toctree-l1"><a class="reference internal" href="lecture-11.html">Lecture 11 - Dimension Reduction for Data Visualization</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book/issues/new?title=Issue%20on%20page%20%2Flecture-03.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/lecture-03.md" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.md</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Lecture 3 - SMILES and RDKit</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#learning-goals">Learning goals</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id1"></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#smiles">1. SMILES</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#atoms">1.1 Atoms</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#bonds">1.2 Bonds</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#branches">1.3 Branches</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#rings">1.4 Rings</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#aromatic-vs-aliphatic">1.5 Aromatic vs aliphatic</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#charges-and-salts">1.6 Charges and salts</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#simple-stereochemistry">1.7 Simple stereochemistry</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#rdkit-quick-start">2. RDKit quick start</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#small-edits-in-rdkit">3. Small edits in RDKit</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#replace-atom-type-by-matching-a-small-molecule">3.1 Replace atom type by matching a small molecule</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#neutralize-a-carboxylate">3.2 Neutralize a carboxylate</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#add-a-methyl-group-with-a-graph-edit">3.3 Add a methyl group with a graph edit</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#why-use-editablemol-instead-of-just-smiles-edits">3.4 Why use <code class="docutils literal notranslate"><span class="pre">EditableMol</span></code> instead of just SMILES edits?</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#canonicalization-and-similarity">4. Canonicalization and similarity</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#canonicalization">4.1 Canonicalization</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#morgan-fingerprints-and-tanimoto">4.2 Morgan fingerprints and Tanimoto</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#bemismurcko-scaffold">4.3 Bemis–Murcko scaffold</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#rdkit-with-pandas">5. RDKit with pandas</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#load-dataset-and-add-molecule-column">5.1 Load dataset and add molecule column</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#canonicalize-smiles-and-compute-descriptors">5.2 Canonicalize SMILES and compute descriptors</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#clean-and-visualize">5.3 Clean and visualize</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#quick-reference">6. Quick reference</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#glossary">7. Glossary</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#in-class-activity">8. In-class activity</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#read-a-smiles-and-inspect">8.1 Read a SMILES and inspect</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#make-a-small-properties-table">8.2 Make a small properties table</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#replace-chlorine-with-fluorine">8.3 Replace chlorine with fluorine</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">8.4 Add a methyl group with a graph edit</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#retrieve-smiles-from-pubchem-draw-structure-then-analyze">8.5 Retrieve SMILES from PubChem Draw structure, then analyze</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#solutions">9. Solutions</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#solution-8-1">Solution 8.1</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#solution-8-2">Solution 8.2</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#solution-8-3">Solution 8.3</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#solution-8-4">Solution 8.4</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="lecture-3-smiles-and-rdkit">
<h1>Lecture 3 - SMILES and RDKit<a class="headerlink" href="#lecture-3-smiles-and-rdkit" title="Link to this heading">#</a></h1>
<blockquote>
<div><p>Start with the SMILES language, practice tiny steps, then use RDKit to draw, edit, and analyze molecules. Finish with PubChem lookups.</p>
</div></blockquote>
<nav class="contents local" id="contents">
<ul class="simple">
<li><p><a class="reference internal" href="#learning-goals" id="id3">Learning goals</a></p></li>
<li><p><a class="reference internal" href="#id1" id="id4">Colab</a></p></li>
<li><p><a class="reference internal" href="#smiles" id="id5">1. SMILES</a></p></li>
<li><p><a class="reference internal" href="#rdkit-quick-start" id="id6">2. RDKit quick start</a></p></li>
<li><p><a class="reference internal" href="#small-edits-in-rdkit" id="id7">3. Small edits in RDKit</a></p></li>
<li><p><a class="reference internal" href="#why-use-editablemol-instead-of-just-smiles-edits" id="id8">3.4 Why use <code class="docutils literal notranslate"><span class="pre">EditableMol</span></code> instead of just SMILES edits?</a></p></li>
<li><p><a class="reference internal" href="#canonicalization-and-similarity" id="id9">4. Canonicalization and similarity</a></p></li>
<li><p><a class="reference internal" href="#rdkit-with-pandas" id="id10">5. RDKit with pandas</a></p></li>
<li><p><a class="reference internal" href="#quick-reference" id="id11">6. Quick reference</a></p></li>
<li><p><a class="reference internal" href="#glossary" id="id12">7. Glossary</a></p></li>
<li><p><a class="reference internal" href="#in-class-activity" id="id13">8. In-class activity</a></p></li>
<li><p><a class="reference internal" href="#solutions" id="id14">9. Solutions</a></p></li>
</ul>
</nav>
<section id="learning-goals">
<h2><a class="toc-backref" href="#id3" role="doc-backlink">Learning goals</a><a class="headerlink" href="#learning-goals" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>Read SMILES strings with confidence: atoms, bonds, branches, rings, aromaticity, charges, simple stereochemistry.</p></li>
<li><p>Use RDKit to parse SMILES, draw structures, add hydrogens, and compute basic properties.</p></li>
<li><p>Make small edits: replace atoms, neutralize groups, split salts, add a methyl group with a graph edit.</p></li>
<li><p>Query PubChem after you can edit molecules locally, then round-trip to SMILES and files.</p></li>
</ul>
</section>
<section id="id1">
<h2><a class="reference external" href="https://colab.research.google.com/drive/184RYVf-aXx2PfOauFp7xw8LIrqJiiWW6?usp=sharing"><img alt="Colab" src="https://img.shields.io/badge/Open-Colab-orange" /></a><a class="headerlink" href="#id1" title="Link to this heading">#</a></h2>
</section>
<section id="smiles">
<h2><a class="toc-backref" href="#id5" role="doc-backlink">1. SMILES</a><a class="headerlink" href="#smiles" title="Link to this heading">#</a></h2>
<p><strong>What is SMILES?</strong></p>
<p>SMILES (Simplified Molecular Input Line Entry System) is a compact way to describe a molecule using only a line of text. It turns molecular structures into strings that are easy for both humans and computers to read.</p>
<p>Each atom is represented by its atomic symbol: <code class="docutils literal notranslate"><span class="pre">C</span></code> for carbon, <code class="docutils literal notranslate"><span class="pre">O</span></code> for oxygen, etc.</p>
<p>Bonds are shown with symbols: single bonds are implicit, <code class="docutils literal notranslate"><span class="pre">=</span></code> is a double bond, <code class="docutils literal notranslate"><span class="pre">#</span></code> is a triple bond.</p>
<p>Branches are placed in parentheses: <code class="docutils literal notranslate"><span class="pre">CC(O)C</span></code> means a side group on the middle carbon.</p>
<p>Ring structures use numbers to show where the ring closes: <code class="docutils literal notranslate"><span class="pre">C1CCCCC1</span></code> is cyclohexane.</p>
<p>Charges, isotopes, and stereochemistry can also be encoded.</p>
<p>Because it’s text, SMILES is great for storing, comparing, and searching molecules in code and databases. RDKit can take a SMILES string, reconstruct the molecule, and let you visualize or analyze it.</p>
<p>For more information: <em>J. Chem. Inf. Comput. Sci.</em> 1988, 28 (1), 31–36 <a class="reference external" href="https://pubs.acs.org/doi/10.1021/ci00057a005"><img alt="Read" src="https://img.shields.io/badge/Read-Paper-blue" /></a></p>
<p>Now, let’s get started!</p>
<p>If you use Colab, run the install cell below first.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Install only if needed</span>
<span class="k">try</span><span class="p">:</span>
    <span class="kn">import</span><span class="w"> </span><span class="nn">rdkit</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">rdkit</span><span class="w"> </span><span class="kn">import</span> <span class="n">Chem</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">rdkit.Chem</span><span class="w"> </span><span class="kn">import</span> <span class="n">Draw</span><span class="p">,</span> <span class="n">Descriptors</span><span class="p">,</span> <span class="n">Crippen</span><span class="p">,</span> <span class="n">rdMolDescriptors</span>
<span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
    <span class="o">%</span><span class="k">pip</span> install rdkit
</pre></div>
</div>
</div>
</div>
<section id="atoms">
<h3>1.1 Atoms<a class="headerlink" href="#atoms" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>Organic set without brackets: <code class="docutils literal notranslate"><span class="pre">B</span> <span class="pre">C</span> <span class="pre">N</span> <span class="pre">O</span> <span class="pre">P</span> <span class="pre">S</span> <span class="pre">F</span> <span class="pre">Cl</span> <span class="pre">Br</span> <span class="pre">I</span></code>.</p></li>
<li><p>Hydrogens are usually implicit.</p></li>
<li><p>Charges or unusual valence use brackets.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Plain strings to focus on notation</span>
<span class="n">ethanol</span> <span class="o">=</span> <span class="s2">&quot;CCO&quot;</span>         <span class="c1"># C-C-O</span>
<span class="n">mol_1</span> <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">MolFromSmiles</span><span class="p">(</span><span class="n">ethanol</span><span class="p">)</span>
<span class="n">Draw</span><span class="o">.</span><span class="n">MolToImage</span><span class="p">(</span><span class="n">mol_1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/17cbd820e91dbefd5c82141c3683d00a2c9b3e3c703d7b3c869aa2eb21ac0d4c.png" src="_images/17cbd820e91dbefd5c82141c3683d00a2c9b3e3c703d7b3c869aa2eb21ac0d4c.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">acetic</span> <span class="o">=</span> <span class="s2">&quot;CC(=O)O&quot;</span>      <span class="c1"># C-C with a double bonded O and an OH</span>
<span class="n">benzene</span> <span class="o">=</span> <span class="s2">&quot;c1ccccc1&quot;</span>    <span class="c1"># aromatic ring</span>

<span class="n">mol_2</span> <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">MolFromSmiles</span><span class="p">(</span><span class="n">acetic</span><span class="p">)</span>
<span class="n">mol_3</span> <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">MolFromSmiles</span><span class="p">(</span><span class="n">benzene</span><span class="p">)</span>

<span class="c1"># Draw both molecules side by side</span>
<span class="n">Draw</span><span class="o">.</span><span class="n">MolsToImage</span><span class="p">([</span><span class="n">mol_2</span><span class="p">,</span> <span class="n">mol_3</span><span class="p">],</span> <span class="n">molsPerRow</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">subImgSize</span><span class="o">=</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span><span class="mi">100</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/007f34e868844dd5b8602a913ef87796ce3dc214ff308fac8298a09bac9ff05a.png" src="_images/007f34e868844dd5b8602a913ef87796ce3dc214ff308fac8298a09bac9ff05a.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">charged1</span> <span class="o">=</span> <span class="s2">&quot;[NH4+]&quot;</span>     <span class="c1"># ammonium</span>
<span class="n">charged2</span> <span class="o">=</span> <span class="s2">&quot;C(=O)[O-]&quot;</span>  <span class="c1"># carboxylate</span>
<span class="n">mol_c1</span> <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">MolFromSmiles</span><span class="p">(</span><span class="n">charged1</span><span class="p">)</span>
<span class="n">mol_c2</span> <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">MolFromSmiles</span><span class="p">(</span><span class="n">charged2</span><span class="p">)</span>

<span class="n">Draw</span><span class="o">.</span><span class="n">MolsToImage</span><span class="p">([</span><span class="n">mol_c1</span><span class="p">,</span> <span class="n">mol_c2</span><span class="p">],</span> <span class="n">molsPerRow</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">subImgSize</span><span class="o">=</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span><span class="mi">100</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/121231efd81fcb2e20f68282c051e0281ea4e934f2b937c3d1db99aac58d1ee8.png" src="_images/121231efd81fcb2e20f68282c051e0281ea4e934f2b937c3d1db99aac58d1ee8.png" />
</div>
</div>
</section>
<section id="bonds">
<h3>1.2 Bonds<a class="headerlink" href="#bonds" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>Single is implied.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">=</span></code> is double.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">#</span></code> is triple.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">single</span> <span class="o">=</span> <span class="s2">&quot;CC&quot;</span>
<span class="n">double</span> <span class="o">=</span> <span class="s2">&quot;C=C&quot;</span>
<span class="n">triple</span> <span class="o">=</span> <span class="s2">&quot;C#N&quot;</span>

<span class="n">mols</span> <span class="o">=</span> <span class="p">[</span><span class="n">Chem</span><span class="o">.</span><span class="n">MolFromSmiles</span><span class="p">(</span><span class="n">bond</span><span class="p">)</span> <span class="k">for</span> <span class="n">bond</span> <span class="ow">in</span> <span class="p">[</span><span class="n">single</span><span class="p">,</span> <span class="n">double</span><span class="p">,</span> <span class="n">triple</span><span class="p">]]</span>

<span class="n">Draw</span><span class="o">.</span><span class="n">MolsToImage</span><span class="p">(</span><span class="n">mols</span><span class="p">,</span> <span class="n">molsPerRow</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">subImgSize</span><span class="o">=</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span><span class="mi">100</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/307fe369a26d5bc6a27ccbbc0c50412f380a8c8613db00262c71442d9c6677b1.png" src="_images/307fe369a26d5bc6a27ccbbc0c50412f380a8c8613db00262c71442d9c6677b1.png" />
</div>
</div>
</section>
<section id="branches">
<h3>1.3 Branches<a class="headerlink" href="#branches" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>Parentheses create side branches.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">isopropanol_a</span> <span class="o">=</span> <span class="s2">&quot;CC(O)CC&quot;</span>
<span class="n">isopropanol_b</span> <span class="o">=</span> <span class="s2">&quot;CC(C)OC&quot;</span>    <span class="c1"># same structure, different order</span>
<span class="nb">print</span><span class="p">(</span><span class="n">isopropanol_a</span><span class="p">,</span> <span class="n">isopropanol_b</span><span class="p">)</span>

<span class="n">mol_a</span> <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">MolFromSmiles</span><span class="p">(</span><span class="n">isopropanol_a</span><span class="p">)</span>
<span class="n">mol_b</span> <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">MolFromSmiles</span><span class="p">(</span><span class="n">isopropanol_b</span><span class="p">)</span>

<span class="n">Draw</span><span class="o">.</span><span class="n">MolsToImage</span><span class="p">([</span><span class="n">mol_a</span><span class="p">,</span> <span class="n">mol_b</span><span class="p">],</span> <span class="n">molsPerRow</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">subImgSize</span><span class="o">=</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span><span class="mi">100</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CC(O)CC CC(C)OC
</pre></div>
</div>
<img alt="_images/ccda69934ec24937b6187bf2611d93d74836be8375a1661a3c607c2045a53665.png" src="_images/ccda69934ec24937b6187bf2611d93d74836be8375a1661a3c607c2045a53665.png" />
</div>
</div>
</section>
<section id="rings">
<h3>1.4 Rings<a class="headerlink" href="#rings" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>Numbers open and close rings.</p></li>
<li><p>Same digit appears twice to close that ring.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cyclohexane</span> <span class="o">=</span> <span class="s2">&quot;C1CCCCC1&quot;</span>
<span class="n">benzene</span> <span class="o">=</span> <span class="s2">&quot;c1ccccc1&quot;</span>
<span class="n">naphthalene</span> <span class="o">=</span> <span class="s2">&quot;c1cccc2c1cccc2&quot;</span>

<span class="n">mols</span> <span class="o">=</span> <span class="p">[</span><span class="n">Chem</span><span class="o">.</span><span class="n">MolFromSmiles</span><span class="p">(</span><span class="n">ring</span><span class="p">)</span> <span class="k">for</span> <span class="n">ring</span> <span class="ow">in</span> <span class="p">[</span><span class="n">cyclohexane</span><span class="p">,</span> <span class="n">benzene</span><span class="p">,</span> <span class="n">naphthalene</span><span class="p">]]</span>

<span class="n">Draw</span><span class="o">.</span><span class="n">MolsToImage</span><span class="p">(</span><span class="n">mols</span><span class="p">,</span> <span class="n">molsPerRow</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">subImgSize</span><span class="o">=</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span><span class="mi">100</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/3238285e95424198a096071f2478091ac6fec527be34b9de33d7105356caa585.png" src="_images/3238285e95424198a096071f2478091ac6fec527be34b9de33d7105356caa585.png" />
</div>
</div>
</section>
<section id="aromatic-vs-aliphatic">
<h3>1.5 Aromatic vs aliphatic<a class="headerlink" href="#aromatic-vs-aliphatic" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>Aromatic atoms are lower case.</p></li>
<li><p>Aliphatic are upper case.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mol_aromatic</span> <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">MolFromSmiles</span><span class="p">(</span><span class="s2">&quot;c1ccccc1&quot;</span><span class="p">)</span>
<span class="n">mol_aliphatic</span> <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">MolFromSmiles</span><span class="p">(</span><span class="s2">&quot;C1CCCCC1&quot;</span><span class="p">)</span>

<span class="n">Draw</span><span class="o">.</span><span class="n">MolsToImage</span><span class="p">([</span> <span class="n">mol_aromatic</span><span class="p">,</span> <span class="n">mol_aliphatic</span><span class="p">],</span> <span class="n">molsPerRow</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">subImgSize</span><span class="o">=</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span><span class="mi">100</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/ee57abd57ca4d2baf6045dd24bafad85b6912868d924f6e0f0d5e910a05a5bb6.png" src="_images/ee57abd57ca4d2baf6045dd24bafad85b6912868d924f6e0f0d5e910a05a5bb6.png" />
</div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>What the digits mean:
A number marks a ring connection. The same digit appears twice on the two atoms that are bonded to each other to close that ring.
For fused systems, you can reuse different digits to show where each ring closes.</p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ring1</span> <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">MolFromSmiles</span><span class="p">(</span><span class="s2">&quot;C1CCC2CCCCC2C1&quot;</span><span class="p">)</span>
<span class="n">ring2</span> <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">MolFromSmiles</span><span class="p">(</span><span class="s2">&quot;C1CC(C)C1&quot;</span><span class="p">)</span>
<span class="n">ring3</span> <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">MolFromSmiles</span><span class="p">(</span><span class="s2">&quot;c1ccc(C2CCCCC2)cc1&quot;</span><span class="p">)</span>
<span class="n">ring4</span> <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">MolFromSmiles</span><span class="p">(</span><span class="s2">&quot;c1ccc(-c2ccc3ccccc3c2)cc1&quot;</span><span class="p">)</span>
<span class="n">ring5</span> <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">MolFromSmiles</span><span class="p">(</span><span class="s2">&quot;C1=CC2C=COC2=C1&quot;</span><span class="p">)</span>
<span class="n">ring6</span> <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">MolFromSmiles</span><span class="p">(</span><span class="s2">&quot;CC(C)c1cccc(C2CC2)c1&quot;</span><span class="p">)</span>

<span class="n">Draw</span><span class="o">.</span><span class="n">MolsToImage</span><span class="p">([</span><span class="n">ring1</span><span class="p">,</span><span class="n">ring2</span><span class="p">,</span> <span class="n">ring3</span><span class="p">,</span> <span class="n">ring4</span><span class="p">,</span> <span class="n">ring5</span><span class="p">,</span> <span class="n">ring6</span><span class="p">],</span> <span class="n">ubImgSize</span><span class="o">=</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span><span class="mi">100</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/d1aedf29a9d6efb7f88179168080e12ec44141e8e709865c2a9ed21bddbca68c.png" src="_images/d1aedf29a9d6efb7f88179168080e12ec44141e8e709865c2a9ed21bddbca68c.png" />
</div>
</div>
</section>
<section id="charges-and-salts">
<h3>1.6 Charges and salts<a class="headerlink" href="#charges-and-salts" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>Use <code class="docutils literal notranslate"><span class="pre">.</span></code> to separate parts in a salt.</p></li>
<li><p>Place charge in brackets on the atom.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">salt</span> <span class="o">=</span> <span class="s2">&quot;C[NH+](C)C.[Cl-]&quot;</span>    <span class="c1"># trimethylammonium chloride</span>
<span class="n">Draw</span><span class="o">.</span><span class="n">MolToImage</span><span class="p">(</span><span class="n">Chem</span><span class="o">.</span><span class="n">MolFromSmiles</span><span class="p">(</span><span class="n">salt</span> <span class="p">),</span> <span class="n">molsPerRow</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">subImgSize</span><span class="o">=</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span><span class="mi">100</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/af72544af30e323af17a477967e7be9cd7f73c9d827ccc3b4cec7755245dad47.png" src="_images/af72544af30e323af17a477967e7be9cd7f73c9d827ccc3b4cec7755245dad47.png" />
</div>
</div>
</section>
<section id="simple-stereochemistry">
<h3>1.7 Simple stereochemistry<a class="headerlink" href="#simple-stereochemistry" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>E and Z for alkenes use slashes.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Cl/C=C/Cl</span></code> is E. <code class="docutils literal notranslate"><span class="pre">Cl/C=C\Cl</span></code> is Z.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mol_E</span> <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">MolFromSmiles</span><span class="p">(</span><span class="s2">&quot;Cl/C=C/Cl&quot;</span><span class="p">)</span>
<span class="n">mol_Z</span> <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">MolFromSmiles</span><span class="p">(</span><span class="s2">&quot;Cl/C=C</span><span class="se">\\</span><span class="s2">Cl&quot;</span><span class="p">)</span>

<span class="n">Draw</span><span class="o">.</span><span class="n">MolsToImage</span><span class="p">([</span> <span class="n">mol_E</span><span class="p">,</span> <span class="n">mol_Z</span><span class="p">],</span> <span class="n">molsPerRow</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">subImgSize</span><span class="o">=</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span><span class="mi">100</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/459975233cd8913ab757705808ff8990d77a219c905b650ae01ed8c46c6a10ec.png" src="_images/459975233cd8913ab757705808ff8990d77a219c905b650ae01ed8c46c6a10ec.png" />
</div>
</div>
<div class="admonition-try admonition">
<p class="admonition-title">Try</p>
<p>Search online SMILES for these and print them:</p>
<ul class="simple">
<li><p>isopropyl alcohol</p></li>
<li><p>benzoate anion</p></li>
<li><p>cyclopropane</p></li>
<li><p>pyridine</p></li>
</ul>
</div>
<div class="admonition-try admonition">
<p class="admonition-title">Try</p>
<p>Search online SMILES for these and print them:</p>
<ul class="simple">
<li><p>isopropyl alcohol</p></li>
<li><p>benzoate anion</p></li>
<li><p>cyclopropane</p></li>
<li><p>pyridine</p></li>
</ul>
</div>
</section>
</section>
<hr class="docutils" />
<section id="rdkit-quick-start">
<h2><a class="toc-backref" href="#id6" role="doc-backlink">2. RDKit quick start</a><a class="headerlink" href="#rdkit-quick-start" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">rdkit</span><span class="w"> </span><span class="kn">import</span> <span class="n">Chem</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">rdkit.Chem</span><span class="w"> </span><span class="kn">import</span> <span class="n">Draw</span><span class="p">,</span> <span class="n">Descriptors</span><span class="p">,</span> <span class="n">Crippen</span><span class="p">,</span> <span class="n">rdMolDescriptors</span>

<span class="n">smi</span> <span class="o">=</span> <span class="s2">&quot;CC(=O)OC1=CC=CC=C1C(=O)O&quot;</span>  <span class="c1"># aspirin</span>
<span class="n">mol</span> <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">MolFromSmiles</span><span class="p">(</span><span class="n">smi</span><span class="p">)</span>
<span class="n">Draw</span><span class="o">.</span><span class="n">MolToImage</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">350</span><span class="p">,</span> <span class="mi">250</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/e0b244388fd46aa368caee33600535024aba671cd2d87d9b2991e0d7e9ba37ee.png" src="_images/e0b244388fd46aa368caee33600535024aba671cd2d87d9b2991e0d7e9ba37ee.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Add hydrogens for clarity</span>
<span class="n">mol_H</span> <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">AddHs</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
<span class="n">Draw</span><span class="o">.</span><span class="n">MolToImage</span><span class="p">(</span><span class="n">mol_H</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">350</span><span class="p">,</span> <span class="mi">250</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/94ea06b951da92be7ef3a18488fc9bf4bfaaa6acd9c946d7918c77ee69866d71.png" src="_images/94ea06b951da92be7ef3a18488fc9bf4bfaaa6acd9c946d7918c77ee69866d71.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Quick properties in one place</span>
<span class="n">mw</span> <span class="o">=</span> <span class="n">Descriptors</span><span class="o">.</span><span class="n">MolWt</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
<span class="n">logp</span> <span class="o">=</span> <span class="n">Crippen</span><span class="o">.</span><span class="n">MolLogP</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
<span class="n">hbd</span> <span class="o">=</span> <span class="n">rdMolDescriptors</span><span class="o">.</span><span class="n">CalcNumHBD</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
<span class="n">hba</span> <span class="o">=</span> <span class="n">rdMolDescriptors</span><span class="o">.</span><span class="n">CalcNumHBA</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
<span class="n">tpsa</span> <span class="o">=</span> <span class="n">rdMolDescriptors</span><span class="o">.</span><span class="n">CalcTPSA</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;MolWt&quot;</span><span class="p">,</span> <span class="nb">round</span><span class="p">(</span><span class="n">mw</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="s2">&quot;LogP&quot;</span><span class="p">,</span> <span class="nb">round</span><span class="p">(</span><span class="n">logp</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="s2">&quot;HBD&quot;</span><span class="p">,</span> <span class="n">hbd</span><span class="p">,</span> <span class="s2">&quot;HBA&quot;</span><span class="p">,</span> <span class="n">hba</span><span class="p">,</span> <span class="s2">&quot;TPSA&quot;</span><span class="p">,</span> <span class="nb">round</span><span class="p">(</span><span class="n">tpsa</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>MolWt 180.16 LogP 1.31 HBD 1 HBA 3 TPSA 63.6
</pre></div>
</div>
</div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><strong>MolWt</strong> → The molecular weight (molar mass) of the compound, measured in grams per mole.</p>
<p><strong>LogP</strong> → The logarithm of the partition coefficient (octanol/water); higher values mean more lipophilic (hydrophobic).</p>
<p><strong>HBD</strong> (Hydrogen Bond Donors) → Atoms (often OH or NH groups) that can donate a hydrogen in hydrogen bonding.</p>
<p><strong>HBA</strong> (Hydrogen Bond Acceptors) → Atoms (such as oxygen or nitrogen) that can accept a hydrogen bond.</p>
<p><strong>TPSA</strong> (Topological Polar Surface Area) → A measure of the molecule’s polar area, correlated with solubility and permeability.</p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Show atom numbers to plan edits</span>
<span class="n">img</span> <span class="o">=</span> <span class="n">Draw</span><span class="o">.</span><span class="n">MolToImage</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">350</span><span class="p">,</span> <span class="mi">250</span><span class="p">),</span> <span class="n">includeAtomNumbers</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">img</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/e0b244388fd46aa368caee33600535024aba671cd2d87d9b2991e0d7e9ba37ee.png" src="_images/e0b244388fd46aa368caee33600535024aba671cd2d87d9b2991e0d7e9ba37ee.png" />
</div>
</div>
<div class="admonition-practice admonition">
<p class="admonition-title">Practice</p>
<p>Change <code class="docutils literal notranslate"><span class="pre">smi</span></code> to caffeine or acetaminophen. Compare MolWt and TPSA.</p>
</div>
</section>
<hr class="docutils" />
<section id="small-edits-in-rdkit">
<h2><a class="toc-backref" href="#id7" role="doc-backlink">3. Small edits in RDKit</a><a class="headerlink" href="#small-edits-in-rdkit" title="Link to this heading">#</a></h2>
<p>We will avoid pattern languages here. We will use plain molecules to find and replace common pieces.</p>
<section id="replace-atom-type-by-matching-a-small-molecule">
<h3>3.1 Replace atom type by matching a small molecule<a class="headerlink" href="#replace-atom-type-by-matching-a-small-molecule" title="Link to this heading">#</a></h3>
<p>Replace all chlorine atoms with fluorine in an aryl chloride.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">rdkit</span><span class="w"> </span><span class="kn">import</span> <span class="n">Chem</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">rdkit.Chem</span><span class="w"> </span><span class="kn">import</span> <span class="n">Draw</span>

<span class="n">qry</span> <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">MolFromSmiles</span><span class="p">(</span><span class="s2">&quot;Cl&quot;</span><span class="p">)</span>     <span class="c1"># what to find</span>
<span class="n">rep</span> <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">MolFromSmiles</span><span class="p">(</span><span class="s2">&quot;F&quot;</span><span class="p">)</span>      <span class="c1"># what to place</span>
<span class="n">mol</span> <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">MolFromSmiles</span><span class="p">(</span><span class="s2">&quot;Clc1ccc(cc1)C(=O)O&quot;</span><span class="p">)</span>

<span class="n">out</span> <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">ReplaceSubstructs</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">qry</span><span class="p">,</span> <span class="n">rep</span><span class="p">,</span> <span class="n">replaceAll</span><span class="o">=</span><span class="kc">True</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">Draw</span><span class="o">.</span><span class="n">MolToImage</span><span class="p">(</span><span class="n">out</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">350</span><span class="p">,</span> <span class="mi">250</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/96a64de8ab6de3cba9bdeb085779432c65dde405ede31f9884814f235d701bda.png" src="_images/96a64de8ab6de3cba9bdeb085779432c65dde405ede31f9884814f235d701bda.png" />
</div>
</div>
</section>
<section id="neutralize-a-carboxylate">
<h3>3.2 Neutralize a carboxylate<a class="headerlink" href="#neutralize-a-carboxylate" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mol</span> <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">MolFromSmiles</span><span class="p">(</span><span class="s2">&quot;CC(=O)[O-]&quot;</span><span class="p">)</span>
<span class="n">find</span> <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">MolFromSmiles</span><span class="p">(</span><span class="s2">&quot;[O-]&quot;</span><span class="p">)</span>  <span class="c1"># anionic oxygen as a molecule</span>
<span class="n">put</span>  <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">MolFromSmiles</span><span class="p">(</span><span class="s2">&quot;O&quot;</span><span class="p">)</span>
<span class="n">mol_neutral</span> <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">ReplaceSubstructs</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">find</span><span class="p">,</span> <span class="n">put</span><span class="p">,</span> <span class="n">replaceAll</span><span class="o">=</span><span class="kc">True</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">Draw</span><span class="o">.</span><span class="n">MolToImage</span><span class="p">(</span><span class="n">mol_neutral</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">320</span><span class="p">,</span> <span class="mi">220</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/c830c8f543f1ff01bdf8936713c61d629e106732a4e22bcb14c2d8933beca490.png" src="_images/c830c8f543f1ff01bdf8936713c61d629e106732a4e22bcb14c2d8933beca490.png" />
</div>
</div>
</section>
<section id="add-a-methyl-group-with-a-graph-edit">
<h3>3.3 Add a methyl group with a graph edit<a class="headerlink" href="#add-a-methyl-group-with-a-graph-edit" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mol</span> <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">MolFromSmiles</span><span class="p">(</span><span class="s2">&quot;c1ccccc1&quot;</span><span class="p">)</span>  <span class="c1"># benzene</span>
<span class="n">em</span> <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">EditableMol</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>

<span class="n">idx_C</span> <span class="o">=</span> <span class="n">em</span><span class="o">.</span><span class="n">AddAtom</span><span class="p">(</span><span class="n">Chem</span><span class="o">.</span><span class="n">Atom</span><span class="p">(</span><span class="s2">&quot;C&quot;</span><span class="p">))</span>
<span class="n">idx_H1</span> <span class="o">=</span> <span class="n">em</span><span class="o">.</span><span class="n">AddAtom</span><span class="p">(</span><span class="n">Chem</span><span class="o">.</span><span class="n">Atom</span><span class="p">(</span><span class="s2">&quot;H&quot;</span><span class="p">))</span>
<span class="n">idx_H2</span> <span class="o">=</span> <span class="n">em</span><span class="o">.</span><span class="n">AddAtom</span><span class="p">(</span><span class="n">Chem</span><span class="o">.</span><span class="n">Atom</span><span class="p">(</span><span class="s2">&quot;H&quot;</span><span class="p">))</span>
<span class="n">idx_H3</span> <span class="o">=</span> <span class="n">em</span><span class="o">.</span><span class="n">AddAtom</span><span class="p">(</span><span class="n">Chem</span><span class="o">.</span><span class="n">Atom</span><span class="p">(</span><span class="s2">&quot;H&quot;</span><span class="p">))</span>

<span class="n">em</span><span class="o">.</span><span class="n">AddBond</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">idx_C</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="n">Chem</span><span class="o">.</span><span class="n">BondType</span><span class="o">.</span><span class="n">SINGLE</span><span class="p">)</span>  <span class="c1"># attach at atom index 2</span>
<span class="n">em</span><span class="o">.</span><span class="n">AddBond</span><span class="p">(</span><span class="n">idx_C</span><span class="p">,</span> <span class="n">idx_H1</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="n">Chem</span><span class="o">.</span><span class="n">BondType</span><span class="o">.</span><span class="n">SINGLE</span><span class="p">)</span>
<span class="n">em</span><span class="o">.</span><span class="n">AddBond</span><span class="p">(</span><span class="n">idx_C</span><span class="p">,</span> <span class="n">idx_H2</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="n">Chem</span><span class="o">.</span><span class="n">BondType</span><span class="o">.</span><span class="n">SINGLE</span><span class="p">)</span>
<span class="n">em</span><span class="o">.</span><span class="n">AddBond</span><span class="p">(</span><span class="n">idx_C</span><span class="p">,</span> <span class="n">idx_H3</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="n">Chem</span><span class="o">.</span><span class="n">BondType</span><span class="o">.</span><span class="n">SINGLE</span><span class="p">)</span>

<span class="n">mol2</span> <span class="o">=</span> <span class="n">em</span><span class="o">.</span><span class="n">GetMol</span><span class="p">()</span>
<span class="n">Chem</span><span class="o">.</span><span class="n">SanitizeMol</span><span class="p">(</span><span class="n">mol2</span><span class="p">)</span>
<span class="n">Draw</span><span class="o">.</span><span class="n">MolToImage</span><span class="p">(</span><span class="n">mol2</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">350</span><span class="p">,</span> <span class="mi">250</span><span class="p">),</span> <span class="n">includeAtomNumbers</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/740e404a58d6f2880b124dcd97f5809abd087f30f63ec0cb3b8dfbdd52f45e1f.png" src="_images/740e404a58d6f2880b124dcd97f5809abd087f30f63ec0cb3b8dfbdd52f45e1f.png" />
</div>
</div>
<div class="admonition-tip admonition">
<p class="admonition-title">Tip</p>
<p>After graph edits, call <code class="docutils literal notranslate"><span class="pre">Chem.SanitizeMol</span></code> to check valence and aromaticity.</p>
</div>
</section>
</section>
<hr class="docutils" />
<section id="why-use-editablemol-instead-of-just-smiles-edits">
<h2><a class="toc-backref" href="#id8" role="doc-backlink">3.4 Why use <code class="docutils literal notranslate"><span class="pre">EditableMol</span></code> instead of just SMILES edits?</a><a class="headerlink" href="#why-use-editablemol-instead-of-just-smiles-edits" title="Link to this heading">#</a></h2>
<p>Text edits to SMILES can hit the wrong atom or make an invalid string. <code class="docutils literal notranslate"><span class="pre">EditableMol</span></code> lets you target an atom index, keep valence correct, and apply the same change across many molecules in a repeatable way.</p>
<p>Now consider below example:
<strong>add a methyl group to atom index 2 across 7 inputs</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">smiles_list</span> <span class="o">=</span> <span class="p">[</span>  
    <span class="s2">&quot;c1ccccc1&quot;</span><span class="p">,</span>            <span class="c1"># benzene</span>
    <span class="s2">&quot;Oc1ccccc1&quot;</span><span class="p">,</span>           <span class="c1"># phenol</span>
    <span class="s2">&quot;Nc1ccccc1&quot;</span><span class="p">,</span>           <span class="c1"># aniline</span>
    <span class="s2">&quot;Clc1ccccc1&quot;</span><span class="p">,</span>          <span class="c1"># chlorobenzene</span>
    <span class="s2">&quot;c1ccncc1&quot;</span><span class="p">,</span>            <span class="c1"># pyridine</span>
    <span class="s2">&quot;O=C(O)c1ccccc1&quot;</span><span class="p">,</span>      <span class="c1"># benzoic acid</span>
    <span class="s2">&quot;OCCc1ccccc1&quot;</span><span class="p">,</span>         <span class="c1"># benzyl alcohol</span>
<span class="p">]</span>  
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">add_methyl</span><span class="p">(</span><span class="n">smi</span><span class="p">):</span>  
    <span class="n">mol</span> <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">MolFromSmiles</span><span class="p">(</span><span class="n">smi</span><span class="p">)</span>  <span class="c1"># parse SMILES to molecule</span>
    <span class="k">if</span> <span class="n">mol</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">mol</span><span class="o">.</span><span class="n">GetNumAtoms</span><span class="p">()</span> <span class="o">&lt;</span> <span class="mi">3</span><span class="p">:</span>  <span class="c1"># quick guard for bad/short inputs</span>
        <span class="k">return</span> <span class="kc">None</span>  <span class="c1"># signal failure</span>
    <span class="n">em</span> <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">EditableMol</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>  <span class="c1"># enter editable graph mode</span>
    <span class="n">c_idx</span> <span class="o">=</span> <span class="n">em</span><span class="o">.</span><span class="n">AddAtom</span><span class="p">(</span><span class="n">Chem</span><span class="o">.</span><span class="n">Atom</span><span class="p">(</span><span class="s2">&quot;C&quot;</span><span class="p">))</span>  <span class="c1"># add the methyl carbon</span>
    <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>  <span class="c1"># add three hydrogens</span>
        <span class="n">h</span> <span class="o">=</span> <span class="n">em</span><span class="o">.</span><span class="n">AddAtom</span><span class="p">(</span><span class="n">Chem</span><span class="o">.</span><span class="n">Atom</span><span class="p">(</span><span class="s2">&quot;H&quot;</span><span class="p">))</span>  <span class="c1"># create a hydrogen atom</span>
        <span class="n">em</span><span class="o">.</span><span class="n">AddBond</span><span class="p">(</span><span class="n">c_idx</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">Chem</span><span class="o">.</span><span class="n">BondType</span><span class="o">.</span><span class="n">SINGLE</span><span class="p">)</span>  <span class="c1"># connect H to C</span>
    <span class="n">em</span><span class="o">.</span><span class="n">AddBond</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">c_idx</span><span class="p">,</span> <span class="n">Chem</span><span class="o">.</span><span class="n">BondType</span><span class="o">.</span><span class="n">SINGLE</span><span class="p">)</span>  <span class="c1"># attach methyl C to atom index 2</span>
    <span class="n">newmol</span> <span class="o">=</span> <span class="n">em</span><span class="o">.</span><span class="n">GetMol</span><span class="p">()</span>  <span class="c1"># exit edit mode</span>
    <span class="n">Chem</span><span class="o">.</span><span class="n">SanitizeMol</span><span class="p">(</span><span class="n">newmol</span><span class="p">)</span>  <span class="c1"># check valence/aromaticity</span>
    <span class="k">return</span> <span class="n">newmol</span>  <span class="c1"># return edited molecule</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">smi</span> <span class="ow">in</span> <span class="n">smiles_list</span><span class="p">:</span>  <span class="c1"># iterate over the 7 SMILES</span>
    <span class="n">mol2</span> <span class="o">=</span> <span class="n">add_methyl</span><span class="p">(</span><span class="n">smi</span><span class="p">)</span>  <span class="c1"># attempt the methyl add</span>
    <span class="n">out</span> <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">MolToSmiles</span><span class="p">(</span><span class="n">mol2</span><span class="p">)</span> <span class="k">if</span> <span class="n">mol2</span> <span class="k">else</span> <span class="s2">&quot;failed&quot;</span>  <span class="c1"># convert to output SMILES or flag</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;IN :&quot;</span><span class="p">,</span> <span class="n">smi</span><span class="p">)</span>  <span class="c1"># show input</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;---------------------&quot;</span><span class="p">)</span>  
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;OUT:&quot;</span><span class="p">,</span> <span class="n">out</span><span class="p">)</span>  <span class="c1"># show output</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;---------------------&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>IN : c1ccccc1
---------------------
OUT: [H]C([H])([H])c1ccccc1
---------------------
IN : Oc1ccccc1
---------------------
OUT: [H]C([H])([H])c1ccccc1O
---------------------
IN : Nc1ccccc1
---------------------
OUT: [H]C([H])([H])c1ccccc1N
---------------------
IN : Clc1ccccc1
---------------------
OUT: [H]C([H])([H])c1ccccc1Cl
---------------------
IN : c1ccncc1
---------------------
OUT: [H]C([H])([H])c1ccccn1
---------------------
IN : O=C(O)c1ccccc1
---------------------
OUT: [H]C([H])([H])OC(=O)c1ccccc1
---------------------
IN : OCCc1ccccc1
---------------------
OUT: [H]C([H])([H])C(CO)c1ccccc1
---------------------
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mols_in</span>  <span class="o">=</span> <span class="p">[</span><span class="n">Chem</span><span class="o">.</span><span class="n">MolFromSmiles</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">smiles_list</span><span class="p">]</span>  <span class="c1"># make inputs as mols</span>
<span class="n">mols_out</span> <span class="o">=</span> <span class="p">[</span><span class="n">add_methyl</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">smiles_list</span><span class="p">]</span>  <span class="c1"># make edited outputs</span>

<span class="n">Draw</span><span class="o">.</span><span class="n">MolsToGridImage</span><span class="p">(</span>  <span class="c1"># draw a grid to compare</span>
    <span class="n">mols_in</span> <span class="o">+</span> <span class="n">mols_out</span><span class="p">,</span>  <span class="c1"># originals then edits</span>
    <span class="n">molsPerRow</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>  <span class="c1"># how many per row</span>
    <span class="n">subImgSize</span><span class="o">=</span><span class="p">(</span><span class="mi">200</span><span class="p">,</span><span class="mi">180</span><span class="p">),</span>  <span class="c1"># image size</span>
    <span class="n">legends</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;in&quot;</span><span class="p">]</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">mols_in</span><span class="p">)</span><span class="o">+</span><span class="p">[</span><span class="s2">&quot;out&quot;</span><span class="p">]</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">mols_out</span><span class="p">),</span>  <span class="c1"># labels</span>
    <span class="n">useSVG</span><span class="o">=</span><span class="kc">True</span>  <span class="c1"># SVG for crisp display</span>
<span class="p">)</span>  <span class="c1"># end drawing</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/53996e732bd6a8177b95fa825d8342d221f338aebbeec9371b41a632a6b6064b.svg" src="_images/53996e732bd6a8177b95fa825d8342d221f338aebbeec9371b41a632a6b6064b.svg" />
</div>
</div>
</section>
<hr class="docutils" />
<section id="canonicalization-and-similarity">
<h2><a class="toc-backref" href="#id9" role="doc-backlink">4. Canonicalization and similarity</a><a class="headerlink" href="#canonicalization-and-similarity" title="Link to this heading">#</a></h2>
<section id="canonicalization">
<h3>4.1 Canonicalization<a class="headerlink" href="#canonicalization" title="Link to this heading">#</a></h3>
<p>SMILES strings are compact and easy to use, but there is a catch: they are not guaranteed to be unique.<br />
The same molecule can be written with different SMILES depending on how the atoms are traversed. This makes it difficult to compare molecules directly.</p>
<p>In the example below we take three different SMILES notations, each of which corresponds to the molecule we have on quiz.<br />
Although the strings differ, the structures are identical once interpreted by RDKit.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">rdkit</span><span class="w"> </span><span class="kn">import</span> <span class="n">Chem</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">rdkit.Chem</span><span class="w"> </span><span class="kn">import</span> <span class="n">Draw</span>

<span class="c1"># Three equivalent SMILES</span>
<span class="n">smile1</span> <span class="o">=</span> <span class="s2">&quot;OCC=CCC(OC)CCC&quot;</span>
<span class="n">smile2</span> <span class="o">=</span> <span class="s2">&quot;COC(CCC)CC=CCO&quot;</span>
<span class="n">smile3</span> <span class="o">=</span> <span class="s2">&quot;CCCC(OC)CC=CCO&quot;</span>

<span class="n">smiles_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">smile1</span><span class="p">,</span> <span class="n">smile2</span><span class="p">,</span> <span class="n">smile3</span><span class="p">]</span>
<span class="n">mols</span> <span class="o">=</span> <span class="p">[</span><span class="n">Chem</span><span class="o">.</span><span class="n">MolFromSmiles</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">smiles_list</span><span class="p">]</span>
<span class="n">Draw</span><span class="o">.</span><span class="n">MolsToGridImage</span><span class="p">(</span><span class="n">mols</span><span class="p">,</span> <span class="n">molsPerRow</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">subImgSize</span><span class="o">=</span><span class="p">(</span><span class="mi">170</span><span class="p">,</span><span class="mi">170</span><span class="p">),</span>
                     <span class="n">legends</span><span class="o">=</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;form </span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">mols</span><span class="p">))])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/915360b2af8fc7c41fa3c2290220d4dbaad117dda069e4db8bdb1193dcccddb1.png" src="_images/915360b2af8fc7c41fa3c2290220d4dbaad117dda069e4db8bdb1193dcccddb1.png" />
</div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Different SMILES strings can represent the same molecule. This is useful for flexibility, but problematic if we want a <strong>unique key</strong> for each compound.<br />
Canonicalization generates a standard SMILES for each molecule, which allows unambiguous comparisons and avoids duplicates.</p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">canonicalize_smiles</span><span class="p">(</span><span class="n">smiles</span><span class="p">):</span>
    <span class="n">m</span> <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">MolFromSmiles</span><span class="p">(</span><span class="n">smiles</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">Chem</span><span class="o">.</span><span class="n">MolToSmiles</span><span class="p">(</span><span class="n">m</span><span class="p">)</span> <span class="k">if</span> <span class="n">m</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="kc">None</span>

<span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">smiles_list</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="s2">&quot; -&gt; &quot;</span><span class="p">,</span> <span class="n">canonicalize_smiles</span><span class="p">(</span><span class="n">s</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>OCC=CCC(OC)CCC  -&gt;  CCCC(CC=CCO)OC
COC(CCC)CC=CCO  -&gt;  CCCC(CC=CCO)OC
CCCC(OC)CC=CCO  -&gt;  CCCC(CC=CCO)OC
</pre></div>
</div>
</div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Canonicalization is not universal: RDKit and Open Babel may output different canonical strings for the same molecule.<br />
The important part is consistency within your workflow—use the same toolkit throughout.</p>
</div>
</section>
<section id="morgan-fingerprints-and-tanimoto">
<h3>4.2 Morgan fingerprints and Tanimoto<a class="headerlink" href="#morgan-fingerprints-and-tanimoto" title="Link to this heading">#</a></h3>
<p>Another way to compare molecules is not by SMILES text but by molecular features.<br />
Fingerprints encode the presence or absence of atom environments in a binary vector. Morgan fingerprints (circular fingerprints) are widely used.</p>
<p>So, what is a fingerprint?</p>
<ul class="simple">
<li><p>Think of a fingerprint as a barcode for a molecule.</p></li>
<li><p>Each bar (or bit) in the barcode answers a yes/no question: Does the molecule contain this feature?</p></li>
</ul>
<p>Example features: “<em>Does it have a benzene ring?</em>”, “<em>Does it have an OH group?</em>”, “<em>Does it have a nitrogen atom with three bonds?</em>”</p>
<p>If the answer is yes, the bit is <code class="docutils literal notranslate"><span class="pre">1</span></code>. If not, it’s <code class="docutils literal notranslate"><span class="pre">0</span></code>.
This gives us a long string of <code class="docutils literal notranslate"><span class="pre">0</span></code>s and 1s that represents the molecule.</p>
<p>That’s said, Morgan fingerprints are a special kind of barcode. They look around each atom in the molecule and record the neighborhood (atoms directly attached, then atoms two steps away, etc.). The “radius” tells how far you look from each atom. Radius 2 means: “look two bonds away.” Morgan fingerprints are popular because they do a good job at capturing local environments around atom.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">rdkit.Chem</span><span class="w"> </span><span class="kn">import</span> <span class="n">rdFingerprintGenerator</span>
<span class="n">mfpgen</span> <span class="o">=</span> <span class="n">rdFingerprintGenerator</span><span class="o">.</span><span class="n">GetMorganGenerator</span><span class="p">(</span><span class="n">radius</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">fpSize</span><span class="o">=</span><span class="mi">512</span><span class="p">)</span>

<span class="n">methane</span> <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">MolFromSmiles</span><span class="p">(</span><span class="s2">&quot;C&quot;</span><span class="p">)</span> <span class="c1"># replace with other SMILES strings to see how it changes!</span>
<span class="n">caffeine</span> <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">MolFromSmiles</span><span class="p">(</span><span class="s2">&quot;Cn1cnc2c1c(=O)n(C)c(=O)n2C&quot;</span><span class="p">)</span>
<span class="n">fp_me</span> <span class="o">=</span> <span class="n">mfpgen</span><span class="o">.</span><span class="n">GetFingerprint</span><span class="p">(</span><span class="n">methane</span><span class="p">)</span>
<span class="n">fp_caff</span> <span class="o">=</span> <span class="n">mfpgen</span><span class="o">.</span><span class="n">GetFingerprint</span><span class="p">(</span><span class="n">caffeine</span><span class="p">)</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">rdkit</span><span class="w"> </span><span class="kn">import</span> <span class="n">DataStructs</span>
<span class="nb">print</span><span class="p">(</span><span class="n">fp_me</span><span class="o">.</span><span class="n">ToBitString</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;----------------&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">fp_caff</span><span class="o">.</span><span class="n">ToBitString</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
----------------
10000000000000000000000000000000010000000000000000001000000000000000000000000000000000000000000000000000000000000000000001000000000000000010000000000000000000001000000000000000000100000000000000000000000000000000000000000000000000000010000000000000000000000001000000000000000000000001000000000000000000000000000000100000000000000010000001000000000000000000100000000000000000000010000001000000000000001000000000000000100010010000100000000000000000000000000000000001000000000000000000000000000001000000000010000000
</pre></div>
</div>
</div>
</div>
<p>We can then measure how similar two fingerprints are with the <strong>Tanimoto coefficient</strong>.</p>
<p>It is one of the most common metrics for comparing chemical fingerprints and it measures how similar two molecules are by comparing their structural features represented as bit-vectors.</p>
<p>In terms of the formula, if we have two bit-vectors <strong>A</strong> and <strong>B</strong>:</p>
<ul class="simple">
<li><p><strong>a</strong> = number of bits set to 1 in <strong>A</strong></p></li>
<li><p><strong>b</strong> = number of bits set to 1 in <strong>B</strong></p></li>
<li><p><strong>c</strong> = number of common bits set to 1 in both <strong>A</strong> and <strong>B</strong></p></li>
</ul>
<p>Then the <strong>Tanimoto similarity</strong> is:</p>
<div class="math notranslate nohighlight">
\[
T(A,B) = \frac{c}{a + b - c}
\]</div>
<hr class="docutils" />
<ul class="simple">
<li><p>The numerator <strong>c</strong> counts the shared features (substructures present in both molecules).</p></li>
<li><p>The denominator counts <strong>all unique features</strong> across both molecules, subtracting the overlap.</p></li>
<li><p>The result ranges between <strong>0 and 1</strong>:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">0</span></code> → no similarity at all.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">1</span></code> → identical fingerprints.</p></li>
</ul>
</li>
</ul>
<hr class="docutils" />
<p>Suppose we compare <strong>caffeine</strong> and <strong>theobromine</strong> with Morgan fingerprints.</p>
<ul class="simple">
<li><p>Caffeine has about 250 “on” bits (features).</p></li>
<li><p>Theobromine has about 240 “on” bits.</p></li>
<li><p>They share about 180 bits.</p></li>
</ul>
<div class="math notranslate nohighlight">
\[
T = \frac{180}{250 + 240 - 180} = \frac{180}{310} \approx 0.58
\]</div>
<p>This means caffeine and theobromine share <strong>58% of their features</strong>.</p>
<p>By contrast, comparing caffeine with <strong>phenol</strong> may yield ~0.15, showing much weaker similarity.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ul class="simple">
<li><p>Tanimoto is equivalent to the <strong>Jaccard index</strong> used in other fields.</p></li>
<li><p>Other similarity measures exist (Dice, Cosine, Hamming), but Tanimoto remains the standard in cheminformatics.</p></li>
<li><p>Choice of fingerprint (Morgan, MACCS, topological) influences the score.</p></li>
</ul>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">rdkit.Chem</span><span class="w"> </span><span class="kn">import</span> <span class="n">rdFingerprintGenerator</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">rdkit.DataStructs</span><span class="w"> </span><span class="kn">import</span> <span class="n">FingerprintSimilarity</span>

<span class="n">caffeine</span> <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">MolFromSmiles</span><span class="p">(</span><span class="s2">&quot;Cn1cnc2c1c(=O)n(C)c(=O)n2C&quot;</span><span class="p">)</span>
<span class="n">theobromine</span> <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">MolFromSmiles</span><span class="p">(</span><span class="s2">&quot;Cn1c(=O)c2[nH]c(nc2n(C)c1=O)C&quot;</span><span class="p">)</span>
<span class="n">phenol</span> <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">MolFromSmiles</span><span class="p">(</span><span class="s2">&quot;c1ccccc1O&quot;</span><span class="p">)</span>

<span class="n">mfpgen</span> <span class="o">=</span> <span class="n">rdFingerprintGenerator</span><span class="o">.</span><span class="n">GetMorganGenerator</span><span class="p">(</span><span class="n">radius</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">fpSize</span><span class="o">=</span><span class="mi">1024</span><span class="p">)</span>

<span class="n">fp_caff</span> <span class="o">=</span> <span class="n">mfpgen</span><span class="o">.</span><span class="n">GetFingerprint</span><span class="p">(</span><span class="n">caffeine</span><span class="p">)</span>
<span class="n">fp_theo</span> <span class="o">=</span> <span class="n">mfpgen</span><span class="o">.</span><span class="n">GetFingerprint</span><span class="p">(</span><span class="n">theobromine</span><span class="p">)</span>
<span class="n">fp_phenol</span> <span class="o">=</span> <span class="n">mfpgen</span><span class="o">.</span><span class="n">GetFingerprint</span><span class="p">(</span><span class="n">phenol</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Caffeine vs theobromine:&quot;</span><span class="p">,</span> <span class="nb">round</span><span class="p">(</span><span class="n">FingerprintSimilarity</span><span class="p">(</span><span class="n">fp_caff</span><span class="p">,</span> <span class="n">fp_theo</span><span class="p">),</span><span class="mi">3</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Caffeine vs phenol     :&quot;</span><span class="p">,</span> <span class="nb">round</span><span class="p">(</span><span class="n">FingerprintSimilarity</span><span class="p">(</span><span class="n">fp_caff</span><span class="p">,</span> <span class="n">fp_phenol</span><span class="p">),</span><span class="mi">3</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Caffeine vs theobromine: 0.389
Caffeine vs phenol     : 0.061
</pre></div>
</div>
</div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Notice how caffeine and theobromine have a high similarity because they share a xanthine core.<br />
Phenol is much less similar since it only shares a benzene ring fragment with caffeine.</p>
</div>
</section>
<section id="bemismurcko-scaffold">
<h3>4.3 Bemis–Murcko scaffold<a class="headerlink" href="#bemismurcko-scaffold" title="Link to this heading">#</a></h3>
<p>To simplify molecules further we can extract their <strong>scaffolds</strong>, which keep the core ring system and linkers but discard side chains.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">rdkit.Chem.Scaffolds</span><span class="w"> </span><span class="kn">import</span> <span class="n">MurckoScaffold</span>

<span class="n">mol_carboxy</span> <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">MolFromSmiles</span><span class="p">(</span><span class="s2">&quot;O=C(O)c1ccc(C(=O)O)cc1&quot;</span><span class="p">)</span>
<span class="n">mol_hydroxamate</span> <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">MolFromSmiles</span><span class="p">(</span><span class="s2">&quot;O=C(O)c1ccc(C(=O)NO)cc1&quot;</span><span class="p">)</span>

<span class="n">scaf_c</span> <span class="o">=</span> <span class="n">MurckoScaffold</span><span class="o">.</span><span class="n">GetScaffoldForMol</span><span class="p">(</span><span class="n">mol_carboxy</span> <span class="p">)</span>
<span class="n">scaf_h</span> <span class="o">=</span> <span class="n">MurckoScaffold</span><span class="o">.</span><span class="n">GetScaffoldForMol</span><span class="p">(</span><span class="n">mol_hydroxamate</span><span class="p">)</span>

<span class="n">Draw</span><span class="o">.</span><span class="n">MolsToGridImage</span><span class="p">([</span><span class="n">mol_carboxy</span><span class="p">,</span> <span class="n">scaf_c</span> <span class="p">,</span> <span class="n">mol_hydroxamate</span><span class="p">,</span> <span class="n">scaf_h</span> <span class="p">],</span>
                     <span class="n">legends</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;mol_c&quot;</span><span class="p">,</span> <span class="s2">&quot;scaffold_c&quot;</span><span class="p">,</span> <span class="s2">&quot;mol_hydroxamate&quot;</span><span class="p">,</span> <span class="s2">&quot;scaffold_h&quot;</span><span class="p">],</span>
                     <span class="n">molsPerRow</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">subImgSize</span><span class="o">=</span><span class="p">(</span><span class="mi">180</span><span class="p">,</span><span class="mi">180</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/234ddcc9dfe23bcbfca43f2cf683f1bcbd43a3b23303a67b4a4b16395f533dc1.png" src="_images/234ddcc9dfe23bcbfca43f2cf683f1bcbd43a3b23303a67b4a4b16395f533dc1.png" />
</div>
</div>
<p>Both of the two molecules above share the same benzene scaffold substructure.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">rdkit.Chem.Scaffolds</span><span class="w"> </span><span class="kn">import</span> <span class="n">MurckoScaffold</span>


<span class="n">scaf_caff</span> <span class="o">=</span> <span class="n">MurckoScaffold</span><span class="o">.</span><span class="n">GetScaffoldForMol</span><span class="p">(</span><span class="n">caffeine</span><span class="p">)</span>
<span class="n">scaf_theo</span> <span class="o">=</span> <span class="n">MurckoScaffold</span><span class="o">.</span><span class="n">GetScaffoldForMol</span><span class="p">(</span><span class="n">theobromine</span><span class="p">)</span>

<span class="n">Draw</span><span class="o">.</span><span class="n">MolsToGridImage</span><span class="p">([</span><span class="n">caffeine</span><span class="p">,</span> <span class="n">scaf_caff</span><span class="p">,</span> <span class="n">theobromine</span><span class="p">,</span> <span class="n">scaf_theo</span><span class="p">],</span>
                     <span class="n">legends</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;caffeine&quot;</span><span class="p">,</span> <span class="s2">&quot;caffeine scaffold&quot;</span><span class="p">,</span> <span class="s2">&quot;theobromine&quot;</span><span class="p">,</span> <span class="s2">&quot;theobromine scaffold&quot;</span><span class="p">],</span>
                     <span class="n">molsPerRow</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">subImgSize</span><span class="o">=</span><span class="p">(</span><span class="mi">180</span><span class="p">,</span><span class="mi">180</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/96237a0e7ccd608f8ac24ec4508242144e89460f17bbf3bf1b01d5570a65c902.png" src="_images/96237a0e7ccd608f8ac24ec4508242144e89460f17bbf3bf1b01d5570a65c902.png" />
</div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Scaffolds are useful in medicinal chemistry to group compounds into families.<br />
Different analogs may have the same core scaffold but different substituents that tune activity or solubility.</p>
</div>
</section>
</section>
<hr class="docutils" />
<section id="rdkit-with-pandas">
<h2><a class="toc-backref" href="#id10" role="doc-backlink">5. RDKit with pandas</a><a class="headerlink" href="#rdkit-with-pandas" title="Link to this heading">#</a></h2>
<p>Large datasets are often stored as tables. Pandas can manage these datasets, while RDKit enriches them with molecular objects and descriptors.</p>
<section id="load-dataset-and-add-molecule-column">
<h3>5.1 Load dataset and add molecule column<a class="headerlink" href="#load-dataset-and-add-molecule-column" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">rdkit.Chem</span><span class="w"> </span><span class="kn">import</span> <span class="n">PandasTools</span>

<span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;https://raw.githubusercontent.com/zzhenglab/ai4chem/main/book/_data/organic_ligands_inventory_smiles.xlsx&quot;</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">engine</span><span class="o">=</span><span class="s2">&quot;openpyxl&quot;</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="s1">&#39;Compound ID&#39;</span><span class="p">,</span><span class="s1">&#39;smiles&#39;</span><span class="p">,</span><span class="s1">&#39;MW&#39;</span><span class="p">]]</span>


<span class="n">PandasTools</span><span class="o">.</span><span class="n">AddMoleculeColumnToFrame</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">smilesCol</span><span class="o">=</span><span class="s1">&#39;smiles&#39;</span><span class="p">,</span> <span class="n">molCol</span><span class="o">=</span><span class="s1">&#39;Mol&#39;</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Compound ID</th>
      <th>smiles</th>
      <th>MW</th>
      <th>Mol</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2-Methylimidazole</td>
      <td>CC1=NC=CN1</td>
      <td>82.106</td>
      <td>&lt;rdkit.Chem.rdchem.Mol object at 0x000001C3A52...</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1-Ethyl-3-vinylimidazolium bromide</td>
      <td>C=C[N+]1=CN(CC)C=C1.[Br-]</td>
      <td>203.083</td>
      <td>&lt;rdkit.Chem.rdchem.Mol object at 0x000001C3A52...</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1-Methyl-1,4-diazabicyclo[2.2.2]octan-1-iumchl...</td>
      <td>[Cl-].N12CC[N+](C)(CC1)CC2</td>
      <td>162.660</td>
      <td>&lt;rdkit.Chem.rdchem.Mol object at 0x000001C3A52...</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Oxazole-4-carboxylic acid</td>
      <td>O=C(C1=COC=N1)O</td>
      <td>113.072</td>
      <td>&lt;rdkit.Chem.rdchem.Mol object at 0x000001C3A52...</td>
    </tr>
    <tr>
      <th>4</th>
      <td>3-Ethyl-2-methylbenzo[d]thiazol-3-ium iodide</td>
      <td>CC[N+]1=C(C)SC2=CC=CC=C21.[I-]</td>
      <td>305.184</td>
      <td>&lt;rdkit.Chem.rdchem.Mol object at 0x000001C3A52...</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Adding a <code class="docutils literal notranslate"><span class="pre">Mol</span></code> column converts SMILES to RDKit molecules directly in the DataFrame.<br />
This makes it easy to compute descriptors row by row or draw molecules inline.</p>
</div>
</section>
<section id="canonicalize-smiles-and-compute-descriptors">
<h3>5.2 Canonicalize SMILES and compute descriptors<a class="headerlink" href="#canonicalize-smiles-and-compute-descriptors" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">canonicalize</span><span class="p">(</span><span class="n">smiles</span><span class="p">):</span>
    <span class="n">m</span> <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">MolFromSmiles</span><span class="p">(</span><span class="n">smiles</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">Chem</span><span class="o">.</span><span class="n">MolToSmiles</span><span class="p">(</span><span class="n">m</span><span class="p">)</span> <span class="k">if</span> <span class="n">m</span> <span class="k">else</span> <span class="kc">None</span>

<span class="n">df</span><span class="p">[</span><span class="s1">&#39;canonical_smiles&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;smiles&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">canonicalize</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Now we create a new collum ‘canonical_smiles’ with the canonicalized smiles.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">rdkit.ML.Descriptors.MoleculeDescriptors</span><span class="w"> </span><span class="kn">import</span> <span class="n">MolecularDescriptorCalculator</span>

<span class="n">desc_names</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;MolWt&#39;</span><span class="p">,</span><span class="s1">&#39;TPSA&#39;</span><span class="p">,</span><span class="s1">&#39;MolLogP&#39;</span><span class="p">,</span><span class="s1">&#39;NumHAcceptors&#39;</span><span class="p">,</span><span class="s1">&#39;NumHDonors&#39;</span><span class="p">]</span>
<span class="n">calc</span> <span class="o">=</span> <span class="n">MolecularDescriptorCalculator</span><span class="p">(</span><span class="n">desc_names</span><span class="p">)</span>

<span class="n">df_desc</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Mol&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">calc</span><span class="o">.</span><span class="n">CalcDescriptors</span><span class="p">)</span>
<span class="n">df_desc</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">df_desc</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span> <span class="n">columns</span><span class="o">=</span><span class="n">desc_names</span><span class="p">)</span>

<span class="n">df_all</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">df</span><span class="p">[[</span><span class="s1">&#39;Compound ID&#39;</span><span class="p">,</span><span class="s1">&#39;MW&#39;</span><span class="p">,</span><span class="s1">&#39;canonical_smiles&#39;</span><span class="p">]],</span> <span class="n">df_desc</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">df_all</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Compound ID</th>
      <th>MW</th>
      <th>canonical_smiles</th>
      <th>MolWt</th>
      <th>TPSA</th>
      <th>MolLogP</th>
      <th>NumHAcceptors</th>
      <th>NumHDonors</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2-Methylimidazole</td>
      <td>82.106</td>
      <td>Cc1ncc[nH]1</td>
      <td>82.106</td>
      <td>28.68</td>
      <td>0.71812</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1-Ethyl-3-vinylimidazolium bromide</td>
      <td>203.083</td>
      <td>C=C[n+]1ccn(CC)c1.[Br-]</td>
      <td>203.083</td>
      <td>8.81</td>
      <td>-2.10000</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1-Methyl-1,4-diazabicyclo[2.2.2]octan-1-iumchl...</td>
      <td>162.660</td>
      <td>C[N+]12CCN(CC1)CC2.[Cl-]</td>
      <td>162.664</td>
      <td>3.24</td>
      <td>-3.23380</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Oxazole-4-carboxylic acid</td>
      <td>113.072</td>
      <td>O=C(O)c1cocn1</td>
      <td>113.072</td>
      <td>63.33</td>
      <td>0.37280</td>
      <td>3</td>
      <td>1</td>
    </tr>
    <tr>
      <th>4</th>
      <td>3-Ethyl-2-methylbenzo[d]thiazol-3-ium iodide</td>
      <td>305.184</td>
      <td>CC[n+]1c(C)sc2ccccc21.[I-]</td>
      <td>305.184</td>
      <td>3.88</td>
      <td>-0.47888</td>
      <td>1</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Descriptors such as TPSA and LogP are common in QSAR modeling and drug-likeness rules.<br />
For example, Lipinski’s rule-of-five uses MolWt, LogP, HBD, and HBA thresholds.</p>
</div>
</section>
<section id="clean-and-visualize">
<h3>5.3 Clean and visualize<a class="headerlink" href="#clean-and-visualize" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_clean</span> <span class="o">=</span> <span class="n">df_all</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Number of rows after cleaning:&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">df_clean</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Number of rows after cleaning: 102
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>

<span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">df_clean</span><span class="p">[</span><span class="s1">&#39;MolWt&#39;</span><span class="p">],</span> <span class="n">bins</span><span class="o">=</span><span class="mi">40</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Molecular Weight (g/mol)&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Count&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/8b8d9fa2f4049e6fc749ef2224ac35494ae5420ce9b6921d6cb0f6c3b8a10a5e.png" src="_images/8b8d9fa2f4049e6fc749ef2224ac35494ae5420ce9b6921d6cb0f6c3b8a10a5e.png" />
</div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Cleaning removes molecules that failed parsing. Histograms allow you to inspect the distribution of properties—are most molecules small and drug-like, or large and polar?</p>
</div>
</section>
</section>
<hr class="docutils" />
<section id="quick-reference">
<h2><a class="toc-backref" href="#id11" role="doc-backlink">6. Quick reference</a><a class="headerlink" href="#quick-reference" title="Link to this heading">#</a></h2>
<div class="admonition-smiles admonition">
<p class="admonition-title">SMILES</p>
<ul class="simple">
<li><p>Atoms: upper case aliphatic, lower case aromatic</p></li>
<li><p>Bonds: implicit single, =, #</p></li>
<li><p>Branches: parentheses</p></li>
<li><p>Rings: digits to open and close</p></li>
<li><p>Charges: bracket the atom, e.g., [O-], [NH4+]</p></li>
<li><p>Salts: separate parts with a dot</p></li>
<li><p>E or Z: use slashes around the double bond</p></li>
</ul>
</div>
<div class="admonition-rdkit admonition">
<p class="admonition-title">RDKit</p>
<ul class="simple">
<li><p>Parse: <code class="docutils literal notranslate"><span class="pre">Chem.MolFromSmiles</span></code></p></li>
<li><p>Draw: <code class="docutils literal notranslate"><span class="pre">Draw.MolToImage(...,</span> <span class="pre">includeAtomNumbers=True)</span></code></p></li>
<li><p>Hydrogens: <code class="docutils literal notranslate"><span class="pre">Chem.AddHs</span></code></p></li>
<li><p>Properties: <code class="docutils literal notranslate"><span class="pre">Descriptors.MolWt</span></code>, <code class="docutils literal notranslate"><span class="pre">Crippen.MolLogP</span></code>, <code class="docutils literal notranslate"><span class="pre">CalcNumHBA/HBD</span></code>, <code class="docutils literal notranslate"><span class="pre">CalcTPSA</span></code></p></li>
<li><p>Replace piece with piece: <code class="docutils literal notranslate"><span class="pre">Chem.ReplaceSubstructs(mol,</span> <span class="pre">findMol,</span> <span class="pre">repMol)</span></code></p></li>
<li><p>Graph edit: <code class="docutils literal notranslate"><span class="pre">Chem.EditableMol</span></code></p></li>
<li><p>Save: <code class="docutils literal notranslate"><span class="pre">Chem.MolToSmiles</span></code>, <code class="docutils literal notranslate"><span class="pre">SDWriter</span></code>, PNG via <code class="docutils literal notranslate"><span class="pre">MolToImage(...).save(...)</span></code></p></li>
</ul>
</div>
</section>
<hr class="docutils" />
<section id="glossary">
<h2><a class="toc-backref" href="#id12" role="doc-backlink">7. Glossary</a><a class="headerlink" href="#glossary" title="Link to this heading">#</a></h2>
<dl class="simple glossary">
<dt id="term-SMILES">SMILES<a class="headerlink" href="#term-SMILES" title="Link to this term">#</a></dt><dd><p>Text line notation for molecules. Example: ethanol is CCO.</p>
</dd>
<dt id="term-aromatic">aromatic<a class="headerlink" href="#term-aromatic" title="Link to this term">#</a></dt><dd><p>Conjugated ring system shown with lower case atom symbols in SMILES, for example c1ccccc1.</p>
</dd>
<dt id="term-CID">CID<a class="headerlink" href="#term-CID" title="Link to this term">#</a></dt><dd><p>PubChem Compound ID for a unique compound record.</p>
</dd>
<dt id="term-sanitize">sanitize<a class="headerlink" href="#term-sanitize" title="Link to this term">#</a></dt><dd><p>RDKit process that checks valence, aromaticity, and stereochemistry.</p>
</dd>
<dt id="term-descriptor">descriptor<a class="headerlink" href="#term-descriptor" title="Link to this term">#</a></dt><dd><p>Computed molecular property such as molecular weight or LogP.</p>
</dd>
<dt id="term-EditableMol">EditableMol<a class="headerlink" href="#term-EditableMol" title="Link to this term">#</a></dt><dd><p>RDKit object that exposes low level atom and bond editing.</p>
</dd>
<dt id="term-BemisMurcko-scaffold">Bemis–Murcko scaffold<a class="headerlink" href="#term-BemisMurcko-scaffold" title="Link to this term">#</a></dt><dd><p>The ring system and linkers that form a molecule’s core framework.</p>
</dd>
</dl>
</section>
<hr class="docutils" />
<section id="in-class-activity">
<h2><a class="toc-backref" href="#id13" role="doc-backlink">8. In-class activity</a><a class="headerlink" href="#in-class-activity" title="Link to this heading">#</a></h2>
<p>Each task mirrors the examples above. Fill in the <code class="docutils literal notranslate"><span class="pre">...</span></code> lines. Work in pairs. Solutions are in Section 9.</p>
<section id="read-a-smiles-and-inspect">
<h3>8.1 Read a SMILES and inspect<a class="headerlink" href="#read-a-smiles-and-inspect" title="Link to this heading">#</a></h3>
<p>Given <code class="docutils literal notranslate"><span class="pre">smi</span> <span class="pre">=</span> <span class="pre">&quot;O=C(O)c1ccccc1Cl&quot;</span></code>.<br />
a) Count number of rings.<br />
bc) Print the list of bonds with begin and end atom indices and bond orders.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">rdkit</span><span class="w"> </span><span class="kn">import</span> <span class="n">Chem</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">rdkit.Chem</span><span class="w"> </span><span class="kn">import</span> <span class="n">Draw</span>

<span class="n">smi</span> <span class="o">=</span> <span class="o">...</span>  <span class="c1"># TO DO</span>

<span class="n">mol</span> <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">MolFromSmiles</span><span class="p">(</span><span class="n">smi</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">Draw</span><span class="o">.</span><span class="n">MolToImage</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">350</span><span class="p">,</span> <span class="mi">250</span><span class="p">),</span> <span class="n">includeAtomNumbers</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>

<span class="n">num_rings</span> <span class="o">=</span> <span class="o">...</span>   <span class="c1"># TO DO: Chem.GetSSSR(mol)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;rings:&quot;</span><span class="p">,</span> <span class="n">num_rings</span><span class="p">)</span>

<span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">mol</span><span class="o">.</span><span class="n">GetBonds</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;bond&quot;</span><span class="p">,</span> <span class="n">b</span><span class="o">.</span><span class="n">GetIdx</span><span class="p">(),</span> <span class="n">b</span><span class="o">.</span><span class="n">GetBeginAtomIdx</span><span class="p">(),</span> <span class="s2">&quot;-&quot;</span><span class="p">,</span> <span class="n">b</span><span class="o">.</span><span class="n">GetEndAtomIdx</span><span class="p">(),</span> <span class="s2">&quot;order&quot;</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">b</span><span class="o">.</span><span class="n">GetBondTypeAsDouble</span><span class="p">()))</span>
</pre></div>
</div>
</section>
<hr class="docutils" />
<section id="make-a-small-properties-table">
<h3>8.2 Make a small properties table<a class="headerlink" href="#make-a-small-properties-table" title="Link to this heading">#</a></h3>
<p>Use smiles <code class="docutils literal notranslate"><span class="pre">[&quot;Cn1cnc2N(C)C(=O)N(C)C(=O)c12&quot;,</span> <span class="pre">&quot;CC(=O)Nc1ccc(O)cc1&quot;,</span> <span class="pre">&quot;CC(C)Cc1ccc(cc1)C(C)C(O)=O&quot;]</span></code>. For each, compute MolWt, LogP, HBD, HBA, and TPSA.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">rdkit.Chem</span><span class="w"> </span><span class="kn">import</span> <span class="n">Descriptors</span><span class="p">,</span> <span class="n">Crippen</span><span class="p">,</span> <span class="n">rdMolDescriptors</span>

<span class="n">names</span> <span class="o">=</span> <span class="o">...</span>  <span class="c1"># TO DO</span>
<span class="n">rows</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">nm</span> <span class="ow">in</span> <span class="n">names</span><span class="p">:</span>
    <span class="o">...</span>  <span class="c1">#TO DO</span>

    <span class="n">rows</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
        <span class="s2">&quot;smiles&quot;</span><span class="p">:</span> <span class="o">...</span><span class="p">,</span>
        <span class="s2">&quot;MolWt&quot;</span><span class="p">:</span> <span class="o">...</span><span class="p">,</span>
        <span class="s2">&quot;LogP&quot;</span><span class="p">:</span> <span class="o">...</span><span class="p">,</span>
        <span class="s2">&quot;HBD&quot;</span><span class="p">:</span> <span class="o">...</span><span class="p">,</span>
        <span class="s2">&quot;HBA&quot;</span><span class="p">:</span> <span class="o">...</span><span class="p">,</span>
        <span class="s2">&quot;TPSA&quot;</span><span class="p">:</span> <span class="o">...</span>
    <span class="p">})</span>

<span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">rows</span><span class="p">)</span>
</pre></div>
</div>
</section>
<hr class="docutils" />
<section id="replace-chlorine-with-fluorine">
<h3>8.3 Replace chlorine with fluorine<a class="headerlink" href="#replace-chlorine-with-fluorine" title="Link to this heading">#</a></h3>
<p>Replace Cl with F in <code class="docutils literal notranslate"><span class="pre">Clc1ccc(cc1)C(=O)O</span></code> and print the result SMILES.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">find</span> <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">MolFromSmiles</span><span class="p">(</span><span class="o">...</span> <span class="p">)</span>  <span class="c1"># TO DO</span>
<span class="n">put</span>  <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">MolFromSmiles</span><span class="p">(</span><span class="o">...</span> <span class="p">)</span>  <span class="c1"># TO DO</span>
<span class="n">mol</span>  <span class="o">=</span> <span class="o">...</span> <span class="c1"># TO DO</span>
<span class="n">out</span>  <span class="o">=</span> <span class="o">...</span> <span class="c1"># TO DO</span>
<span class="nb">print</span><span class="p">(</span><span class="n">Chem</span><span class="o">.</span><span class="n">MolToSmiles</span><span class="p">(</span><span class="n">out</span><span class="p">))</span>
</pre></div>
</div>
</section>
<hr class="docutils" />
<section id="id2">
<h3>8.4 Add a methyl group with a graph edit<a class="headerlink" href="#id2" title="Link to this heading">#</a></h3>
<p>Add a methyl at atom index 2 of benzene.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">mol</span> <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">MolFromSmiles</span><span class="p">(</span><span class="s2">&quot;c1ccccc1&quot;</span><span class="p">)</span>
<span class="n">em</span> <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">EditableMol</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
<span class="c1"># TO DO: add code</span>
<span class="n">Draw</span><span class="o">.</span><span class="n">MolToImage</span><span class="p">(</span><span class="o">...</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">350</span><span class="p">,</span> <span class="mi">250</span><span class="p">))</span>
</pre></div>
</div>
</section>
<section id="retrieve-smiles-from-pubchem-draw-structure-then-analyze">
<h3>8.5 Retrieve SMILES from PubChem Draw structure, then analyze<a class="headerlink" href="#retrieve-smiles-from-pubchem-draw-structure-then-analyze" title="Link to this heading">#</a></h3>
<p>Images to inspect:</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">IPython.display</span><span class="w"> </span><span class="kn">import</span> <span class="n">Image</span><span class="p">,</span> <span class="n">display</span>
<span class="c1"># Show provided images for reference</span>
<span class="n">display</span><span class="p">(</span><span class="n">Image</span><span class="p">(</span><span class="n">url</span><span class="o">=</span><span class="s2">&quot;https://raw.githubusercontent.com/zzhenglab/ai4chem/main/book/_data/lec-3-structures.png&quot;</span><span class="p">))</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output text_html"><img src="https://raw.githubusercontent.com/zzhenglab/ai4chem/main/book/_data/lec-3-structures.png"/></div></div>
</div>
<ol class="arabic simple">
<li><p>Go to <strong><a class="reference external" href="https://pubchem.ncbi.nlm.nih.gov/">https://pubchem.ncbi.nlm.nih.gov/</a></strong>.</p></li>
<li><p>Click <strong>Draw structure</strong>.</p></li>
<li><p>Paste draw the structure above, then copy the SMILES.</p></li>
<li><p>Use the SMILES in the cell below to draw with RDKit and compute basic properties.</p></li>
</ol>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Paste the SMILES you obtained from PubChem Draw structure</span>
<span class="n">smi1</span> <span class="o">=</span> <span class="s2">&quot;...&quot;</span>  <span class="c1"># smiles for image 1</span>
<span class="n">smi2</span> <span class="o">=</span> <span class="s2">&quot;...&quot;</span>  <span class="c1"># smiles for image 2</span>
<span class="n">smi3</span> <span class="o">=</span> <span class="s2">&quot;...&quot;</span>  <span class="c1"># smiles for image 3</span>

<span class="n">m1</span> <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">MolFromSmiles</span><span class="p">(</span><span class="n">smi1</span><span class="p">)</span>
<span class="n">m2</span> <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">MolFromSmiles</span><span class="p">(</span><span class="n">smi2</span><span class="p">)</span>
<span class="n">m3</span> <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">MolFromSmiles</span><span class="p">(</span><span class="n">smi3</span><span class="p">)</span>

<span class="n">Draw</span><span class="o">.</span><span class="n">MolsToGridImage</span><span class="p">([</span><span class="n">m1</span><span class="p">,</span> <span class="n">m2</span><span class="p">,</span> <span class="n">m3</span><span class="p">],</span> <span class="n">legends</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;img1&quot;</span><span class="p">,</span><span class="s2">&quot;img2&quot;</span><span class="p">,</span><span class="s2">&quot;img3&quot;</span><span class="p">],</span> <span class="n">molsPerRow</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">subImgSize</span><span class="o">=</span><span class="p">(</span><span class="mi">220</span><span class="p">,</span><span class="mi">200</span><span class="p">),</span> <span class="n">useSVG</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Compute quick properties for the three molecules</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">rdkit.Chem</span><span class="w"> </span><span class="kn">import</span> <span class="n">Descriptors</span><span class="p">,</span> <span class="n">Crippen</span><span class="p">,</span> <span class="n">rdMolDescriptors</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>

    <span class="o">...</span> <span class="c1"># TO DO: get MolWt=..., LogP=...,HBD=...,HBA=..., TPSA=...</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([</span>
    <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span><span class="s2">&quot;img1&quot;</span><span class="p">,</span><span class="s2">&quot;smiles&quot;</span><span class="p">:</span><span class="n">smi1</span><span class="p">,</span> <span class="o">...</span><span class="p">},</span>
    <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span><span class="s2">&quot;img2&quot;</span><span class="p">,</span><span class="s2">&quot;smiles&quot;</span><span class="p">:</span><span class="n">smi2</span><span class="p">,</span> <span class="o">...</span><span class="p">},</span>
    <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span><span class="s2">&quot;img3&quot;</span><span class="p">,</span><span class="s2">&quot;smiles&quot;</span><span class="p">:</span><span class="n">smi3</span><span class="p">,</span> <span class="o">...</span><span class="p">}</span>
<span class="p">])</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>

<span class="n">df</span>
</pre></div>
</div>
</section>
</section>
<section id="solutions">
<h2><a class="toc-backref" href="#id14" role="doc-backlink">9. Solutions</a><a class="headerlink" href="#solutions" title="Link to this heading">#</a></h2>
<p>Open after you try Section 8.</p>
<section id="solution-8-1">
<h3>Solution 8.1<a class="headerlink" href="#solution-8-1" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">rdkit</span><span class="w"> </span><span class="kn">import</span> <span class="n">Chem</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">rdkit.Chem</span><span class="w"> </span><span class="kn">import</span> <span class="n">Draw</span>

<span class="n">smi</span> <span class="o">=</span> <span class="s2">&quot;O=C(O)c1ccccc1Cl&quot;</span>

<span class="n">mol</span> <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">MolFromSmiles</span><span class="p">(</span><span class="n">smi</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">Draw</span><span class="o">.</span><span class="n">MolToImage</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">350</span><span class="p">,</span> <span class="mi">250</span><span class="p">),</span> <span class="n">includeAtomNumbers</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>

<span class="n">num_rings</span> <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">GetSSSR</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;rings:&quot;</span><span class="p">,</span> <span class="n">num_rings</span><span class="p">)</span>

<span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">mol</span><span class="o">.</span><span class="n">GetBonds</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;bond&quot;</span><span class="p">,</span> <span class="n">b</span><span class="o">.</span><span class="n">GetIdx</span><span class="p">(),</span> <span class="n">b</span><span class="o">.</span><span class="n">GetBeginAtomIdx</span><span class="p">(),</span> <span class="s2">&quot;-&quot;</span><span class="p">,</span> <span class="n">b</span><span class="o">.</span><span class="n">GetEndAtomIdx</span><span class="p">(),</span> <span class="s2">&quot;order&quot;</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">b</span><span class="o">.</span><span class="n">GetBondTypeAsDouble</span><span class="p">()))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/8d684575496d592c6f31701af2168169b7e533b522ea4f1c2cb135e5381f14b4.png" src="_images/8d684575496d592c6f31701af2168169b7e533b522ea4f1c2cb135e5381f14b4.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>rings: &lt;rdkit.rdBase._vectclass std::vector&lt;int,class std::allocator&lt;int&gt; &gt; object at 0x000001C3B9AB4EC0&gt;
bond 0 0 - 1 order 2
bond 1 1 - 2 order 1
bond 2 1 - 3 order 1
bond 3 3 - 4 order 1
bond 4 4 - 5 order 1
bond 5 5 - 6 order 1
bond 6 6 - 7 order 1
bond 7 7 - 8 order 1
bond 8 8 - 9 order 1
bond 9 8 - 3 order 1
</pre></div>
</div>
</div>
</div>
</section>
<section id="solution-8-2">
<h3>Solution 8.2<a class="headerlink" href="#solution-8-2" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">rdkit.Chem</span><span class="w"> </span><span class="kn">import</span> <span class="n">Descriptors</span><span class="p">,</span> <span class="n">Crippen</span><span class="p">,</span> <span class="n">rdMolDescriptors</span>

<span class="n">names</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Cn1cnc2N(C)C(=O)N(C)C(=O)c12&quot;</span><span class="p">,</span> <span class="s2">&quot;CC(=O)Nc1ccc(O)cc1&quot;</span><span class="p">,</span> <span class="s2">&quot;CC(C)Cc1ccc(cc1)C(C)C(O)=O&quot;</span><span class="p">]</span>
<span class="n">rows</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">nm</span> <span class="ow">in</span> <span class="n">names</span><span class="p">:</span>
    <span class="n">m</span> <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">MolFromSmiles</span><span class="p">(</span><span class="n">nm</span><span class="p">)</span>
    <span class="n">rows</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
        <span class="s2">&quot;smiles&quot;</span><span class="p">:</span> <span class="n">nm</span><span class="p">,</span>
        <span class="s2">&quot;MolWt&quot;</span><span class="p">:</span> <span class="n">Descriptors</span><span class="o">.</span><span class="n">MolWt</span><span class="p">(</span><span class="n">m</span><span class="p">),</span>
        <span class="s2">&quot;LogP&quot;</span><span class="p">:</span> <span class="n">Crippen</span><span class="o">.</span><span class="n">MolLogP</span><span class="p">(</span><span class="n">m</span><span class="p">),</span>
        <span class="s2">&quot;HBD&quot;</span><span class="p">:</span> <span class="n">rdMolDescriptors</span><span class="o">.</span><span class="n">CalcNumHBD</span><span class="p">(</span><span class="n">m</span><span class="p">),</span>
        <span class="s2">&quot;HBA&quot;</span><span class="p">:</span> <span class="n">rdMolDescriptors</span><span class="o">.</span><span class="n">CalcNumHBA</span><span class="p">(</span><span class="n">m</span><span class="p">),</span>
        <span class="s2">&quot;TPSA&quot;</span><span class="p">:</span> <span class="n">rdMolDescriptors</span><span class="o">.</span><span class="n">CalcTPSA</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
    <span class="p">})</span>

<span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">rows</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>smiles</th>
      <th>MolWt</th>
      <th>LogP</th>
      <th>HBD</th>
      <th>HBA</th>
      <th>TPSA</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Cn1cnc2N(C)C(=O)N(C)C(=O)c12</td>
      <td>194.194</td>
      <td>-1.0293</td>
      <td>0</td>
      <td>6</td>
      <td>61.82</td>
    </tr>
    <tr>
      <th>1</th>
      <td>CC(=O)Nc1ccc(O)cc1</td>
      <td>151.165</td>
      <td>1.3506</td>
      <td>2</td>
      <td>2</td>
      <td>49.33</td>
    </tr>
    <tr>
      <th>2</th>
      <td>CC(C)Cc1ccc(cc1)C(C)C(O)=O</td>
      <td>206.285</td>
      <td>3.0732</td>
      <td>1</td>
      <td>1</td>
      <td>37.30</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="solution-8-3">
<h3>Solution 8.3<a class="headerlink" href="#solution-8-3" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">find</span> <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">MolFromSmiles</span><span class="p">(</span><span class="s2">&quot;Cl&quot;</span><span class="p">)</span>
<span class="n">put</span>  <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">MolFromSmiles</span><span class="p">(</span><span class="s2">&quot;F&quot;</span><span class="p">)</span>
<span class="n">mol</span>  <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">MolFromSmiles</span><span class="p">(</span><span class="s2">&quot;Clc1ccc(cc1)C(=O)O&quot;</span><span class="p">)</span>
<span class="n">out</span>  <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">ReplaceSubstructs</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">find</span><span class="p">,</span> <span class="n">put</span><span class="p">,</span> <span class="n">replaceAll</span><span class="o">=</span><span class="kc">True</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">Chem</span><span class="o">.</span><span class="n">MolToSmiles</span><span class="p">(</span><span class="n">out</span><span class="p">))</span>
<span class="n">Draw</span><span class="o">.</span><span class="n">MolToImage</span><span class="p">(</span><span class="n">out</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">350</span><span class="p">,</span> <span class="mi">250</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>O=C(O)c1ccc(F)cc1
</pre></div>
</div>
<img alt="_images/96a64de8ab6de3cba9bdeb085779432c65dde405ede31f9884814f235d701bda.png" src="_images/96a64de8ab6de3cba9bdeb085779432c65dde405ede31f9884814f235d701bda.png" />
</div>
</div>
</section>
<section id="solution-8-4">
<h3>Solution 8.4<a class="headerlink" href="#solution-8-4" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mol</span> <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">MolFromSmiles</span><span class="p">(</span><span class="s2">&quot;c1ccccc1&quot;</span><span class="p">)</span>
<span class="n">em</span> <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">EditableMol</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>

<span class="n">idx_C</span> <span class="o">=</span> <span class="n">em</span><span class="o">.</span><span class="n">AddAtom</span><span class="p">(</span><span class="n">Chem</span><span class="o">.</span><span class="n">Atom</span><span class="p">(</span><span class="s2">&quot;C&quot;</span><span class="p">))</span>
<span class="n">idx_H1</span> <span class="o">=</span> <span class="n">em</span><span class="o">.</span><span class="n">AddAtom</span><span class="p">(</span><span class="n">Chem</span><span class="o">.</span><span class="n">Atom</span><span class="p">(</span><span class="s2">&quot;H&quot;</span><span class="p">))</span>
<span class="n">idx_H2</span> <span class="o">=</span> <span class="n">em</span><span class="o">.</span><span class="n">AddAtom</span><span class="p">(</span><span class="n">Chem</span><span class="o">.</span><span class="n">Atom</span><span class="p">(</span><span class="s2">&quot;H&quot;</span><span class="p">))</span>
<span class="n">idx_H3</span> <span class="o">=</span> <span class="n">em</span><span class="o">.</span><span class="n">AddAtom</span><span class="p">(</span><span class="n">Chem</span><span class="o">.</span><span class="n">Atom</span><span class="p">(</span><span class="s2">&quot;H&quot;</span><span class="p">))</span>

<span class="n">em</span><span class="o">.</span><span class="n">AddBond</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">idx_C</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="n">Chem</span><span class="o">.</span><span class="n">BondType</span><span class="o">.</span><span class="n">SINGLE</span><span class="p">)</span>
<span class="n">em</span><span class="o">.</span><span class="n">AddBond</span><span class="p">(</span><span class="n">idx_C</span><span class="p">,</span> <span class="n">idx_H1</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="n">Chem</span><span class="o">.</span><span class="n">BondType</span><span class="o">.</span><span class="n">SINGLE</span><span class="p">)</span>
<span class="n">em</span><span class="o">.</span><span class="n">AddBond</span><span class="p">(</span><span class="n">idx_C</span><span class="p">,</span> <span class="n">idx_H2</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="n">Chem</span><span class="o">.</span><span class="n">BondType</span><span class="o">.</span><span class="n">SINGLE</span><span class="p">)</span>
<span class="n">em</span><span class="o">.</span><span class="n">AddBond</span><span class="p">(</span><span class="n">idx_C</span><span class="p">,</span> <span class="n">idx_H3</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="n">Chem</span><span class="o">.</span><span class="n">BondType</span><span class="o">.</span><span class="n">SINGLE</span><span class="p">)</span>

<span class="n">mol2</span> <span class="o">=</span> <span class="n">em</span><span class="o">.</span><span class="n">GetMol</span><span class="p">()</span>
<span class="n">Chem</span><span class="o">.</span><span class="n">SanitizeMol</span><span class="p">(</span><span class="n">mol2</span><span class="p">)</span>
<span class="n">Draw</span><span class="o">.</span><span class="n">MolToImage</span><span class="p">(</span><span class="n">mol2</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">350</span><span class="p">,</span> <span class="mi">250</span><span class="p">),</span> <span class="n">includeAtomNumbers</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/740e404a58d6f2880b124dcd97f5809abd087f30f63ec0cb3b8dfbdd52f45e1f.png" src="_images/740e404a58d6f2880b124dcd97f5809abd087f30f63ec0cb3b8dfbdd52f45e1f.png" />
</div>
</div>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="lecture-02.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Lecture 2 - Pandas and Plotting</p>
      </div>
    </a>
    <a class="right-next"
       href="lecture-04.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Lecture 4 - Chemical Structure Identifier</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#learning-goals">Learning goals</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id1"></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#smiles">1. SMILES</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#atoms">1.1 Atoms</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#bonds">1.2 Bonds</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#branches">1.3 Branches</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#rings">1.4 Rings</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#aromatic-vs-aliphatic">1.5 Aromatic vs aliphatic</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#charges-and-salts">1.6 Charges and salts</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#simple-stereochemistry">1.7 Simple stereochemistry</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#rdkit-quick-start">2. RDKit quick start</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#small-edits-in-rdkit">3. Small edits in RDKit</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#replace-atom-type-by-matching-a-small-molecule">3.1 Replace atom type by matching a small molecule</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#neutralize-a-carboxylate">3.2 Neutralize a carboxylate</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#add-a-methyl-group-with-a-graph-edit">3.3 Add a methyl group with a graph edit</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#why-use-editablemol-instead-of-just-smiles-edits">3.4 Why use <code class="docutils literal notranslate"><span class="pre">EditableMol</span></code> instead of just SMILES edits?</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#canonicalization-and-similarity">4. Canonicalization and similarity</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#canonicalization">4.1 Canonicalization</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#morgan-fingerprints-and-tanimoto">4.2 Morgan fingerprints and Tanimoto</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#bemismurcko-scaffold">4.3 Bemis–Murcko scaffold</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#rdkit-with-pandas">5. RDKit with pandas</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#load-dataset-and-add-molecule-column">5.1 Load dataset and add molecule column</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#canonicalize-smiles-and-compute-descriptors">5.2 Canonicalize SMILES and compute descriptors</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#clean-and-visualize">5.3 Clean and visualize</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#quick-reference">6. Quick reference</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#glossary">7. Glossary</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#in-class-activity">8. In-class activity</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#read-a-smiles-and-inspect">8.1 Read a SMILES and inspect</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#make-a-small-properties-table">8.2 Make a small properties table</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#replace-chlorine-with-fluorine">8.3 Replace chlorine with fluorine</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">8.4 Add a methyl group with a graph edit</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#retrieve-smiles-from-pubchem-draw-structure-then-analyze">8.5 Retrieve SMILES from PubChem Draw structure, then analyze</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#solutions">9. Solutions</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#solution-8-1">Solution 8.1</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#solution-8-2">Solution 8.2</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#solution-8-3">Solution 8.3</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#solution-8-4">Solution 8.4</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By The Jupyter Book Community
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>