
<!DOCTYPE html>


<html lang="en" data-content_root="" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Lecture 4 - Chemical Structure Identifier &#8212; My sample book</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=5b4479735964841361fd" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=5b4479735964841361fd" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=5b4479735964841361fd" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=5b4479735964841361fd" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" href="_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css?v=be8a1c11" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="_static/design-style.4045f2051d55cab465a707391d5b2007.min.css?v=6ad1a40c" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=5b4479735964841361fd" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=5b4479735964841361fd" />
  <script src="_static/vendor/fontawesome/6.1.2/js/all.min.js?digest=5b4479735964841361fd"></script>

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js?v=2b91c5f0"></script>
    <script src="_static/doctools.js?v=888ff710"></script>
    <script src="_static/sphinx_highlight.js?v=4825356b"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js?v=36754332"></script>
<<<<<<< HEAD
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="_static/sphinx-thebe.js?v=afe5de03"></script>
    <script type="application/vnd.jupyter.widget-state+json">{"state": {"22b618d204994bcc955c8261580fac27": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": "60%"}}, "edddd7e3afc84c1c91cfc2fd9485be40": {"model_name": "TextStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "TextStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "background": null, "description_width": "", "font_size": null, "text_color": null}}, "07e2959937244e929637e17e45d72886": {"model_name": "TextModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "TextModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "TextView", "continuous_update": true, "description": "Query:", "description_allow_html": false, "disabled": false, "layout": "IPY_MODEL_22b618d204994bcc955c8261580fac27", "placeholder": "\u200b", "style": "IPY_MODEL_edddd7e3afc84c1c91cfc2fd9485be40", "tabbable": null, "tooltip": null, "value": "aspirin"}}, "6b7a3c6d0f1c42e79c02e03ead92279e": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "a2691333febc4cc08116fc748dd9c882": {"model_name": "ToggleButtonsStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "ToggleButtonsStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "button_width": "", "description_width": "", "font_weight": ""}}, "369f0c3e9c2c4b05bf27420bc58ba6e0": {"model_name": "ToggleButtonsModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "ToggleButtonsModel", "_options_labels": ["PubChem", "CIR"], "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "ToggleButtonsView", "button_style": "", "description": "Source:", "description_allow_html": false, "disabled": false, "icons": [], "index": 0, "layout": "IPY_MODEL_6b7a3c6d0f1c42e79c02e03ead92279e", "style": "IPY_MODEL_a2691333febc4cc08116fc748dd9c882", "tabbable": null, "tooltip": null, "tooltips": []}}, "ebef00787eee4fa685f8d05326ab8e81": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "a5611567dce1439ea1978bd3bcbce272": {"model_name": "ButtonStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "ButtonStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "button_color": null, "font_family": null, "font_size": null, "font_style": null, "font_variant": null, "font_weight": null, "text_color": null, "text_decoration": null}}, "e25d62b728864d13becd737fb9ff00f0": {"model_name": "ButtonModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "ButtonModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "ButtonView", "button_style": "primary", "description": "Fetch", "disabled": false, "icon": "", "layout": "IPY_MODEL_ebef00787eee4fa685f8d05326ab8e81", "style": "IPY_MODEL_a5611567dce1439ea1978bd3bcbce272", "tabbable": null, "tooltip": null}}, "731d70ee152c4db1830d1a2f5fe921f9": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "57056bcf51374adbbb46b0b2ceda3811": {"model_name": "OutputModel", "model_module": "@jupyter-widgets/output", "model_module_version": "1.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/output", "_model_module_version": "1.0.0", "_model_name": "OutputModel", "_view_count": null, "_view_module": "@jupyter-widgets/output", "_view_module_version": "1.0.0", "_view_name": "OutputView", "layout": "IPY_MODEL_731d70ee152c4db1830d1a2f5fe921f9", "msg_id": "", "outputs": [], "tabbable": null, "tooltip": null}}, "f54ad4fbf4ce45c887d8eeab13ebcbea": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "96e3d88de1c649bd8eb0209bfb4de3b2": {"model_name": "HBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "HBoxView", "box_style": "", "children": ["IPY_MODEL_07e2959937244e929637e17e45d72886", "IPY_MODEL_369f0c3e9c2c4b05bf27420bc58ba6e0", "IPY_MODEL_e25d62b728864d13becd737fb9ff00f0"], "layout": "IPY_MODEL_f54ad4fbf4ce45c887d8eeab13ebcbea", "tabbable": null, "tooltip": null}}}, "version_major": 2, "version_minor": 0}</script>
=======
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script type="application/vnd.jupyter.widget-state+json">{"state": {"2f9c2104fa794851b79fbb7040d60efd": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": "60%"}}, "a20ee4102f2b4110a80f60b3f30a3ffa": {"model_name": "TextStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "TextStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "background": null, "description_width": "", "font_size": null, "text_color": null}}, "beeb8a4ac427415b8639910dc983642c": {"model_name": "TextModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "TextModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "TextView", "continuous_update": true, "description": "Query:", "description_allow_html": false, "disabled": false, "layout": "IPY_MODEL_2f9c2104fa794851b79fbb7040d60efd", "placeholder": "\u200b", "style": "IPY_MODEL_a20ee4102f2b4110a80f60b3f30a3ffa", "tabbable": null, "tooltip": null, "value": "aspirin"}}, "998d758a2c5646059c7b98a1cd00a1d0": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "9bd742ddace44c8daa1f847b1e372b48": {"model_name": "ToggleButtonsStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "ToggleButtonsStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "button_width": "", "description_width": "", "font_weight": ""}}, "8b86fe36ab354fe7a9ddfbd0ff1b0c4e": {"model_name": "ToggleButtonsModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "ToggleButtonsModel", "_options_labels": ["PubChem", "CIR"], "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "ToggleButtonsView", "button_style": "", "description": "Source:", "description_allow_html": false, "disabled": false, "icons": [], "index": 0, "layout": "IPY_MODEL_998d758a2c5646059c7b98a1cd00a1d0", "style": "IPY_MODEL_9bd742ddace44c8daa1f847b1e372b48", "tabbable": null, "tooltip": null, "tooltips": []}}, "af4be51345864827a6507059ad4a5d8d": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "a10f438698b2474d9f0e11527106f5a6": {"model_name": "ButtonStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "ButtonStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "button_color": null, "font_family": null, "font_size": null, "font_style": null, "font_variant": null, "font_weight": null, "text_color": null, "text_decoration": null}}, "30aebd6396b242b78ba82fb4a3f5a899": {"model_name": "ButtonModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "ButtonModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "ButtonView", "button_style": "primary", "description": "Fetch", "disabled": false, "icon": "", "layout": "IPY_MODEL_af4be51345864827a6507059ad4a5d8d", "style": "IPY_MODEL_a10f438698b2474d9f0e11527106f5a6", "tabbable": null, "tooltip": null}}, "fff3c41ce3894e84842c4987e14308c2": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "a65285ff2f1d4446bb21bb33e30e23cf": {"model_name": "OutputModel", "model_module": "@jupyter-widgets/output", "model_module_version": "1.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/output", "_model_module_version": "1.0.0", "_model_name": "OutputModel", "_view_count": null, "_view_module": "@jupyter-widgets/output", "_view_module_version": "1.0.0", "_view_name": "OutputView", "layout": "IPY_MODEL_fff3c41ce3894e84842c4987e14308c2", "msg_id": "", "outputs": [], "tabbable": null, "tooltip": null}}, "f375dd9db33d49a881b519c9b1ccc31b": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "d6b3ebf1d9a14512b7c1efa478256109": {"model_name": "HBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "HBoxView", "box_style": "", "children": ["IPY_MODEL_beeb8a4ac427415b8639910dc983642c", "IPY_MODEL_8b86fe36ab354fe7a9ddfbd0ff1b0c4e", "IPY_MODEL_30aebd6396b242b78ba82fb4a3f5a899"], "layout": "IPY_MODEL_f375dd9db33d49a881b519c9b1ccc31b", "tabbable": null, "tooltip": null}}}, "version_major": 2, "version_minor": 0}</script>
>>>>>>> 6cda9aa (0929-1)
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script crossorigin="anonymous" data-jupyter-widgets-cdn="https://cdn.jsdelivr.net/npm/" src="https://cdn.jsdelivr.net/npm/@jupyter-widgets/html-manager@1.0.6/dist/embed-amd.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'lecture-04';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Lecture 5 - Regression and Classification" href="lecture-05.html" />
    <link rel="prev" title="Lecture 3 - SMILES and RDKit" href="lecture-03.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>

  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  

<a class="navbar-brand logo" href="intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/logo.png" class="logo__image only-light" alt="My sample book - Home"/>
    <script>document.write(`<img src="_static/logo.png" class="logo__image only-dark" alt="My sample book - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    Welcome to CHEM 5080: AI for Chemistry
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="lecture-01.html">Lecture 1 - Python Primer</a></li>
<li class="toctree-l1"><a class="reference internal" href="lecture-02.html">Lecture 2 - Pandas and Plotting</a></li>
<li class="toctree-l1"><a class="reference internal" href="lecture-03.html">Lecture 3 - SMILES and RDKit</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Lecture 4 - Chemical Structure Identifier</a></li>
<li class="toctree-l1"><a class="reference internal" href="lecture-05.html">Lecture 5 - Regression and Classification</a></li>
<li class="toctree-l1"><a class="reference internal" href="lecture-06.html">Lecture 6 - Cross-Validation</a></li>
<li class="toctree-l1"><a class="reference internal" href="lecture-07.html">Lecture 7 - Decision Trees and Random Forests</a></li>
<li class="toctree-l1"><a class="reference internal" href="lecture-08.html">Lecture 8 - Neural Networks</a></li>
<li class="toctree-l1"><a class="reference internal" href="lecture-09.html">Lecture 9 - Graph Neural Networks</a></li>
<li class="toctree-l1"><a class="reference internal" href="lecture-10.html">Lecture 10 - Property &amp; Reaction Prediction</a></li>
<li class="toctree-l1"><a class="reference internal" href="lecture-11.html">Lecture 11 - Dimension Reduction for Data Visualization</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book/issues/new?title=Issue%20on%20page%20%2Flecture-04.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/lecture-04.md" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.md</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Lecture 4 - Chemical Structure Identifier</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#learning-goals">Learning goals</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#pubchem-pug-rest-basics">1. PubChem PUG-REST Basics</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#setup">1.1 Setup</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#background-information">1.2 Background Information</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#from-name-to-cid-and-properties">2. From name to CID and properties</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#form-the-url">2.1 Form the URL</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#request-and-parse">2.2 Request and parse</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#iupac-name">2.3 IUPAC name</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#canonical-vs-isomeric-smiles">2.4 Canonical vs isomeric SMILES</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#safer-helpers">2.5 Safer helpers</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#write-convenience-functions-by-name">2.6 Write convenience functions (by name)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#write-convenience-functions-by-cid">2.7 Write convenience functions (by CID)</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#other-pubchem-features">3. Other PubChem features</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#selected-computed-properties">3.1 Selected computed properties</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#synonyms">3.2 Synonyms</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#png-depiction-from-pubchem">3.3 PNG depiction from PubChem</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pug-view-for-safety-snippets">3.4 PUG-View for safety snippets</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#nci-chemical-identifier-resolver-cir-as-a-second-path">4. NCI Chemical Identifier Resolver (CIR) as a second path</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#mini-widget">5. Mini widget</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#case-study-with-cas-from-excel">6. Case study with CAS from Excel</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#query-pubchem-by-cas-with-fallback">6.1 Query PubChem by CAS with fallback</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#enrich-a-small-slice">6.2 Enrich a small slice</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#glossary">7. Glossary</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#quick-reference">8. Quick reference</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#in-class-activity">9. In-class activity</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#verify-pubchem-vs-cir-agreement">9.1 Verify PubChem vs CIR agreement</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#small-properties-table-from-names">9.2 Small properties table from names</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#get-a-quick-ghs-note-from-pug-view">9.3 Get a quick GHS note from PUG-View</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#build-a-one-liner-resolver">9.4 Build a one-liner resolver</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#process-dataset">9.5 Process dataset</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#solutions">10. Solutions</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#solution-9-1">Solution 9.1</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#solution-9-2">Solution 9.2</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#solution-9-3">Solution 9.3</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#solution-9-4">Solution 9.4</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#solution-9-5">Solution 9.5</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="lecture-4-chemical-structure-identifier">
<h1>Lecture 4 - Chemical Structure Identifier<a class="headerlink" href="#lecture-4-chemical-structure-identifier" title="Permalink to this heading">#</a></h1>
<nav class="contents local" id="contents">
<ul class="simple">
<li><p><a class="reference internal" href="#learning-goals" id="id1">Learning goals</a></p></li>
<li><p><a class="reference internal" href="#pubchem-pug-rest-basics" id="id2">1. PubChem PUG-REST Basics</a></p></li>
<li><p><a class="reference internal" href="#from-name-to-cid-and-properties" id="id3">2. From name to CID and properties</a></p></li>
<li><p><a class="reference internal" href="#other-pubchem-features" id="id4">3. Other PubChem features</a></p></li>
<li><p><a class="reference internal" href="#nci-chemical-identifier-resolver-cir-as-a-second-path" id="id5">4. NCI Chemical Identifier Resolver (CIR) as a second path</a></p></li>
<li><p><a class="reference internal" href="#mini-widget" id="id6">5. Mini widget</a></p></li>
<li><p><a class="reference internal" href="#case-study-with-cas-from-excel" id="id7">6. Case study with CAS from Excel</a></p></li>
<li><p><a class="reference internal" href="#glossary" id="id8">7. Glossary</a></p></li>
<li><p><a class="reference internal" href="#quick-reference" id="id9">8. Quick reference</a></p></li>
<li><p><a class="reference internal" href="#in-class-activity" id="id10">9. In-class activity</a></p></li>
<li><p><a class="reference internal" href="#solutions" id="id11">10. Solutions</a></p></li>
</ul>
</nav>
<section id="learning-goals">
<h2><a class="toc-backref" href="#id1" role="doc-backlink">Learning goals</a><a class="headerlink" href="#learning-goals" title="Permalink to this heading">#</a></h2>
<ul class="simple">
<li><p>Understand PubChem as a data service via <strong>PUG-REST</strong> and <strong>PUG-View</strong>.</p></li>
<li><p>Form URLs that return JSON, TXT or images.</p></li>
<li><p>Resolve names, SMILES and CAS numbers to CIDs.</p></li>
<li><p>Retrieve IUPAC, SMILES, InChIKey and selected properties.</p></li>
<li><p>Use the <strong>NCI Chemical Identifier Resolver (CIR)</strong> as a second query path.</p></li>
<li><p>Build small helper functions with error handling and fallbacks.</p></li>
<li><p>Practice with a real Excel sheet of ligands that contains CAS numbers.</p></li>
<li><p>Create a tiny widget that accepts name or SMILES or CAS and returns a summary and a GIF.<br />
<a class="reference external" href="https://colab.research.google.com/drive/1ARO7FjUB-GoDZJV96E5d3QtSpOHa-oc8?usp=sharing"><img alt="Colab" src="https://img.shields.io/badge/Open-Colab-orange" /></a></p></li>
</ul>
</section>
<hr class="docutils" />
<section id="pubchem-pug-rest-basics">
<h2><a class="toc-backref" href="#id2" role="doc-backlink">1. PubChem PUG-REST Basics</a><a class="headerlink" href="#pubchem-pug-rest-basics" title="Permalink to this heading">#</a></h2>
<section id="setup">
<h3>1.1 Setup<a class="headerlink" href="#setup" title="Permalink to this heading">#</a></h3>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Networking</span>
<span class="k">try</span><span class="p">:</span>
    <span class="kn">import</span><span class="w"> </span><span class="nn">requests</span>
<span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
    <span class="o">%</span><span class="k">pip</span> -q install requests
    <span class="kn">import</span><span class="w"> </span><span class="nn">requests</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">urllib.parse</span><span class="w"> </span><span class="kn">import</span> <span class="n">quote_plus</span>

<span class="c1"># Optional drawing and widgets</span>
<span class="k">try</span><span class="p">:</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">rdkit</span><span class="w"> </span><span class="kn">import</span> <span class="n">Chem</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">rdkit.Chem</span><span class="w"> </span><span class="kn">import</span> <span class="n">Draw</span><span class="p">,</span> <span class="n">Descriptors</span><span class="p">,</span> <span class="n">Crippen</span><span class="p">,</span> <span class="n">rdMolDescriptors</span><span class="p">,</span> <span class="n">AllChem</span>
<span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="o">%</span><span class="k">pip</span> -q install rdkit-pypi
        <span class="kn">from</span><span class="w"> </span><span class="nn">rdkit</span><span class="w"> </span><span class="kn">import</span> <span class="n">Chem</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">rdkit.Chem</span><span class="w"> </span><span class="kn">import</span> <span class="n">Draw</span><span class="p">,</span> <span class="n">Descriptors</span><span class="p">,</span> <span class="n">Crippen</span><span class="p">,</span> <span class="n">rdMolDescriptors</span><span class="p">,</span> <span class="n">AllChem</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;RDKit is not available in this environment. Drawing and descriptors will be skipped.&quot;</span><span class="p">)</span>
        <span class="n">Chem</span> <span class="o">=</span> <span class="kc">None</span>

<span class="k">try</span><span class="p">:</span>
    <span class="kn">import</span><span class="w"> </span><span class="nn">ipywidgets</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">widgets</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">IPython.display</span><span class="w"> </span><span class="kn">import</span> <span class="n">display</span><span class="p">,</span> <span class="n">HTML</span><span class="p">,</span> <span class="n">Image</span><span class="p">,</span> <span class="n">clear_output</span>
<span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="o">%</span><span class="k">pip</span> -q install ipywidgets
        <span class="kn">import</span><span class="w"> </span><span class="nn">ipywidgets</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">widgets</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">IPython.display</span><span class="w"> </span><span class="kn">import</span> <span class="n">display</span><span class="p">,</span> <span class="n">HTML</span><span class="p">,</span> <span class="n">Image</span><span class="p">,</span> <span class="n">clear_output</span>
    <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
        <span class="n">widgets</span> <span class="o">=</span> <span class="kc">None</span>

<span class="k">try</span><span class="p">:</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">PIL</span><span class="w"> </span><span class="kn">import</span> <span class="n">Image</span> <span class="k">as</span> <span class="n">PILImage</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">io</span><span class="w"> </span><span class="kn">import</span> <span class="n">BytesIO</span>
<span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
    <span class="o">%</span><span class="k">pip</span> -q install pillow
    <span class="kn">from</span><span class="w"> </span><span class="nn">PIL</span><span class="w"> </span><span class="kn">import</span> <span class="n">Image</span> <span class="k">as</span> <span class="n">PILImage</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">io</span><span class="w"> </span><span class="kn">import</span> <span class="n">BytesIO</span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
<hr class="docutils" />
<section id="background-information">
<h3>1.2 Background Information<a class="headerlink" href="#background-information" title="Permalink to this heading">#</a></h3>
<p>Instead of going to <a class="reference external" href="https://pubchem.ncbi.nlm.nih.gov">PubChem’s main site</a> and manually searching for a compound, we can also use a <strong>direct URL</strong> to query PubChem’s REST API. This allows us to send structured requests and retrieve data in machine-readable formats such as JSON, XML, or plain text.</p>
<p>Other latest features of PubChem can be found in  <em>Nucleic Acids Research</em>, 2025, 53 (D1), D1516–D1525. <a class="reference external" href="https://academic.oup.com/nar/article/53/D1/D1516/7903365?login=false"><img alt="Read" src="https://img.shields.io/badge/Read-Paper-blue" /></a></p>
<p>The figure below illustrates the general workflow of PUG-REST: provide an input (like a compound name), choose an operation (for example, retrieving a CID), and specify the output format. Using URLs in this way not only automates lookups but also integrates PubChem data smoothly into code and analysis.</p>
<p><img alt="PubChem PUG-REST Figure" src="https://iupac.github.io/WFChemCookbook/_images/pubchem_pugrest_fig1.jpg" /></p>
<p>Here is a summary:</p>
<ul class="simple">
<li><p><strong>Input</strong>: name, CID, InChIKey, SMILES, or CAS number.</p></li>
<li><p><strong>Operation</strong>: what property you want (CID, IUPAC, SMILES, etc.).</p></li>
<li><p><strong>Output</strong>: JSON, XML, or TXT.</p></li>
</ul>
<p>Here are some example URLs you can click and explore directly in a browser:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://pubchem.ncbi.nlm.nih.gov/rest/pug/compound/name/aspirin/property/SMILES/TXT">https://pubchem.ncbi.nlm.nih.gov/rest/pug/compound/name/aspirin/property/SMILES/TXT</a>: Returns the SMILES string for aspirin.</p></li>
<li><p><a class="reference external" href="https://pubchem.ncbi.nlm.nih.gov/rest/pug/compound/cid/2244/property/SMILES/JSON">https://pubchem.ncbi.nlm.nih.gov/rest/pug/compound/cid/2244/property/SMILES/JSON</a>: Returns the SMILES string for a compound with PubChem CID 2244.</p></li>
<li><p><a class="reference external" href="https://pubchem.ncbi.nlm.nih.gov/rest/pug/compound/name/aspirin/cids/JSON">https://pubchem.ncbi.nlm.nih.gov/rest/pug/compound/name/aspirin/cids/JSON</a>: Returns the PubChem Compound ID (CID) for aspirin.</p></li>
<li><p><a class="reference external" href="https://pubchem.ncbi.nlm.nih.gov/rest/pug/compound/cid/2244/property/IUPACName/JSON">https://pubchem.ncbi.nlm.nih.gov/rest/pug/compound/cid/2244/property/IUPACName/JSON</a>: Returns the standardized IUPAC name.</p></li>
<li><p><a class="reference external" href="https://pubchem.ncbi.nlm.nih.gov/rest/pug/compound/cid/2244/property/CanonicalSMILES/JSON">https://pubchem.ncbi.nlm.nih.gov/rest/pug/compound/cid/2244/property/CanonicalSMILES/JSON</a>: Returns the canonical SMILES string representation.</p></li>
</ul>
<p>For more information on how to use PUG-REST URL, please see <a class="reference external" href="https://pubchem.ncbi.nlm.nih.gov/docs/pug-rest"><img alt="Read" src="https://img.shields.io/badge/Open-Website-green" /></a></p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The key idea is that PubChem is not only a website but also a programmatic data service. A well-formed URL acts like a query to their database.</p>
</div>
<p>If you are interested in learning more about PubChem URL, please read:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://iupac.github.io/WFChemCookbook/datasources/pubchem_pugrest1.html">IUPAC FAIR Chemistry Cookbook guide</a></p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Always read the URL as:</p>
<ol class="arabic simple">
<li><p>Base: <code class="docutils literal notranslate"><span class="pre">https://pubchem.ncbi.nlm.nih.gov/rest/pug</span></code></p></li>
<li><p>Section: <code class="docutils literal notranslate"><span class="pre">compound</span></code> (since we work with compounds)</p></li>
<li><p>Identifier type: <code class="docutils literal notranslate"><span class="pre">name</span></code>, <code class="docutils literal notranslate"><span class="pre">cid</span></code>, <code class="docutils literal notranslate"><span class="pre">smiles</span></code>, <code class="docutils literal notranslate"><span class="pre">cas</span></code></p></li>
<li><p>Action: what property to fetch</p></li>
<li><p>Format: <code class="docutils literal notranslate"><span class="pre">JSON</span></code>, <code class="docutils literal notranslate"><span class="pre">XML</span></code>, <code class="docutils literal notranslate"><span class="pre">TXT</span></code></p></li>
</ol>
</div>
</section>
</section>
<hr class="docutils" />
<section id="from-name-to-cid-and-properties">
<h2><a class="toc-backref" href="#id3" role="doc-backlink">2. From name to CID and properties</a><a class="headerlink" href="#from-name-to-cid-and-properties" title="Permalink to this heading">#</a></h2>
<section id="form-the-url">
<h3>2.1 Form the URL<a class="headerlink" href="#form-the-url" title="Permalink to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;acetaminophen&quot;</span>
<span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;https://pubchem.ncbi.nlm.nih.gov/rest/pug/compound/name/</span><span class="si">{</span><span class="n">quote_plus</span><span class="p">(</span><span class="n">name</span><span class="p">)</span><span class="si">}</span><span class="s2">/cids/JSON&quot;</span>
<span class="nb">print</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>https://pubchem.ncbi.nlm.nih.gov/rest/pug/compound/name/acetaminophen/cids/JSON
</pre></div>
</div>
</div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Try pasting this URL into your browser. You should see a JSON object with <code class="docutils literal notranslate"><span class="pre">&quot;CID&quot;</span></code>.</p>
</div>
</section>
<section id="request-and-parse">
<h3>2.2 Request and parse<a class="headerlink" href="#request-and-parse" title="Permalink to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Install requests if you do not have it</span>
<span class="k">try</span><span class="p">:</span>
    <span class="kn">import</span><span class="w"> </span><span class="nn">requests</span>
<span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
    <span class="o">%</span><span class="k">pip</span> -q install requests
    <span class="kn">import</span><span class="w"> </span><span class="nn">requests</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">urllib.parse</span><span class="w"> </span><span class="kn">import</span> <span class="n">quote_plus</span>  
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">r</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;IdentifierList&#39;: {&#39;CID&#39;: [1983]}}
</pre></div>
</div>
</div>
</div>
<p>Break it down:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;IdentifierList&quot;</span><span class="p">,</span> <span class="p">{}))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>dict_keys([&#39;IdentifierList&#39;])
{&#39;CID&#39;: [1983]}
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cid_list</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;IdentifierList&quot;</span><span class="p">,</span> <span class="p">{})</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;CID&quot;</span><span class="p">,</span> <span class="p">[])</span>
<span class="n">cid</span> <span class="o">=</span> <span class="n">cid_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;CID:&quot;</span><span class="p">,</span> <span class="n">cid</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CID: 1983
</pre></div>
</div>
</div>
</div>
</section>
<hr class="docutils" />
<section id="iupac-name">
<h3>2.3 IUPAC name<a class="headerlink" href="#iupac-name" title="Permalink to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cid</span> <span class="o">=</span> <span class="mi">2244</span>  <span class="c1"># aspirin</span>
<span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;https://pubchem.ncbi.nlm.nih.gov/rest/pug/compound/cid/</span><span class="si">{</span><span class="n">cid</span><span class="si">}</span><span class="s2">/property/IUPACName/JSON&quot;</span>
<span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span>
<span class="n">r</span><span class="o">.</span><span class="n">raise_for_status</span><span class="p">()</span>
<span class="n">props</span> <span class="o">=</span> <span class="n">r</span><span class="o">.</span><span class="n">json</span><span class="p">()[</span><span class="s2">&quot;PropertyTable&quot;</span><span class="p">][</span><span class="s2">&quot;Properties&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;IUPAC:&quot;</span><span class="p">,</span> <span class="n">props</span><span class="p">[</span><span class="s2">&quot;IUPACName&quot;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>IUPAC: 2-acetyloxybenzoic acid
</pre></div>
</div>
</div>
</div>
</section>
<section id="canonical-vs-isomeric-smiles">
<h3>2.4 Canonical vs isomeric SMILES<a class="headerlink" href="#canonical-vs-isomeric-smiles" title="Permalink to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">canon</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;https://pubchem.ncbi.nlm.nih.gov/rest/pug/compound/cid/</span><span class="si">{</span><span class="n">cid</span><span class="si">}</span><span class="s2">/property/CanonicalSMILES/TXT&quot;</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span><span class="o">.</span><span class="n">text</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
<span class="n">iso</span>   <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;https://pubchem.ncbi.nlm.nih.gov/rest/pug/compound/cid/</span><span class="si">{</span><span class="n">cid</span><span class="si">}</span><span class="s2">/property/IsomericSMILES/TXT&quot;</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span><span class="o">.</span><span class="n">text</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Canonical:&quot;</span><span class="p">,</span> <span class="n">canon</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Isomeric :&quot;</span><span class="p">,</span> <span class="n">iso</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Canonical: CC(=O)OC1=CC=CC=C1C(=O)O
Isomeric : CC(=O)OC1=CC=CC=C1C(=O)O
</pre></div>
</div>
</div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Canonical SMILES is normalized and does not carry stereochemistry.<br />
Isomeric SMILES includes stereochemistry and isotopes if available.</p>
</div>
</section>
<hr class="docutils" />
<section id="safer-helpers">
<h3>2.5 Safer helpers<a class="headerlink" href="#safer-helpers" title="Permalink to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">safe_get_json</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">30</span><span class="p">):</span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="n">timeout</span><span class="p">)</span>
    <span class="n">r</span><span class="o">.</span><span class="n">raise_for_status</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">r</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>

<span class="k">def</span><span class="w"> </span><span class="nf">safe_get_text</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">30</span><span class="p">):</span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="n">timeout</span><span class="p">)</span>
    <span class="n">r</span><span class="o">.</span><span class="n">raise_for_status</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">r</span><span class="o">.</span><span class="n">text</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>

<span class="k">def</span><span class="w"> </span><span class="nf">safe_get_bytes</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">30</span><span class="p">):</span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="n">timeout</span><span class="p">)</span>
    <span class="n">r</span><span class="o">.</span><span class="n">raise_for_status</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">r</span><span class="o">.</span><span class="n">content</span>
</pre></div>
</div>
</div>
</div>
</section>
<hr class="docutils" />
<section id="write-convenience-functions-by-name">
<h3>2.6 Write convenience functions (by name)<a class="headerlink" href="#write-convenience-functions-by-name" title="Permalink to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">pubchem_by_name</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">isomeric</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
    <span class="n">enc</span> <span class="o">=</span> <span class="n">quote_plus</span><span class="p">(</span><span class="n">name</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span>
    <span class="n">kind</span> <span class="o">=</span> <span class="s2">&quot;IsomericSMILES&quot;</span> <span class="k">if</span> <span class="n">isomeric</span> <span class="k">else</span> <span class="s2">&quot;CanonicalSMILES&quot;</span>
    <span class="n">smi_url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;https://pubchem.ncbi.nlm.nih.gov/rest/pug/compound/name/</span><span class="si">{</span><span class="n">enc</span><span class="si">}</span><span class="s2">/property/</span><span class="si">{</span><span class="n">kind</span><span class="si">}</span><span class="s2">/TXT&quot;</span>
    <span class="n">smiles</span> <span class="o">=</span> <span class="n">safe_get_text</span><span class="p">(</span><span class="n">smi_url</span><span class="p">)</span>

    <span class="n">cid_url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;https://pubchem.ncbi.nlm.nih.gov/rest/pug/compound/name/</span><span class="si">{</span><span class="n">enc</span><span class="si">}</span><span class="s2">/cids/JSON&quot;</span>
    <span class="n">cid_list</span> <span class="o">=</span> <span class="n">safe_get_json</span><span class="p">(</span><span class="n">cid_url</span><span class="p">)</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;IdentifierList&quot;</span><span class="p">,</span> <span class="p">{})</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;CID&quot;</span><span class="p">,</span> <span class="p">[])</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">cid_list</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;No CID found&quot;</span><span class="p">)</span>
    <span class="n">cid</span> <span class="o">=</span> <span class="n">cid_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

    <span class="n">iupac_url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;https://pubchem.ncbi.nlm.nih.gov/rest/pug/compound/cid/</span><span class="si">{</span><span class="n">cid</span><span class="si">}</span><span class="s2">/property/IUPACName/TXT&quot;</span>
    <span class="n">iupac</span> <span class="o">=</span> <span class="n">safe_get_text</span><span class="p">(</span><span class="n">iupac_url</span><span class="p">)</span>

    <span class="n">inchikey_url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;https://pubchem.ncbi.nlm.nih.gov/rest/pug/compound/cid/</span><span class="si">{</span><span class="n">cid</span><span class="si">}</span><span class="s2">/property/InChIKey/TXT&quot;</span>
    <span class="n">inchikey</span> <span class="o">=</span> <span class="n">safe_get_text</span><span class="p">(</span><span class="n">inchikey_url</span><span class="p">)</span>

    <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;input&quot;</span><span class="p">:</span> <span class="n">name</span><span class="p">,</span> <span class="s2">&quot;cid&quot;</span><span class="p">:</span> <span class="n">cid</span><span class="p">,</span> <span class="s2">&quot;smiles&quot;</span><span class="p">:</span> <span class="n">smiles</span><span class="p">,</span> <span class="s2">&quot;iupac&quot;</span><span class="p">:</span> <span class="n">iupac</span><span class="p">,</span> <span class="s2">&quot;inchikey&quot;</span><span class="p">:</span> <span class="n">inchikey</span><span class="p">}</span>

<span class="n">pubchem_by_name</span><span class="p">(</span><span class="s2">&quot;ibuprofen&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;input&#39;: &#39;ibuprofen&#39;,
 &#39;cid&#39;: 3672,
 &#39;smiles&#39;: &#39;CC(C)CC1=CC=C(C=C1)C(C)C(=O)O&#39;,
 &#39;iupac&#39;: &#39;2-[4-(2-methylpropyl)phenyl]propanoic acid&#39;,
 &#39;inchikey&#39;: &#39;HEFNNWSXXWATRW-UHFFFAOYSA-N&#39;}
</pre></div>
</div>
</div>
</div>
</section>
<section id="write-convenience-functions-by-cid">
<h3>2.7 Write convenience functions (by CID)<a class="headerlink" href="#write-convenience-functions-by-cid" title="Permalink to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">pubchem_by_cid</span><span class="p">(</span><span class="n">cid</span><span class="p">,</span> <span class="n">isomeric</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
    <span class="n">cid</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">cid</span><span class="p">)</span>
    <span class="n">kind</span> <span class="o">=</span> <span class="s2">&quot;IsomericSMILES&quot;</span> <span class="k">if</span> <span class="n">isomeric</span> <span class="k">else</span> <span class="s2">&quot;CanonicalSMILES&quot;</span>
    <span class="n">smi_url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;https://pubchem.ncbi.nlm.nih.gov/rest/pug/compound/cid/</span><span class="si">{</span><span class="n">cid</span><span class="si">}</span><span class="s2">/property/</span><span class="si">{</span><span class="n">kind</span><span class="si">}</span><span class="s2">/TXT&quot;</span>
    <span class="n">smiles</span> <span class="o">=</span> <span class="n">safe_get_text</span><span class="p">(</span><span class="n">smi_url</span><span class="p">)</span>
    <span class="n">iupac_url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;https://pubchem.ncbi.nlm.nih.gov/rest/pug/compound/cid/</span><span class="si">{</span><span class="n">cid</span><span class="si">}</span><span class="s2">/property/IUPACName/TXT&quot;</span>
    <span class="n">iupac</span> <span class="o">=</span> <span class="n">safe_get_text</span><span class="p">(</span><span class="n">iupac_url</span><span class="p">)</span>
    <span class="n">inchikey_url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;https://pubchem.ncbi.nlm.nih.gov/rest/pug/compound/cid/</span><span class="si">{</span><span class="n">cid</span><span class="si">}</span><span class="s2">/property/InChIKey/TXT&quot;</span>
    <span class="n">inchikey</span> <span class="o">=</span> <span class="n">safe_get_text</span><span class="p">(</span><span class="n">inchikey_url</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;cid&quot;</span><span class="p">:</span> <span class="n">cid</span><span class="p">,</span> <span class="s2">&quot;smiles&quot;</span><span class="p">:</span> <span class="n">smiles</span><span class="p">,</span> <span class="s2">&quot;iupac&quot;</span><span class="p">:</span> <span class="n">iupac</span><span class="p">,</span> <span class="s2">&quot;inchikey&quot;</span><span class="p">:</span> <span class="n">inchikey</span><span class="p">}</span>

<span class="n">pubchem_by_cid</span><span class="p">(</span><span class="mi">2244</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;cid&#39;: 2244,
 &#39;smiles&#39;: &#39;CC(=O)OC1=CC=CC=C1C(=O)O&#39;,
 &#39;iupac&#39;: &#39;2-acetyloxybenzoic acid&#39;,
 &#39;inchikey&#39;: &#39;BSYNRYMUTXBXSQ-UHFFFAOYSA-N&#39;}
</pre></div>
</div>
</div>
</div>
</section>
</section>
<hr class="docutils" />
<section id="other-pubchem-features">
<h2><a class="toc-backref" href="#id4" role="doc-backlink">3. Other PubChem features</a><a class="headerlink" href="#other-pubchem-features" title="Permalink to this heading">#</a></h2>
<section id="selected-computed-properties">
<h3>3.1 Selected computed properties<a class="headerlink" href="#selected-computed-properties" title="Permalink to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">pubchem_properties</span><span class="p">(</span><span class="n">cid</span><span class="p">,</span> <span class="n">fields</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;MolecularWeight&quot;</span><span class="p">,</span><span class="s2">&quot;XLogP&quot;</span><span class="p">,</span><span class="s2">&quot;ExactMass&quot;</span><span class="p">,</span><span class="s2">&quot;HBondDonorCount&quot;</span><span class="p">,</span><span class="s2">&quot;HBondAcceptorCount&quot;</span><span class="p">,</span><span class="s2">&quot;TPSA&quot;</span><span class="p">)):</span>
    <span class="n">cid</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">cid</span><span class="p">)</span>
    <span class="n">field_str</span> <span class="o">=</span> <span class="s2">&quot;,&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">fields</span><span class="p">)</span>
    <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;https://pubchem.ncbi.nlm.nih.gov/rest/pug/compound/cid/</span><span class="si">{</span><span class="n">cid</span><span class="si">}</span><span class="s2">/property/</span><span class="si">{</span><span class="n">field_str</span><span class="si">}</span><span class="s2">/JSON&quot;</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">safe_get_json</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;PropertyTable&quot;</span><span class="p">][</span><span class="s2">&quot;Properties&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>

<span class="n">pubchem_properties</span><span class="p">(</span><span class="mi">2244</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;CID&#39;: 2244,
 &#39;MolecularWeight&#39;: &#39;180.16&#39;,
 &#39;XLogP&#39;: 1.2,
 &#39;ExactMass&#39;: &#39;180.04225873&#39;,
 &#39;TPSA&#39;: 63.6,
 &#39;HBondDonorCount&#39;: 1,
 &#39;HBondAcceptorCount&#39;: 4}
</pre></div>
</div>
</div>
</div>
</section>
<section id="synonyms">
<h3>3.2 Synonyms<a class="headerlink" href="#synonyms" title="Permalink to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">pubchem_synonyms</span><span class="p">(</span><span class="n">cid</span><span class="p">,</span> <span class="n">limit</span><span class="o">=</span><span class="mi">10</span><span class="p">):</span>
    <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;https://pubchem.ncbi.nlm.nih.gov/rest/pug/compound/cid/</span><span class="si">{</span><span class="nb">int</span><span class="p">(</span><span class="n">cid</span><span class="p">)</span><span class="si">}</span><span class="s2">/synonyms/JSON&quot;</span>
    <span class="n">syns</span> <span class="o">=</span> <span class="n">safe_get_json</span><span class="p">(</span><span class="n">url</span><span class="p">)</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;InformationList&quot;</span><span class="p">,</span> <span class="p">{})</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;Information&quot;</span><span class="p">,</span> <span class="p">[{}])[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;Synonym&quot;</span><span class="p">,</span> <span class="p">[])</span>
    <span class="k">return</span> <span class="n">syns</span><span class="p">[:</span><span class="n">limit</span><span class="p">]</span>

<span class="n">pubchem_synonyms</span><span class="p">(</span><span class="mi">2244</span><span class="p">,</span> <span class="n">limit</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;aspirin&#39;,
 &#39;ACETYLSALICYLIC ACID&#39;,
 &#39;50-78-2&#39;,
 &#39;2-Acetoxybenzoic acid&#39;,
 &#39;2-(Acetyloxy)benzoic acid&#39;,
 &#39;O-Acetylsalicylic acid&#39;,
 &#39;o-Acetoxybenzoic acid&#39;,
 &#39;Acylpyrin&#39;]
</pre></div>
</div>
</div>
</div>
</section>
<section id="png-depiction-from-pubchem">
<h3>3.3 PNG depiction from PubChem<a class="headerlink" href="#png-depiction-from-pubchem" title="Permalink to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">pubchem_png_by_cid</span><span class="p">(</span><span class="n">cid</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">300</span><span class="p">):</span>
    <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;https://pubchem.ncbi.nlm.nih.gov/rest/pug/compound/cid/</span><span class="si">{</span><span class="nb">int</span><span class="p">(</span><span class="n">cid</span><span class="p">)</span><span class="si">}</span><span class="s2">/PNG?image_size=</span><span class="si">{</span><span class="nb">int</span><span class="p">(</span><span class="n">size</span><span class="p">)</span><span class="si">}</span><span class="s2">x</span><span class="si">{</span><span class="nb">int</span><span class="p">(</span><span class="n">size</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="k">return</span> <span class="n">safe_get_bytes</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>

<span class="n">png_bytes</span> <span class="o">=</span> <span class="n">pubchem_png_by_cid</span><span class="p">(</span><span class="mi">2244</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">Image</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">png_bytes</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/5cf4d7a27665813bb592846a492ae78856c5c1e87ff1becd30d92ba719b5dce4.png" src="_images/5cf4d7a27665813bb592846a492ae78856c5c1e87ff1becd30d92ba719b5dce4.png" />
</div>
</div>
</section>
<section id="pug-view-for-safety-snippets">
<h3>3.4 PUG-View for safety snippets<a class="headerlink" href="#pug-view-for-safety-snippets" title="Permalink to this heading">#</a></h3>
<p><code class="docutils literal notranslate"><span class="pre">PUG-View</span></code> serves formatted record content such as GHS classification. The path is:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">pubchem</span><span class="o">.</span><span class="n">ncbi</span><span class="o">.</span><span class="n">nlm</span><span class="o">.</span><span class="n">nih</span><span class="o">.</span><span class="n">gov</span><span class="o">/</span><span class="n">rest</span><span class="o">/</span><span class="n">pug_view</span><span class="o">/</span><span class="n">data</span><span class="o">/</span><span class="n">compound</span><span class="o">/&lt;</span><span class="n">cid</span><span class="o">&gt;/</span><span class="n">JSON</span>
</pre></div>
</div>
<p>The JSON is nested. The simple utility below searches for any block whose title contains a keyword.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">pug_view_find_sections</span><span class="p">(</span><span class="n">cid</span><span class="p">,</span> <span class="n">keyword</span><span class="o">=</span><span class="s2">&quot;GHS&quot;</span><span class="p">):</span>
    <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;https://pubchem.ncbi.nlm.nih.gov/rest/pug_view/data/compound/</span><span class="si">{</span><span class="nb">int</span><span class="p">(</span><span class="n">cid</span><span class="p">)</span><span class="si">}</span><span class="s2">/JSON&quot;</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">safe_get_json</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
    <span class="n">hits</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">walk</span><span class="p">(</span><span class="n">sections</span><span class="p">,</span> <span class="n">path</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">sec</span> <span class="ow">in</span> <span class="n">sections</span> <span class="ow">or</span> <span class="p">[]:</span>
            <span class="n">title</span> <span class="o">=</span> <span class="n">sec</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;TOCHeading&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="ow">or</span> <span class="n">sec</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;Title&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">keyword</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">in</span> <span class="n">title</span><span class="o">.</span><span class="n">lower</span><span class="p">():</span>
                <span class="n">hits</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s2">&quot;title&quot;</span><span class="p">:</span> <span class="n">title</span><span class="p">,</span> <span class="s2">&quot;path&quot;</span><span class="p">:</span> <span class="n">path</span> <span class="o">+</span> <span class="s2">&quot; &gt; &quot;</span> <span class="o">+</span> <span class="n">title</span><span class="p">,</span> <span class="s2">&quot;section&quot;</span><span class="p">:</span> <span class="n">sec</span><span class="p">})</span>
            <span class="n">walk</span><span class="p">(</span><span class="n">sec</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;Section&quot;</span><span class="p">),</span> <span class="n">path</span> <span class="o">+</span> <span class="s2">&quot; &gt; &quot;</span> <span class="o">+</span> <span class="n">title</span><span class="p">)</span>
    <span class="n">rec</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;Record&quot;</span><span class="p">,</span> <span class="p">{})</span>
    <span class="n">walk</span><span class="p">(</span><span class="n">rec</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;Section&quot;</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">hits</span>

<span class="n">ghs_hits</span> <span class="o">=</span> <span class="n">pug_view_find_sections</span><span class="p">(</span><span class="mi">2244</span><span class="p">,</span> <span class="s2">&quot;GHS&quot;</span><span class="p">)</span>
<span class="p">[</span><span class="n">x</span><span class="p">[</span><span class="s2">&quot;title&quot;</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">ghs_hits</span><span class="p">][:</span><span class="mi">5</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;GHS Classification&#39;, &#39;UN GHS Classification&#39;]
</pre></div>
</div>
</div>
</div>
<p>To show a short plain text summary, extract strings in the first hit:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">pug_view_text_from_hit</span><span class="p">(</span><span class="n">hit</span><span class="p">,</span> <span class="n">max_lines</span><span class="o">=</span><span class="mi">12</span><span class="p">):</span>
    <span class="n">lines</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">walk</span><span class="p">(</span><span class="n">sec</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">sec</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;Information&quot;</span><span class="p">,</span> <span class="p">[])</span> <span class="ow">or</span> <span class="p">[]:</span>
            <span class="n">sval</span> <span class="o">=</span> <span class="n">i</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;Value&quot;</span><span class="p">,</span> <span class="p">{})</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;StringWithMarkup&quot;</span><span class="p">,</span> <span class="p">[])</span>
            <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">sval</span><span class="p">:</span>
                <span class="n">txt</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;String&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
                <span class="k">if</span> <span class="n">txt</span><span class="p">:</span>
                    <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">txt</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">ch</span> <span class="ow">in</span> <span class="n">sec</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;Section&quot;</span><span class="p">,</span> <span class="p">[])</span> <span class="ow">or</span> <span class="p">[]:</span>
            <span class="n">walk</span><span class="p">(</span><span class="n">ch</span><span class="p">)</span>
    <span class="n">walk</span><span class="p">(</span><span class="n">hit</span><span class="p">[</span><span class="s2">&quot;section&quot;</span><span class="p">])</span>
    <span class="k">return</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">lines</span><span class="p">[:</span><span class="n">max_lines</span><span class="p">])</span>

<span class="k">if</span> <span class="n">ghs_hits</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">pug_view_text_from_hit</span><span class="p">(</span><span class="n">ghs_hits</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>This chemical does not meet GHS hazard criteria for 0.3% (1  of 315) of reports.
Warning
H302 (95.6%): Harmful if swallowed [Warning Acute toxicity, oral]
H315 (20.6%): Causes skin irritation [Warning Skin corrosion/irritation]
H319 (22.2%): Causes serious eye irritation [Warning Serious eye damage/eye irritation]
H335 (20%): May cause respiratory irritation [Warning Specific target organ toxicity, single exposure; Respiratory tract irritation]
P261, P264, P264+P265, P270, P271, P280, P301+P317, P302+P352, P304+P340, P305+P351+P338, P319, P321, P330, P332+P317, P337+P317, P362+P364, P403+P233, P405, and P501
Aggregated GHS information provided per 315 reports by companies from 23 notifications to the ECHA C&amp;L Inventory. Each notification may be associated with multiple companies.
Reported as not meeting GHS hazard criteria per 1 of 315 reports by companies.
There are 22 notifications provided by 314 of 315 reports by companies with hazard statement code(s).
Information may vary between notifications depending on impurities, additives, and other factors. The percentage value in parenthesis indicates the notified classification ratio from companies that provide hazard codes. Only hazard codes with percentage values above 10% are shown. For more detailed information, please visit  ECHA C&amp;L website.
Danger
</pre></div>
</div>
</div>
</div>
</section>
</section>
<hr class="docutils" />
<section id="nci-chemical-identifier-resolver-cir-as-a-second-path">
<h2><a class="toc-backref" href="#id5" role="doc-backlink">4. NCI Chemical Identifier Resolver (CIR) as a second path</a><a class="headerlink" href="#nci-chemical-identifier-resolver-cir-as-a-second-path" title="Permalink to this heading">#</a></h2>
<p>Base URL:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">cactus</span><span class="o">.</span><span class="n">nci</span><span class="o">.</span><span class="n">nih</span><span class="o">.</span><span class="n">gov</span><span class="o">/</span><span class="n">chemical</span><span class="o">/</span><span class="n">structure</span><span class="o">/&lt;</span><span class="nb">input</span><span class="o">&gt;/&lt;</span><span class="n">output</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>Useful outputs: <code class="docutils literal notranslate"><span class="pre">smiles</span></code>, <code class="docutils literal notranslate"><span class="pre">stdinchi</span></code>, <code class="docutils literal notranslate"><span class="pre">stdinchikey</span></code>, <code class="docutils literal notranslate"><span class="pre">names</span></code>, <code class="docutils literal notranslate"><span class="pre">cas</span></code>, <code class="docutils literal notranslate"><span class="pre">image</span></code>, <code class="docutils literal notranslate"><span class="pre">mw</span></code></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">cir_get</span><span class="p">(</span><span class="n">q</span><span class="p">,</span> <span class="n">out</span><span class="o">=</span><span class="s2">&quot;smiles&quot;</span><span class="p">):</span>
    <span class="n">q_enc</span> <span class="o">=</span> <span class="n">quote_plus</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">q</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span>
    <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;https://cactus.nci.nih.gov/chemical/structure/</span><span class="si">{</span><span class="n">q_enc</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">out</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">out</span> <span class="o">==</span> <span class="s2">&quot;image&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">safe_get_bytes</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">safe_get_text</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">None</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;SMILES:&quot;</span><span class="p">,</span> <span class="n">cir_get</span><span class="p">(</span><span class="s2">&quot;aspirin&quot;</span><span class="p">,</span> <span class="s2">&quot;smiles&quot;</span><span class="p">),</span> <span class="s2">&quot;...&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;InChIKey:&quot;</span><span class="p">,</span> <span class="n">cir_get</span><span class="p">(</span><span class="s2">&quot;aspirin&quot;</span><span class="p">,</span> <span class="s2">&quot;stdinchikey&quot;</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;CAS:&quot;</span><span class="p">,</span> <span class="n">cir_get</span><span class="p">(</span><span class="s2">&quot;aspirin&quot;</span><span class="p">,</span> <span class="s2">&quot;cas&quot;</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>SMILES: CC(=O)Oc1ccccc1C(O)=O ...
InChIKey: InChIKey=BSYNRYMUTXBXSQ-UHFFFAOYSA-N
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CAS: 50-78-2
11126-35-5
11126-37-7
2349-94-2
26914-13-6
98201-60-6
</pre></div>
</div>
</div>
</div>
</section>
<hr class="docutils" />
<section id="mini-widget">
<h2><a class="toc-backref" href="#id6" role="doc-backlink">5. Mini widget</a><a class="headerlink" href="#mini-widget" title="Permalink to this heading">#</a></h2>
<p>Enter a <strong>name or CID or SMILES or CAS</strong> and show a quick summary. Generates a small GIF from a PNG depiction so it can be shared easily.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">quick_summary</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="n">source</span><span class="o">=</span><span class="s2">&quot;PubChem&quot;</span><span class="p">):</span>
    <span class="n">q</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">query</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
    <span class="n">summary</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;query&quot;</span><span class="p">:</span> <span class="n">q</span><span class="p">,</span> <span class="s2">&quot;source&quot;</span><span class="p">:</span> <span class="n">source</span><span class="p">}</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">source</span> <span class="o">==</span> <span class="s2">&quot;PubChem&quot;</span><span class="p">:</span>  <span class="c1"># deafault PubChem</span>
            <span class="k">if</span> <span class="n">q</span><span class="o">.</span><span class="n">isdigit</span><span class="p">():</span>
                <span class="n">info</span> <span class="o">=</span> <span class="n">pubchem_by_cid</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">q</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">info</span> <span class="o">=</span> <span class="n">pubchem_by_name</span><span class="p">(</span><span class="n">q</span><span class="p">)</span>
            <span class="n">summary</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">info</span><span class="p">)</span>
            <span class="n">png</span> <span class="o">=</span> <span class="n">pubchem_png_by_cid</span><span class="p">(</span><span class="n">summary</span><span class="p">[</span><span class="s2">&quot;cid&quot;</span><span class="p">],</span> <span class="n">size</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>
            <span class="n">summary</span><span class="p">[</span><span class="s2">&quot;image&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">png</span>    
        <span class="k">else</span><span class="p">:</span> <span class="c1">#use CIR</span>
            <span class="n">summary</span><span class="p">[</span><span class="s2">&quot;smiles&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">cir_by_name</span><span class="p">(</span><span class="n">q</span><span class="p">,</span> <span class="s2">&quot;smiles&quot;</span><span class="p">)</span>
            <span class="n">summary</span><span class="p">[</span><span class="s2">&quot;inchikey&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">cir_by_name</span><span class="p">(</span><span class="n">q</span><span class="p">,</span> <span class="s2">&quot;stdinchikey&quot;</span><span class="p">)</span>
            <span class="n">summary</span><span class="p">[</span><span class="s2">&quot;iupac&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">cir_by_name</span><span class="p">(</span><span class="n">q</span><span class="p">,</span> <span class="s2">&quot;iupac_name&quot;</span><span class="p">)</span>
            <span class="n">img</span> <span class="o">=</span> <span class="n">cir_by_name</span><span class="p">(</span><span class="n">q</span><span class="p">,</span> <span class="s2">&quot;image&quot;</span><span class="p">)</span>
            <span class="n">summary</span><span class="p">[</span><span class="s2">&quot;image&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">img</span> <span class="k">if</span> <span class="n">img</span> <span class="k">else</span> <span class="kc">None</span>
        <span class="k">return</span> <span class="n">summary</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="n">summary</span><span class="p">[</span><span class="s2">&quot;error&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">summary</span>

<span class="k">def</span><span class="w"> </span><span class="nf">run_fetch</span><span class="p">(</span><span class="n">b</span><span class="p">):</span>
    <span class="k">with</span> <span class="n">out</span><span class="p">:</span>
        <span class="n">clear_output</span><span class="p">()</span>
        <span class="n">res</span> <span class="o">=</span> <span class="n">quick_summary</span><span class="p">(</span><span class="n">inp</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">source</span><span class="o">=</span><span class="n">src</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
        <span class="k">if</span> <span class="s2">&quot;error&quot;</span> <span class="ow">in</span> <span class="n">res</span><span class="p">:</span>
             <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Error:&quot;</span><span class="p">,</span> <span class="n">res</span><span class="p">[</span><span class="s2">&quot;error&quot;</span><span class="p">])</span>
             <span class="k">return</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Source:&quot;</span><span class="p">,</span> <span class="n">res</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;source&quot;</span><span class="p">))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;CID:&quot;</span><span class="p">,</span> <span class="n">res</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;cid&quot;</span><span class="p">))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;IUPAC:&quot;</span><span class="p">,</span> <span class="n">res</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;iupac&quot;</span><span class="p">))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;SMILES:&quot;</span><span class="p">,</span> <span class="n">res</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;smiles&quot;</span><span class="p">))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;InChIKey:&quot;</span><span class="p">,</span> <span class="n">res</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;inchikey&quot;</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">res</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;image&quot;</span><span class="p">):</span>
            <span class="n">display</span><span class="p">(</span><span class="n">Image</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">res</span><span class="p">[</span><span class="s2">&quot;image&quot;</span><span class="p">]))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;No image available&quot;</span><span class="p">)</span>
                
<span class="k">if</span> <span class="n">widgets</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
    <span class="n">inp</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">Text</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="s2">&quot;aspirin&quot;</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Query:&quot;</span><span class="p">,</span> <span class="n">layout</span><span class="o">=</span><span class="n">widgets</span><span class="o">.</span><span class="n">Layout</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="s2">&quot;60%&quot;</span><span class="p">))</span>
    <span class="n">src</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">ToggleButtons</span><span class="p">(</span><span class="n">options</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;PubChem&quot;</span><span class="p">,</span><span class="s2">&quot;CIR&quot;</span><span class="p">],</span> <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Source:&quot;</span><span class="p">)</span>
    <span class="n">btn</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="n">description</span><span class="o">=</span><span class="s2">&quot;Fetch&quot;</span><span class="p">,</span> <span class="n">button_style</span><span class="o">=</span><span class="s2">&quot;primary&quot;</span><span class="p">)</span>
    <span class="n">out</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">Output</span><span class="p">()</span>
    <span class="n">btn</span><span class="o">.</span><span class="n">on_click</span><span class="p">(</span><span class="n">run_fetch</span><span class="p">)</span>
    <span class="n">display</span><span class="p">(</span><span class="n">widgets</span><span class="o">.</span><span class="n">HBox</span><span class="p">([</span><span class="n">inp</span><span class="p">,</span> <span class="n">src</span><span class="p">,</span> <span class="n">btn</span><span class="p">]),</span> <span class="n">out</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;ipywidgets is not available in this environment.&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<<<<<<< HEAD
<script type="application/vnd.jupyter.widget-view+json">{"version_major": 2, "version_minor": 0, "model_id": "96e3d88de1c649bd8eb0209bfb4de3b2"}</script><script type="application/vnd.jupyter.widget-view+json">{"version_major": 2, "version_minor": 0, "model_id": "57056bcf51374adbbb46b0b2ceda3811"}</script></div>
=======
<script type="application/vnd.jupyter.widget-view+json">{"version_major": 2, "version_minor": 0, "model_id": "d6b3ebf1d9a14512b7c1efa478256109"}</script><script type="application/vnd.jupyter.widget-view+json">{"version_major": 2, "version_minor": 0, "model_id": "a65285ff2f1d4446bb21bb33e30e23cf"}</script></div>
>>>>>>> 6cda9aa (0929-1)
</div>
</section>
<hr class="docutils" />
<section id="case-study-with-cas-from-excel">
<h2><a class="toc-backref" href="#id7" role="doc-backlink">6. Case study with CAS from Excel</a><a class="headerlink" href="#case-study-with-cas-from-excel" title="Permalink to this heading">#</a></h2>
<p>We will re-use the inventory file:</p>
<p>📂 <code class="docutils literal notranslate"><span class="pre">organic</span> <span class="pre">ligands</span> <span class="pre">inventory.xlsx</span></code><br />
<a class="reference external" href="https://raw.githubusercontent.com/zzhenglab/ai4chem/main/book/_data/organic_ligands_inventory.xlsx">https://raw.githubusercontent.com/zzhenglab/ai4chem/main/book/_data/organic_ligands_inventory.xlsx</a></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>

<span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;https://raw.githubusercontent.com/zzhenglab/ai4chem/main/book/_data/organic_ligands_inventory.xlsx&quot;</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">engine</span><span class="o">=</span><span class="s2">&quot;openpyxl&quot;</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>CAS</th>
      <th>Product Name</th>
      <th>MW</th>
      <th>Purity</th>
      <th>Stock</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2039-06-7</td>
      <td>3,5-Diphenyl-4H-1,2,4-triazole</td>
      <td>221.263</td>
      <td>98%</td>
      <td>In Stock</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2127-07-3</td>
      <td>1,2-Bis(2-(pyridin-4-yl)ethyl)disulfane</td>
      <td>276.420</td>
      <td>98%</td>
      <td>In Stock</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2359-09-3</td>
      <td>5-tert-Butylisophthalic acid</td>
      <td>222.240</td>
      <td>96%</td>
      <td>In Stock</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2384-02-3</td>
      <td>1H,1'H-3,3'-Bipyrazole</td>
      <td>134.140</td>
      <td>98%</td>
      <td>In Stock</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2790-09-2</td>
      <td>4,6-Dimethylisophthalic acid</td>
      <td>194.186</td>
      <td>98%</td>
      <td>In Stock</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="admonition-why-openpyxl admonition">
<p class="admonition-title">Why “openpyxl”?</p>
<p>In previous example, we directly read csv. However, to access excell spreedsheet, we need to specify <code class="docutils literal notranslate"><span class="pre">engine=&quot;openpyxl&quot;</span></code>.</p>
</div>
<section id="query-pubchem-by-cas-with-fallback">
<h3>6.1 Query PubChem by CAS with fallback<a class="headerlink" href="#query-pubchem-by-cas-with-fallback" title="Permalink to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">by_cas_with_fallback</span><span class="p">(</span><span class="n">cas</span><span class="p">,</span> <span class="n">isomeric</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
    <span class="n">enc</span> <span class="o">=</span> <span class="n">quote_plus</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">cas</span><span class="p">))</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">kind</span> <span class="o">=</span> <span class="s2">&quot;IsomericSMILES&quot;</span> <span class="k">if</span> <span class="n">isomeric</span> <span class="k">else</span> <span class="s2">&quot;CanonicalSMILES&quot;</span>
        <span class="n">smi_url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;https://pubchem.ncbi.nlm.nih.gov/rest/pug/compound/name/</span><span class="si">{</span><span class="n">enc</span><span class="si">}</span><span class="s2">/property/</span><span class="si">{</span><span class="n">kind</span><span class="si">}</span><span class="s2">/TXT&quot;</span>
        <span class="n">smiles</span> <span class="o">=</span> <span class="n">safe_get_text</span><span class="p">(</span><span class="n">smi_url</span><span class="p">)</span>
        <span class="n">cid_url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;https://pubchem.ncbi.nlm.nih.gov/rest/pug/compound/name/</span><span class="si">{</span><span class="n">enc</span><span class="si">}</span><span class="s2">/cids/TXT&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">cid</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">safe_get_text</span><span class="p">(</span><span class="n">cid_url</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="mi">0</span><span class="p">])</span>
        <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
            <span class="n">cid</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
        <span class="n">smiles</span> <span class="o">=</span> <span class="n">cir_get</span><span class="p">(</span><span class="n">cas</span><span class="p">,</span> <span class="s2">&quot;smiles&quot;</span><span class="p">)</span>
        <span class="n">cid</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;cas&quot;</span><span class="p">:</span> <span class="n">cas</span><span class="p">,</span> <span class="s2">&quot;cid&quot;</span><span class="p">:</span> <span class="n">cid</span><span class="p">,</span> <span class="s2">&quot;smiles&quot;</span><span class="p">:</span> <span class="n">smiles</span><span class="p">}</span>

<span class="n">example_cas</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;CAS&quot;</span><span class="p">]</span>
<span class="n">by_cas_with_fallback</span><span class="p">(</span><span class="n">example_cas</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;cas&#39;: &#39;2039-06-7&#39;,
 &#39;cid&#39;: 16260,
 &#39;smiles&#39;: &#39;C1=CC=C(C=C1)C2=NC(=NN2)C3=CC=CC=C3&#39;}
</pre></div>
</div>
</div>
</div>
</section>
<section id="enrich-a-small-slice">
<h3>6.2 Enrich a small slice<a class="headerlink" href="#enrich-a-small-slice" title="Permalink to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rows</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">cas</span> <span class="ow">in</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;CAS&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">8</span><span class="p">):</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">rec</span> <span class="o">=</span> <span class="n">by_cas_with_fallback</span><span class="p">(</span><span class="n">cas</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">rec</span><span class="p">[</span><span class="s2">&quot;cid&quot;</span><span class="p">]:</span>
            <span class="n">more</span> <span class="o">=</span> <span class="n">pubchem_properties</span><span class="p">(</span><span class="n">rec</span><span class="p">[</span><span class="s2">&quot;cid&quot;</span><span class="p">])</span>
            <span class="n">rec</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">more</span><span class="p">)</span>
        <span class="n">rows</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rec</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
        <span class="n">rows</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s2">&quot;cas&quot;</span><span class="p">:</span> <span class="n">cas</span><span class="p">,</span> <span class="s2">&quot;cid&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span> <span class="s2">&quot;smiles&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">})</span>
<span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">rows</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>cas</th>
      <th>cid</th>
      <th>smiles</th>
      <th>CID</th>
      <th>MolecularWeight</th>
      <th>XLogP</th>
      <th>ExactMass</th>
      <th>TPSA</th>
      <th>HBondDonorCount</th>
      <th>HBondAcceptorCount</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2039-06-7</td>
      <td>16260.0</td>
      <td>C1=CC=C(C=C1)C2=NC(=NN2)C3=CC=CC=C3</td>
      <td>16260.0</td>
      <td>221.26</td>
      <td>3.3</td>
      <td>221.095297364</td>
      <td>41.6</td>
      <td>1.0</td>
      <td>2.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2127-07-3</td>
      <td>417543.0</td>
      <td>C1=CN=CC=C1CCSSCCC2=CC=NC=C2</td>
      <td>417543.0</td>
      <td>276.4</td>
      <td>2.7</td>
      <td>276.07549087</td>
      <td>76.4</td>
      <td>0.0</td>
      <td>4.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2359-09-3</td>
      <td>75379.0</td>
      <td>CC(C)(C)C1=CC(=CC(=C1)C(=O)O)C(=O)O</td>
      <td>75379.0</td>
      <td>222.24</td>
      <td>2.6</td>
      <td>222.08920892</td>
      <td>74.6</td>
      <td>2.0</td>
      <td>4.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2384-02-3</td>
      <td>584077.0</td>
      <td>C1=C(NN=C1)C2=CC=NN2</td>
      <td>584077.0</td>
      <td>134.14</td>
      <td>0.2</td>
      <td>134.059246208</td>
      <td>57.4</td>
      <td>2.0</td>
      <td>2.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2790-09-2</td>
      <td>314208.0</td>
      <td>CC1=CC(=C(C=C1C(=O)O)C(=O)O)C</td>
      <td>314208.0</td>
      <td>194.18</td>
      <td>1.7</td>
      <td>194.05790880</td>
      <td>74.6</td>
      <td>2.0</td>
      <td>4.0</td>
    </tr>
    <tr>
      <th>5</th>
      <td>2997-05-9</td>
      <td>NaN</td>
      <td>None</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>6</th>
      <td>3097-03-8</td>
      <td>12262901.0</td>
      <td>C1=CC2=C(C=C1C3=CC4=C(C=C3)N=CN4)NC=N2</td>
      <td>12262901.0</td>
      <td>234.26</td>
      <td>2.7</td>
      <td>234.090546336</td>
      <td>57.4</td>
      <td>2.0</td>
      <td>2.0</td>
    </tr>
    <tr>
      <th>7</th>
      <td>3711-03-3</td>
      <td>13628397.0</td>
      <td>C1=CC2=C(C3=C1C4=C(C=C3)C(=O)OC4=O)C(=O)OC2=O</td>
      <td>13628397.0</td>
      <td>268.18</td>
      <td>1.9</td>
      <td>268.00078784</td>
      <td>86.7</td>
      <td>0.0</td>
      <td>6.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
</section>
<hr class="docutils" />
<section id="glossary">
<h2><a class="toc-backref" href="#id8" role="doc-backlink">7. Glossary</a><a class="headerlink" href="#glossary" title="Permalink to this heading">#</a></h2>
<dl class="simple glossary">
<dt id="term-PUG-REST">PUG-REST<a class="headerlink" href="#term-PUG-REST" title="Permalink to this term">#</a></dt><dd><p>The PubChem REST interface that returns properties, identifiers and files via URL patterns.</p>
</dd>
<dt id="term-PUG-View">PUG-View<a class="headerlink" href="#term-PUG-View" title="Permalink to this term">#</a></dt><dd><p>A service that returns human-oriented record sections such as safety and vendor data in JSON.</p>
</dd>
<dt id="term-CID">CID<a class="headerlink" href="#term-CID" title="Permalink to this term">#</a></dt><dd><p>PubChem Compound ID for a unique compound record.</p>
</dd>
<dt id="term-SID">SID<a class="headerlink" href="#term-SID" title="Permalink to this term">#</a></dt><dd><p>PubChem Substance ID which refers to a submitted substance record.</p>
</dd>
<dt id="term-AID">AID<a class="headerlink" href="#term-AID" title="Permalink to this term">#</a></dt><dd><p>PubChem Assay ID for a bioassay record.</p>
</dd>
<dt id="term-SMILES">SMILES<a class="headerlink" href="#term-SMILES" title="Permalink to this term">#</a></dt><dd><p>Text line notation for molecules. Canonical SMILES omits stereochemistry. Isomeric SMILES includes it.</p>
</dd>
<dt id="term-InChI-and-InChIKey">InChI and InChIKey<a class="headerlink" href="#term-InChI-and-InChIKey" title="Permalink to this term">#</a></dt><dd><p>IUPAC identifiers. InChIKey is a hashed, fixed-length form that is easy to compare.</p>
</dd>
<dt id="term-GHS">GHS<a class="headerlink" href="#term-GHS" title="Permalink to this term">#</a></dt><dd><p>Globally Harmonized System of Classification and Labelling of Chemicals. PubChem PUG-View can include these sections.</p>
</dd>
<dt id="term-CIR">CIR<a class="headerlink" href="#term-CIR" title="Permalink to this term">#</a></dt><dd><p>NCI Chemical Identifier Resolver. A second service that converts between names, SMILES, InChI, InChIKey and more.</p>
</dd>
<dt id="term-sanitize">sanitize<a class="headerlink" href="#term-sanitize" title="Permalink to this term">#</a></dt><dd><p>RDKit process that checks valence, aromaticity and stereochemistry.</p>
</dd>
<dt id="term-descriptor">descriptor<a class="headerlink" href="#term-descriptor" title="Permalink to this term">#</a></dt><dd><p>Computed molecular property such as molecular weight or LogP.</p>
</dd>
</dl>
</section>
<hr class="docutils" />
<section id="quick-reference">
<h2><a class="toc-backref" href="#id9" role="doc-backlink">8. Quick reference</a><a class="headerlink" href="#quick-reference" title="Permalink to this heading">#</a></h2>
<div class="admonition-pubchem-endpoints-to-remember admonition">
<p class="admonition-title">PubChem endpoints to remember</p>
<ul class="simple">
<li><p>Name to CID: <code class="docutils literal notranslate"><span class="pre">/compound/name/&lt;name&gt;/cids/JSON</span></code></p></li>
<li><p>CID to properties: <code class="docutils literal notranslate"><span class="pre">/compound/cid/&lt;cid&gt;/property/&lt;fields&gt;/JSON</span></code></p></li>
<li><p>CID to PNG depiction: <code class="docutils literal notranslate"><span class="pre">/compound/cid/&lt;cid&gt;/PNG?image_size=300x300</span></code></p></li>
<li><p>Synonyms: <code class="docutils literal notranslate"><span class="pre">/compound/cid/&lt;cid&gt;/synonyms/JSON</span></code></p></li>
<li><p>PUG-View record: <code class="docutils literal notranslate"><span class="pre">/rest/pug_view/data/compound/&lt;cid&gt;/JSON</span></code></p></li>
</ul>
</div>
<div class="admonition-cir-endpoints-to-remember admonition">
<p class="admonition-title">CIR endpoints to remember</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">/&lt;input&gt;/smiles</span></code>, <code class="docutils literal notranslate"><span class="pre">/&lt;input&gt;/stdinchi</span></code>, <code class="docutils literal notranslate"><span class="pre">/&lt;input&gt;/stdinchikey</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">/&lt;input&gt;/names</span></code> and <code class="docutils literal notranslate"><span class="pre">/&lt;input&gt;/cas</span></code> for synonyms and CAS when available</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">/&lt;input&gt;/image</span></code> to get a 2D depiction</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">/&lt;input&gt;/mw</span></code> to get molecular weight</p></li>
</ul>
</div>
</section>
<hr class="docutils" />
<section id="in-class-activity">
<h2><a class="toc-backref" href="#id10" role="doc-backlink">9. In-class activity</a><a class="headerlink" href="#in-class-activity" title="Permalink to this heading">#</a></h2>
<p>Each task is aligned with what we covered above. Work in pairs. Fill in the <code class="docutils literal notranslate"><span class="pre">...</span></code> lines. Solutions are in Section 13.</p>
<section id="verify-pubchem-vs-cir-agreement">
<h3>9.1 Verify PubChem vs CIR agreement<a class="headerlink" href="#verify-pubchem-vs-cir-agreement" title="Permalink to this heading">#</a></h3>
<p>Given <code class="docutils literal notranslate"><span class="pre">targets</span> <span class="pre">=</span> <span class="pre">[&quot;caffeine&quot;,</span> <span class="pre">&quot;ibuprofen&quot;,</span> <span class="pre">&quot;acetaminophen&quot;]</span></code></p>
<ul class="simple">
<li><p>Get InChIKey from PubChem and from CIR.</p></li>
<li><p>Report whether they match.</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">targets</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;caffeine&quot;</span><span class="p">,</span> <span class="s2">&quot;ibuprofen&quot;</span><span class="p">,</span> <span class="s2">&quot;acetaminophen&quot;</span><span class="p">]</span>
<span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">targets</span><span class="p">:</span>
    <span class="n">pc_key</span> <span class="o">=</span> <span class="o">...</span> <span class="c1">#TO DO</span>
    <span class="n">cir_key</span> <span class="o">=</span> <span class="o">...</span> <span class="c1">#TO DO</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">t</span><span class="si">:</span><span class="s2">14s</span><span class="si">}</span><span class="s2"> PubChem=</span><span class="si">{</span><span class="n">pc_key</span><span class="si">}</span><span class="s2">  CIR=</span><span class="si">{</span><span class="n">cir_key</span><span class="si">}</span><span class="s2">  match=</span><span class="si">{</span><span class="n">pc_key</span><span class="o">==</span><span class="n">cir_key</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="small-properties-table-from-names">
<h3>9.2 Small properties table from names<a class="headerlink" href="#small-properties-table-from-names" title="Permalink to this heading">#</a></h3>
<p>Use names <code class="docutils literal notranslate"><span class="pre">[&quot;caffeine&quot;,</span> <span class="pre">&quot;acetaminophen&quot;,</span> <span class="pre">&quot;ibuprofen&quot;]</span></code>. For each, fetch SMILES from PubChem, then compute MolWt, LogP, HBD, HBA, and TPSA.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1">#TO DO</span>
</pre></div>
</div>
</section>
<section id="get-a-quick-ghs-note-from-pug-view">
<h3>9.3 Get a quick GHS note from PUG-View<a class="headerlink" href="#get-a-quick-ghs-note-from-pug-view" title="Permalink to this heading">#</a></h3>
<ul class="simple">
<li><p>For CID 2244 retrieve GHS section text.</p></li>
<li><p>Print the first 8 lines.</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1">#TO DO</span>
</pre></div>
</div>
</section>
<section id="build-a-one-liner-resolver">
<h3>9.4 Build a one-liner resolver<a class="headerlink" href="#build-a-one-liner-resolver" title="Permalink to this heading">#</a></h3>
<ul class="simple">
<li><p>Input list <code class="docutils literal notranslate"><span class="pre">[&quot;446157&quot;,</span> <span class="pre">&quot;2244&quot;,</span> <span class="pre">&quot;CCO&quot;,</span> <span class="pre">&quot;482752&quot;,</span> <span class="pre">&quot;c1ccccc1&quot;]</span></code></p></li>
<li><p>If it is digits treat as CID else try SMILES else treat as name.</p></li>
<li><p>Print <code class="docutils literal notranslate"><span class="pre">input=#</span> <span class="pre">CID=#</span> <span class="pre">SMILES=...</span></code> and draw if RDKit is available.</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">items</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;446157&quot;</span><span class="p">,</span> <span class="s2">&quot;2244&quot;</span><span class="p">,</span> <span class="s2">&quot;CCO&quot;</span><span class="p">,</span> <span class="s2">&quot;482752&quot;</span><span class="p">,</span> <span class="s2">&quot;c1ccccc1&quot;</span><span class="p">]</span>

<span class="k">for</span> <span class="n">q</span> <span class="ow">in</span> <span class="n">items</span><span class="p">:</span>
    <span class="k">if</span> <span class="o">...</span>
    <span class="o">...</span><span class="c1">#TO DO</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;input=</span><span class="si">{</span><span class="o">...</span><span class="si">}</span><span class="s2"> CID=</span><span class="si">{</span><span class="o">...</span><span class="si">}</span><span class="s2"> SMILES=</span><span class="si">{</span><span class="o">...</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="process-dataset">
<h3>9.5 Process dataset<a class="headerlink" href="#process-dataset" title="Permalink to this heading">#</a></h3>
<p>Load dataset “<a class="reference external" href="https://raw.githubusercontent.com/zzhenglab/ai4chem/main/book/_data/C_H_oxidation_dataset.csv">https://raw.githubusercontent.com/zzhenglab/ai4chem/main/book/_data/C_H_oxidation_dataset.csv</a>”.</p>
<p>Examine the dataset structure using <code class="docutils literal notranslate"><span class="pre">df.head()</span></code> and select the SMILES strings from first 5 rows to query CIR (see section 4) to get <strong>number of freely rotatable bonds</strong>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1">#TO DO</span>
</pre></div>
</div>
<div class="admonition hint">
<p class="admonition-title">Hint</p>
<p><a class="reference external" href="https://cactus.nci.nih.gov/chemical/structure/your_input/rotor_count">https://cactus.nci.nih.gov/chemical/structure/your_input/rotor_count</a></p>
</div>
</section>
</section>
<hr class="docutils" />
<section id="solutions">
<h2><a class="toc-backref" href="#id11" role="doc-backlink">10. Solutions</a><a class="headerlink" href="#solutions" title="Permalink to this heading">#</a></h2>
<section id="solution-9-1">
<h3>Solution 9.1<a class="headerlink" href="#solution-9-1" title="Permalink to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">targets</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;caffeine&quot;</span><span class="p">,</span> <span class="s2">&quot;ibuprofen&quot;</span><span class="p">,</span> <span class="s2">&quot;acetaminophen&quot;</span><span class="p">]</span>
<span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">targets</span><span class="p">:</span>
    <span class="n">pc_key</span> <span class="o">=</span> <span class="n">pubchem_by_name</span><span class="p">(</span><span class="n">t</span><span class="p">)[</span><span class="s2">&quot;inchikey&quot;</span><span class="p">]</span>
    <span class="n">cir_key</span> <span class="o">=</span> <span class="n">cir_get</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="s2">&quot;stdinchikey&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">t</span><span class="si">:</span><span class="s2">14s</span><span class="si">}</span><span class="s2"> PubChem=</span><span class="si">{</span><span class="n">pc_key</span><span class="si">}</span><span class="s2">  CIR=</span><span class="si">{</span><span class="n">cir_key</span><span class="si">}</span><span class="s2">  match=</span><span class="si">{</span><span class="n">pc_key</span><span class="o">==</span><span class="n">cir_key</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>caffeine       PubChem=RYYVLZVUVIJVGH-UHFFFAOYSA-N  CIR=InChIKey=RYYVLZVUVIJVGH-UHFFFAOYSA-N  match=False
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>ibuprofen      PubChem=HEFNNWSXXWATRW-UHFFFAOYSA-N  CIR=InChIKey=HEFNNWSXXWATRW-UHFFFAOYSA-N  match=False
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>acetaminophen  PubChem=RZVAJINKPMORJF-UHFFFAOYSA-N  CIR=InChIKey=RZVAJINKPMORJF-UHFFFAOYSA-N  match=False
</pre></div>
</div>
</div>
</div>
</section>
<section id="solution-9-2">
<h3>Solution 9.2<a class="headerlink" href="#solution-9-2" title="Permalink to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="n">Chem</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
    <span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
    <span class="n">rows</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">names</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;caffeine&quot;</span><span class="p">,</span> <span class="s2">&quot;acetaminophen&quot;</span><span class="p">,</span> <span class="s2">&quot;ibuprofen&quot;</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">nm</span> <span class="ow">in</span> <span class="n">names</span><span class="p">:</span>
        <span class="n">info</span> <span class="o">=</span> <span class="n">pubchem_by_name</span><span class="p">(</span><span class="n">nm</span><span class="p">)</span>
        <span class="n">smi</span> <span class="o">=</span> <span class="n">info</span><span class="p">[</span><span class="s2">&quot;smiles&quot;</span><span class="p">]</span>
        <span class="n">m</span> <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">MolFromSmiles</span><span class="p">(</span><span class="n">smi</span><span class="p">)</span>
        <span class="n">rows</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
            <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="n">nm</span><span class="p">,</span>
            <span class="s2">&quot;smiles&quot;</span><span class="p">:</span> <span class="n">smi</span><span class="p">,</span>
            <span class="s2">&quot;MolWt&quot;</span><span class="p">:</span> <span class="n">Descriptors</span><span class="o">.</span><span class="n">MolWt</span><span class="p">(</span><span class="n">m</span><span class="p">),</span>
            <span class="s2">&quot;LogP&quot;</span><span class="p">:</span> <span class="n">Crippen</span><span class="o">.</span><span class="n">MolLogP</span><span class="p">(</span><span class="n">m</span><span class="p">),</span>
            <span class="s2">&quot;HBD&quot;</span><span class="p">:</span> <span class="n">rdMolDescriptors</span><span class="o">.</span><span class="n">CalcNumHBD</span><span class="p">(</span><span class="n">m</span><span class="p">),</span>
            <span class="s2">&quot;HBA&quot;</span><span class="p">:</span> <span class="n">rdMolDescriptors</span><span class="o">.</span><span class="n">CalcNumHBA</span><span class="p">(</span><span class="n">m</span><span class="p">),</span>
            <span class="s2">&quot;TPSA&quot;</span><span class="p">:</span> <span class="n">rdMolDescriptors</span><span class="o">.</span><span class="n">CalcTPSA</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
        <span class="p">})</span>
    <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">rows</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;RDKit is not available here.&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="solution-9-3">
<h3>Solution 9.3<a class="headerlink" href="#solution-9-3" title="Permalink to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">hits</span> <span class="o">=</span> <span class="n">pug_view_find_sections</span><span class="p">(</span><span class="mi">2244</span><span class="p">,</span> <span class="s2">&quot;GHS&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">pug_view_text_from_hit</span><span class="p">(</span><span class="n">hits</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">max_lines</span><span class="o">=</span><span class="mi">8</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>This chemical does not meet GHS hazard criteria for 0.3% (1  of 315) of reports.
Warning
H302 (95.6%): Harmful if swallowed [Warning Acute toxicity, oral]
H315 (20.6%): Causes skin irritation [Warning Skin corrosion/irritation]
H319 (22.2%): Causes serious eye irritation [Warning Serious eye damage/eye irritation]
H335 (20%): May cause respiratory irritation [Warning Specific target organ toxicity, single exposure; Respiratory tract irritation]
P261, P264, P264+P265, P270, P271, P280, P301+P317, P302+P352, P304+P340, P305+P351+P338, P319, P321, P330, P332+P317, P337+P317, P362+P364, P403+P233, P405, and P501
Aggregated GHS information provided per 315 reports by companies from 23 notifications to the ECHA C&amp;L Inventory. Each notification may be associated with multiple companies.
</pre></div>
</div>
</div>
</div>
</section>
<section id="solution-9-4">
<h3>Solution 9.4<a class="headerlink" href="#solution-9-4" title="Permalink to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="n">Chem</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
    <span class="n">find</span> <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">MolFromSmiles</span><span class="p">(</span><span class="s2">&quot;Cl&quot;</span><span class="p">)</span>
    <span class="n">put</span>  <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">MolFromSmiles</span><span class="p">(</span><span class="s2">&quot;F&quot;</span><span class="p">)</span>
    <span class="n">mol</span>  <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">MolFromSmiles</span><span class="p">(</span><span class="s2">&quot;Clc1ccc(cc1)C(=O)O&quot;</span><span class="p">)</span>
    <span class="n">out</span>  <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">ReplaceSubstructs</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">find</span><span class="p">,</span> <span class="n">put</span><span class="p">,</span> <span class="n">replaceAll</span><span class="o">=</span><span class="kc">True</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">Chem</span><span class="o">.</span><span class="n">MolToSmiles</span><span class="p">(</span><span class="n">out</span><span class="p">))</span>
    <span class="n">Draw</span><span class="o">.</span><span class="n">MolToImage</span><span class="p">(</span><span class="n">out</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">300</span><span class="p">,</span> <span class="mi">220</span><span class="p">))</span>
<span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;RDKit is not available here.&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>O=C(O)c1ccc(F)cc1
</pre></div>
</div>
</div>
</div>
</section>
<section id="solution-9-5">
<h3>Solution 9.5<a class="headerlink" href="#solution-9-5" title="Permalink to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">items</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;446157&quot;</span><span class="p">,</span> <span class="s2">&quot;2244&quot;</span><span class="p">,</span> <span class="s2">&quot;CCO&quot;</span><span class="p">,</span> <span class="s2">&quot;482752&quot;</span><span class="p">,</span> <span class="s2">&quot;c1ccccc1&quot;</span><span class="p">]</span>

<span class="k">for</span> <span class="n">q</span> <span class="ow">in</span> <span class="n">items</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">q</span><span class="o">.</span><span class="n">isdigit</span><span class="p">():</span>
        <span class="n">info</span> <span class="o">=</span> <span class="n">pubchem_by_cid</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">q</span><span class="p">))</span>
        <span class="n">smi</span><span class="p">,</span> <span class="n">cid</span> <span class="o">=</span> <span class="n">info</span><span class="p">[</span><span class="s2">&quot;smiles&quot;</span><span class="p">],</span> <span class="n">info</span><span class="p">[</span><span class="s2">&quot;cid&quot;</span><span class="p">]</span>
    <span class="k">elif</span> <span class="n">Chem</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">Chem</span><span class="o">.</span><span class="n">MolFromSmiles</span><span class="p">(</span><span class="n">q</span><span class="p">):</span>
        <span class="n">smi</span><span class="p">,</span> <span class="n">cid</span> <span class="o">=</span> <span class="n">q</span><span class="p">,</span> <span class="kc">None</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">info</span> <span class="o">=</span> <span class="n">pubchem_by_name</span><span class="p">(</span><span class="n">q</span><span class="p">)</span>
        <span class="n">smi</span><span class="p">,</span> <span class="n">cid</span> <span class="o">=</span> <span class="n">info</span><span class="p">[</span><span class="s2">&quot;smiles&quot;</span><span class="p">],</span> <span class="n">info</span><span class="p">[</span><span class="s2">&quot;cid&quot;</span><span class="p">]</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;input=</span><span class="si">{</span><span class="n">q</span><span class="si">}</span><span class="s2"> CID=</span><span class="si">{</span><span class="n">cid</span><span class="si">}</span><span class="s2"> SMILES=</span><span class="si">{</span><span class="n">smi</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">Chem</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">m</span> <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">MolFromSmiles</span><span class="p">(</span><span class="n">smi</span><span class="p">)</span>
        <span class="n">display</span><span class="p">(</span><span class="n">Draw</span><span class="o">.</span><span class="n">MolToImage</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">220</span><span class="p">,</span> <span class="mi">180</span><span class="p">)))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>input=446157 CID=446157 SMILES=CC(C)C1=NC(=NC(=C1/C=C/[C@H](C[C@H](CC(=O)O)O)O)C2=CC=C(C=C2)F)N(C)S(=O)(=O)C
</pre></div>
</div>
<img alt="_images/8d746ab668d3748039a1cbf07cc3fda5c05570101c48688003204def735e4f8e.png" src="_images/8d746ab668d3748039a1cbf07cc3fda5c05570101c48688003204def735e4f8e.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>input=2244 CID=2244 SMILES=CC(=O)OC1=CC=CC=C1C(=O)O
</pre></div>
</div>
<img alt="_images/93e42113bba090e0fef9b5680cca8eadc59de873d9c7437da2b86442697166e1.png" src="_images/93e42113bba090e0fef9b5680cca8eadc59de873d9c7437da2b86442697166e1.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>input=CCO CID=None SMILES=CCO
</pre></div>
</div>
<img alt="_images/9b3f0eabf5b152166bb0a06ff08f743140baa334d56350d04e4c0f78cce0ebc6.png" src="_images/9b3f0eabf5b152166bb0a06ff08f743140baa334d56350d04e4c0f78cce0ebc6.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>input=482752 CID=482752 SMILES=CC[N+]1=CC=C(C=C1)C2=C3C=CC(=C(C4=NC(=C(C5=CC=C([NH2+]5)C(=C6C=CC2=N6)C7=CC=[N+](C=C7)CC)C8=CC=[N+](C=C8)CC)C=C4)C9=CC=[N+](C=C9)CC)[NH2+]3.[Cl-]
</pre></div>
</div>
<img alt="_images/159163f427b17b058ab67252b46a8e43d23323b661386ecc8fd0c147657b7743.png" src="_images/159163f427b17b058ab67252b46a8e43d23323b661386ecc8fd0c147657b7743.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>input=c1ccccc1 CID=None SMILES=c1ccccc1
</pre></div>
</div>
<img alt="_images/1aedb7d5bb4a5a01ceaf08106f370cbee896d64e274680a56a5d075539379113.png" src="_images/1aedb7d5bb4a5a01ceaf08106f370cbee896d64e274680a56a5d075539379113.png" />
</div>
</div>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="lecture-03.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Lecture 3 - SMILES and RDKit</p>
      </div>
    </a>
    <a class="right-next"
       href="lecture-05.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Lecture 5 - Regression and Classification</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#learning-goals">Learning goals</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#pubchem-pug-rest-basics">1. PubChem PUG-REST Basics</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#setup">1.1 Setup</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#background-information">1.2 Background Information</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#from-name-to-cid-and-properties">2. From name to CID and properties</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#form-the-url">2.1 Form the URL</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#request-and-parse">2.2 Request and parse</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#iupac-name">2.3 IUPAC name</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#canonical-vs-isomeric-smiles">2.4 Canonical vs isomeric SMILES</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#safer-helpers">2.5 Safer helpers</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#write-convenience-functions-by-name">2.6 Write convenience functions (by name)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#write-convenience-functions-by-cid">2.7 Write convenience functions (by CID)</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#other-pubchem-features">3. Other PubChem features</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#selected-computed-properties">3.1 Selected computed properties</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#synonyms">3.2 Synonyms</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#png-depiction-from-pubchem">3.3 PNG depiction from PubChem</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pug-view-for-safety-snippets">3.4 PUG-View for safety snippets</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#nci-chemical-identifier-resolver-cir-as-a-second-path">4. NCI Chemical Identifier Resolver (CIR) as a second path</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#mini-widget">5. Mini widget</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#case-study-with-cas-from-excel">6. Case study with CAS from Excel</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#query-pubchem-by-cas-with-fallback">6.1 Query PubChem by CAS with fallback</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#enrich-a-small-slice">6.2 Enrich a small slice</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#glossary">7. Glossary</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#quick-reference">8. Quick reference</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#in-class-activity">9. In-class activity</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#verify-pubchem-vs-cir-agreement">9.1 Verify PubChem vs CIR agreement</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#small-properties-table-from-names">9.2 Small properties table from names</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#get-a-quick-ghs-note-from-pug-view">9.3 Get a quick GHS note from PUG-View</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#build-a-one-liner-resolver">9.4 Build a one-liner resolver</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#process-dataset">9.5 Process dataset</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#solutions">10. Solutions</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#solution-9-1">Solution 9.1</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#solution-9-2">Solution 9.2</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#solution-9-3">Solution 9.3</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#solution-9-4">Solution 9.4</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#solution-9-5">Solution 9.5</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By The Jupyter Book Community
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2022.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=5b4479735964841361fd"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=5b4479735964841361fd"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>