
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Lecture 3 - SMILES and RDKit &#8212; My sample book</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.8ecb98da25f57f5357bf6f572d296f466b2cfe2517ffebfabe82451661e28f02.css?v=6644e6bb" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'lecture-03';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
        
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/logo.png" class="logo__image only-light" alt="My sample book - Home"/>
    <script>document.write(`<img src="_static/logo.png" class="logo__image only-dark" alt="My sample book - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    Welcome to CHEM 5080: AI for Chemistry
                </a>
            </li>
        </ul>
        <ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="lecture-01.html">Lecture 1 - Python Primer</a></li>
<li class="toctree-l1"><a class="reference internal" href="lecture-02.html">Lecture 2 - Pandas and Plotting</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book/issues/new?title=Issue%20on%20page%20%2Flecture-03.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/lecture-03.md" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.md</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Lecture 3 - SMILES and RDKit</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#learning-goals">Learning goals</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#smiles">1. SMILES</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#atoms">1.1 Atoms</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#bonds">1.2 Bonds</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#branches">1.3 Branches</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#rings">1.4 Rings</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#aromatic-vs-aliphatic">1.5 Aromatic vs aliphatic</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#charges-and-salts">1.6 Charges and salts</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#simple-stereochemistry">1.7 Simple stereochemistry</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#rdkit-quick-start">2. RDKit quick start</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#small-edits-in-rdkit">3. Small edits in RDKit</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#replace-atom-type-by-matching-a-small-molecule">3.1 Replace atom type by matching a small molecule</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#neutralize-a-carboxylate">3.2 Neutralize a carboxylate</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#add-a-methyl-group-with-a-graph-edit">3.3 Add a methyl group with a graph edit</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#why-use-editablemol-instead-of-just-smiles-edits">3.4 Why use <code class="docutils literal notranslate"><span class="pre">EditableMol</span></code> instead of just SMILES edits?</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#pubchem-and-url">4. PubChem and URL</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#install-and-imports">4.1 Install and imports</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#resolve-a-name-to-a-cid">4.2 Resolve a <strong>name</strong> to a CID</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#get-properties-from-the-cid">4.3 Get properties from the CID</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#get-the-iupac-name">4.3.1 Get the <strong>IUPAC name</strong></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#get-the-canonical-smiles">4.3.2 Get the <strong>Canonical SMILES</strong></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#get-the-isomeric-smiles">4.3.3 Get the <strong>Isomeric SMILES</strong></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#make-it-safe-minimal-error-handling">4.4 Make it safe: minimal error handling</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#function-by-name">4.5 Function: by <strong>name</strong></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#function-by-cid">4.6 Function: by <strong>CID</strong></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#use-with-rdkit-short">4.7 Use with RDKit (short)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#save-and-export">5. Save and export</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#quick-reference">6. Quick reference</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#glossary">7. Glossary</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#in-class-activity">8. In-class activity</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#read-a-smiles-and-inspect">8.1 Read a SMILES and inspect</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#make-a-small-properties-table">8.2 Make a small properties table</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#replace-chlorine-with-fluorine">8.3 Replace chlorine with fluorine</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">8.4 Add a methyl group with a graph edit</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pubchem-lookup-to-smiles-and-drawing">8.5 PubChem lookup to SMILES and drawing</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#solutions">9. Solutions</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#solution-8-1">Solution 8.1</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#solution-8-2">Solution 8.2</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#solution-8-3">Solution 8.3</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#solution-8-4">Solution 8.4</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#solution-8-5">Solution 8.5</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="lecture-3-smiles-and-rdkit">
<h1>Lecture 3 - SMILES and RDKit<a class="headerlink" href="#lecture-3-smiles-and-rdkit" title="Link to this heading">#</a></h1>
<blockquote>
<div><p>Start with the SMILES language, practice tiny steps, then use RDKit to draw, edit, and analyze molecules. Finish with PubChem lookups.</p>
</div></blockquote>
<nav class="contents local" id="contents">
<ul class="simple">
<li><p><a class="reference internal" href="#learning-goals" id="id2">Learning goals</a></p></li>
<li><p><a class="reference internal" href="#smiles" id="id3">1. SMILES</a></p></li>
<li><p><a class="reference internal" href="#rdkit-quick-start" id="id4">2. RDKit quick start</a></p></li>
<li><p><a class="reference internal" href="#small-edits-in-rdkit" id="id5">3. Small edits in RDKit</a></p></li>
<li><p><a class="reference internal" href="#why-use-editablemol-instead-of-just-smiles-edits" id="id6">3.4 Why use <code class="docutils literal notranslate"><span class="pre">EditableMol</span></code> instead of just SMILES edits?</a></p></li>
<li><p><a class="reference internal" href="#pubchem-and-url" id="id7">4. PubChem and URL</a></p></li>
<li><p><a class="reference internal" href="#function-by-name" id="id8">4.5 Function: by <strong>name</strong></a></p></li>
<li><p><a class="reference internal" href="#function-by-cid" id="id9">4.6 Function: by <strong>CID</strong></a></p></li>
<li><p><a class="reference internal" href="#use-with-rdkit-short" id="id10">4.7 Use with RDKit (short)</a></p></li>
<li><p><a class="reference internal" href="#save-and-export" id="id11">5. Save and export</a></p></li>
<li><p><a class="reference internal" href="#quick-reference" id="id12">6. Quick reference</a></p></li>
<li><p><a class="reference internal" href="#glossary" id="id13">7. Glossary</a></p></li>
<li><p><a class="reference internal" href="#in-class-activity" id="id14">8. In-class activity</a></p></li>
<li><p><a class="reference internal" href="#solutions" id="id15">9. Solutions</a></p></li>
</ul>
</nav>
<section id="learning-goals">
<h2><a class="toc-backref" href="#id2" role="doc-backlink">Learning goals</a><a class="headerlink" href="#learning-goals" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>Read SMILES strings with confidence: atoms, bonds, branches, rings, aromaticity, charges, simple stereochemistry.</p></li>
<li><p>Use RDKit to parse SMILES, draw structures, add hydrogens, and compute basic properties.</p></li>
<li><p>Make small edits: replace atoms, neutralize groups, split salts, add a methyl group with a graph edit.</p></li>
<li><p>Query PubChem after you can edit molecules locally, then round-trip to SMILES and files.</p></li>
</ul>
</section>
<hr class="docutils" />
<section id="smiles">
<h2><a class="toc-backref" href="#id3" role="doc-backlink">1. SMILES</a><a class="headerlink" href="#smiles" title="Link to this heading">#</a></h2>
<p><strong>What is SMILES?</strong></p>
<p>SMILES (Simplified Molecular Input Line Entry System) is a compact way to describe a molecule using only a line of text. It turns molecular structures into strings that are easy for both humans and computers to read.</p>
<p>Each atom is represented by its atomic symbol: <code class="docutils literal notranslate"><span class="pre">C</span></code> for carbon, <code class="docutils literal notranslate"><span class="pre">O</span></code> for oxygen, etc.</p>
<p>Bonds are shown with symbols: single bonds are implicit, <code class="docutils literal notranslate"><span class="pre">=</span></code> is a double bond, <code class="docutils literal notranslate"><span class="pre">#</span></code> is a triple bond.</p>
<p>Branches are placed in parentheses: <code class="docutils literal notranslate"><span class="pre">CC(O)C</span></code> means a side group on the middle carbon.</p>
<p>Ring structures use numbers to show where the ring closes: <code class="docutils literal notranslate"><span class="pre">C1CCCCC1</span></code> is cyclohexane.</p>
<p>Charges, isotopes, and stereochemistry can also be encoded.</p>
<p>Because it’s text, SMILES is great for storing, comparing, and searching molecules in code and databases. RDKit can take a SMILES string, reconstruct the molecule, and let you visualize or analyze it.</p>
<p>For more information: <em>J. Chem. Inf. Comput. Sci.</em> 1988, 28 (1), 31–36 <a class="reference external" href="https://pubs.acs.org/doi/10.1021/ci00057a005"><img alt="Read" src="https://img.shields.io/badge/Read-Paper-blue" /></a></p>
<p>Now, let’s get started!</p>
<p>If you use Colab, run the install cell below first.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Install only if needed</span>
<span class="k">try</span><span class="p">:</span>
    <span class="kn">import</span><span class="w"> </span><span class="nn">rdkit</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">rdkit</span><span class="w"> </span><span class="kn">import</span> <span class="n">Chem</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">rdkit.Chem</span><span class="w"> </span><span class="kn">import</span> <span class="n">Draw</span><span class="p">,</span> <span class="n">Descriptors</span><span class="p">,</span> <span class="n">Crippen</span><span class="p">,</span> <span class="n">rdMolDescriptors</span>
<span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
    <span class="o">%</span><span class="k">pip</span> install rdkit
</pre></div>
</div>
</div>
</div>
<section id="atoms">
<h3>1.1 Atoms<a class="headerlink" href="#atoms" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>Organic set without brackets: <code class="docutils literal notranslate"><span class="pre">B</span> <span class="pre">C</span> <span class="pre">N</span> <span class="pre">O</span> <span class="pre">P</span> <span class="pre">S</span> <span class="pre">F</span> <span class="pre">Cl</span> <span class="pre">Br</span> <span class="pre">I</span></code>.</p></li>
<li><p>Hydrogens are usually implicit.</p></li>
<li><p>Charges or unusual valence use brackets.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Plain strings to focus on notation</span>
<span class="n">ethanol</span> <span class="o">=</span> <span class="s2">&quot;CCO&quot;</span>         <span class="c1"># C-C-O</span>
<span class="n">mol_1</span> <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">MolFromSmiles</span><span class="p">(</span><span class="n">ethanol</span><span class="p">)</span>
<span class="n">Draw</span><span class="o">.</span><span class="n">MolToImage</span><span class="p">(</span><span class="n">mol_1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/17cbd820e91dbefd5c82141c3683d00a2c9b3e3c703d7b3c869aa2eb21ac0d4c.png" src="_images/17cbd820e91dbefd5c82141c3683d00a2c9b3e3c703d7b3c869aa2eb21ac0d4c.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">acetic</span> <span class="o">=</span> <span class="s2">&quot;CC(=O)O&quot;</span>      <span class="c1"># C-C with a double bonded O and an OH</span>
<span class="n">benzene</span> <span class="o">=</span> <span class="s2">&quot;c1ccccc1&quot;</span>    <span class="c1"># aromatic ring</span>

<span class="n">mol_2</span> <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">MolFromSmiles</span><span class="p">(</span><span class="n">acetic</span><span class="p">)</span>
<span class="n">mol_3</span> <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">MolFromSmiles</span><span class="p">(</span><span class="n">benzene</span><span class="p">)</span>

<span class="c1"># Draw both molecules side by side</span>
<span class="n">Draw</span><span class="o">.</span><span class="n">MolsToImage</span><span class="p">([</span><span class="n">mol_2</span><span class="p">,</span> <span class="n">mol_3</span><span class="p">],</span> <span class="n">molsPerRow</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">subImgSize</span><span class="o">=</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span><span class="mi">100</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/007f34e868844dd5b8602a913ef87796ce3dc214ff308fac8298a09bac9ff05a.png" src="_images/007f34e868844dd5b8602a913ef87796ce3dc214ff308fac8298a09bac9ff05a.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">charged1</span> <span class="o">=</span> <span class="s2">&quot;[NH4+]&quot;</span>     <span class="c1"># ammonium</span>
<span class="n">charged2</span> <span class="o">=</span> <span class="s2">&quot;C(=O)[O-]&quot;</span>  <span class="c1"># carboxylate</span>
<span class="n">mol_c1</span> <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">MolFromSmiles</span><span class="p">(</span><span class="n">charged1</span><span class="p">)</span>
<span class="n">mol_c2</span> <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">MolFromSmiles</span><span class="p">(</span><span class="n">charged2</span><span class="p">)</span>

<span class="n">Draw</span><span class="o">.</span><span class="n">MolsToImage</span><span class="p">([</span><span class="n">mol_c1</span><span class="p">,</span> <span class="n">mol_c2</span><span class="p">],</span> <span class="n">molsPerRow</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">subImgSize</span><span class="o">=</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span><span class="mi">100</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/121231efd81fcb2e20f68282c051e0281ea4e934f2b937c3d1db99aac58d1ee8.png" src="_images/121231efd81fcb2e20f68282c051e0281ea4e934f2b937c3d1db99aac58d1ee8.png" />
</div>
</div>
</section>
<section id="bonds">
<h3>1.2 Bonds<a class="headerlink" href="#bonds" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>Single is implied.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">=</span></code> is double.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">#</span></code> is triple.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">single</span> <span class="o">=</span> <span class="s2">&quot;CC&quot;</span>
<span class="n">double</span> <span class="o">=</span> <span class="s2">&quot;C=C&quot;</span>
<span class="n">triple</span> <span class="o">=</span> <span class="s2">&quot;C#N&quot;</span>

<span class="n">mols</span> <span class="o">=</span> <span class="p">[</span><span class="n">Chem</span><span class="o">.</span><span class="n">MolFromSmiles</span><span class="p">(</span><span class="n">bond</span><span class="p">)</span> <span class="k">for</span> <span class="n">bond</span> <span class="ow">in</span> <span class="p">[</span><span class="n">single</span><span class="p">,</span> <span class="n">double</span><span class="p">,</span> <span class="n">triple</span><span class="p">]]</span>

<span class="n">Draw</span><span class="o">.</span><span class="n">MolsToImage</span><span class="p">(</span><span class="n">mols</span><span class="p">,</span> <span class="n">molsPerRow</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">subImgSize</span><span class="o">=</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span><span class="mi">100</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/307fe369a26d5bc6a27ccbbc0c50412f380a8c8613db00262c71442d9c6677b1.png" src="_images/307fe369a26d5bc6a27ccbbc0c50412f380a8c8613db00262c71442d9c6677b1.png" />
</div>
</div>
</section>
<section id="branches">
<h3>1.3 Branches<a class="headerlink" href="#branches" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>Parentheses create side branches.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">isopropanol_a</span> <span class="o">=</span> <span class="s2">&quot;CC(O)CC&quot;</span>
<span class="n">isopropanol_b</span> <span class="o">=</span> <span class="s2">&quot;CC(C)OC&quot;</span>    <span class="c1"># same structure, different order</span>
<span class="nb">print</span><span class="p">(</span><span class="n">isopropanol_a</span><span class="p">,</span> <span class="n">isopropanol_b</span><span class="p">)</span>

<span class="n">mol_a</span> <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">MolFromSmiles</span><span class="p">(</span><span class="n">isopropanol_a</span><span class="p">)</span>
<span class="n">mol_b</span> <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">MolFromSmiles</span><span class="p">(</span><span class="n">isopropanol_b</span><span class="p">)</span>

<span class="n">Draw</span><span class="o">.</span><span class="n">MolsToImage</span><span class="p">([</span><span class="n">mol_a</span><span class="p">,</span> <span class="n">mol_b</span><span class="p">],</span> <span class="n">molsPerRow</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">subImgSize</span><span class="o">=</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span><span class="mi">100</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CC(O)CC CC(C)OC
</pre></div>
</div>
<img alt="_images/ccda69934ec24937b6187bf2611d93d74836be8375a1661a3c607c2045a53665.png" src="_images/ccda69934ec24937b6187bf2611d93d74836be8375a1661a3c607c2045a53665.png" />
</div>
</div>
</section>
<section id="rings">
<h3>1.4 Rings<a class="headerlink" href="#rings" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>Numbers open and close rings.</p></li>
<li><p>Same digit appears twice to close that ring.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cyclohexane</span> <span class="o">=</span> <span class="s2">&quot;C1CCCCC1&quot;</span>
<span class="n">benzene</span> <span class="o">=</span> <span class="s2">&quot;c1ccccc1&quot;</span>
<span class="n">naphthalene</span> <span class="o">=</span> <span class="s2">&quot;c1cccc2c1cccc2&quot;</span>

<span class="n">mols</span> <span class="o">=</span> <span class="p">[</span><span class="n">Chem</span><span class="o">.</span><span class="n">MolFromSmiles</span><span class="p">(</span><span class="n">ring</span><span class="p">)</span> <span class="k">for</span> <span class="n">ring</span> <span class="ow">in</span> <span class="p">[</span><span class="n">cyclohexane</span><span class="p">,</span> <span class="n">benzene</span><span class="p">,</span> <span class="n">naphthalene</span><span class="p">]]</span>

<span class="n">Draw</span><span class="o">.</span><span class="n">MolsToImage</span><span class="p">(</span><span class="n">mols</span><span class="p">,</span> <span class="n">molsPerRow</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">subImgSize</span><span class="o">=</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span><span class="mi">100</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/3238285e95424198a096071f2478091ac6fec527be34b9de33d7105356caa585.png" src="_images/3238285e95424198a096071f2478091ac6fec527be34b9de33d7105356caa585.png" />
</div>
</div>
</section>
<section id="aromatic-vs-aliphatic">
<h3>1.5 Aromatic vs aliphatic<a class="headerlink" href="#aromatic-vs-aliphatic" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>Aromatic atoms are lower case.</p></li>
<li><p>Aliphatic are upper case.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mol_aromatic</span> <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">MolFromSmiles</span><span class="p">(</span><span class="s2">&quot;c1ccccc1&quot;</span><span class="p">)</span>
<span class="n">mol_aliphatic</span> <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">MolFromSmiles</span><span class="p">(</span><span class="s2">&quot;C1CCCCC1&quot;</span><span class="p">)</span>

<span class="n">Draw</span><span class="o">.</span><span class="n">MolsToImage</span><span class="p">([</span> <span class="n">mol_aromatic</span><span class="p">,</span> <span class="n">mol_aliphatic</span><span class="p">],</span> <span class="n">molsPerRow</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">subImgSize</span><span class="o">=</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span><span class="mi">100</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/ee57abd57ca4d2baf6045dd24bafad85b6912868d924f6e0f0d5e910a05a5bb6.png" src="_images/ee57abd57ca4d2baf6045dd24bafad85b6912868d924f6e0f0d5e910a05a5bb6.png" />
</div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>What the digits mean:
A number marks a ring connection. The same digit appears twice on the two atoms that are bonded to each other to close that ring.
For fused systems, you can reuse different digits to show where each ring closes.</p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ring1</span> <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">MolFromSmiles</span><span class="p">(</span><span class="s2">&quot;C1CCC2CCCCC2C1&quot;</span><span class="p">)</span>
<span class="n">ring2</span> <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">MolFromSmiles</span><span class="p">(</span><span class="s2">&quot;C1CC(C)C1&quot;</span><span class="p">)</span>
<span class="n">ring3</span> <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">MolFromSmiles</span><span class="p">(</span><span class="s2">&quot;c1ccc(C2CCCCC2)cc1&quot;</span><span class="p">)</span>
<span class="n">ring4</span> <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">MolFromSmiles</span><span class="p">(</span><span class="s2">&quot;c1ccc(-c2ccc3ccccc3c2)cc1&quot;</span><span class="p">)</span>
<span class="n">ring5</span> <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">MolFromSmiles</span><span class="p">(</span><span class="s2">&quot;C1=CC2C=COC2=C1&quot;</span><span class="p">)</span>
<span class="n">ring6</span> <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">MolFromSmiles</span><span class="p">(</span><span class="s2">&quot;CC(C)c1cccc(C2CC2)c1&quot;</span><span class="p">)</span>

<span class="n">Draw</span><span class="o">.</span><span class="n">MolsToImage</span><span class="p">([</span><span class="n">ring1</span><span class="p">,</span><span class="n">ring2</span><span class="p">,</span> <span class="n">ring3</span><span class="p">,</span> <span class="n">ring4</span><span class="p">,</span> <span class="n">ring5</span><span class="p">,</span> <span class="n">ring6</span><span class="p">],</span> <span class="n">ubImgSize</span><span class="o">=</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span><span class="mi">100</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/d1aedf29a9d6efb7f88179168080e12ec44141e8e709865c2a9ed21bddbca68c.png" src="_images/d1aedf29a9d6efb7f88179168080e12ec44141e8e709865c2a9ed21bddbca68c.png" />
</div>
</div>
</section>
<section id="charges-and-salts">
<h3>1.6 Charges and salts<a class="headerlink" href="#charges-and-salts" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>Use <code class="docutils literal notranslate"><span class="pre">.</span></code> to separate parts in a salt.</p></li>
<li><p>Place charge in brackets on the atom.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">salt</span> <span class="o">=</span> <span class="s2">&quot;C[NH+](C)C.[Cl-]&quot;</span>    <span class="c1"># trimethylammonium chloride</span>
<span class="n">Draw</span><span class="o">.</span><span class="n">MolToImage</span><span class="p">(</span><span class="n">Chem</span><span class="o">.</span><span class="n">MolFromSmiles</span><span class="p">(</span><span class="n">salt</span> <span class="p">),</span> <span class="n">molsPerRow</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">subImgSize</span><span class="o">=</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span><span class="mi">100</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/af72544af30e323af17a477967e7be9cd7f73c9d827ccc3b4cec7755245dad47.png" src="_images/af72544af30e323af17a477967e7be9cd7f73c9d827ccc3b4cec7755245dad47.png" />
</div>
</div>
</section>
<section id="simple-stereochemistry">
<h3>1.7 Simple stereochemistry<a class="headerlink" href="#simple-stereochemistry" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>E and Z for alkenes use slashes.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Cl/C=C/Cl</span></code> is E. <code class="docutils literal notranslate"><span class="pre">Cl/C=C\Cl</span></code> is Z.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mol_E</span> <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">MolFromSmiles</span><span class="p">(</span><span class="s2">&quot;Cl/C=C/Cl&quot;</span><span class="p">)</span>
<span class="n">mol_Z</span> <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">MolFromSmiles</span><span class="p">(</span><span class="s2">&quot;Cl/C=C</span><span class="se">\\</span><span class="s2">Cl&quot;</span><span class="p">)</span>

<span class="n">Draw</span><span class="o">.</span><span class="n">MolsToImage</span><span class="p">([</span> <span class="n">mol_E</span><span class="p">,</span> <span class="n">mol_Z</span><span class="p">],</span> <span class="n">molsPerRow</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">subImgSize</span><span class="o">=</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span><span class="mi">100</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/459975233cd8913ab757705808ff8990d77a219c905b650ae01ed8c46c6a10ec.png" src="_images/459975233cd8913ab757705808ff8990d77a219c905b650ae01ed8c46c6a10ec.png" />
</div>
</div>
<div class="admonition-try admonition">
<p class="admonition-title">Try</p>
<p>Search online SMILES for these and print them:</p>
<ul class="simple">
<li><p>isopropyl alcohol</p></li>
<li><p>benzoate anion</p></li>
<li><p>cyclopropane</p></li>
<li><p>pyridine</p></li>
</ul>
</div>
<div class="admonition-try admonition">
<p class="admonition-title">Try</p>
<p>Search online SMILES for these and print them:</p>
<ul class="simple">
<li><p>isopropyl alcohol</p></li>
<li><p>benzoate anion</p></li>
<li><p>cyclopropane</p></li>
<li><p>pyridine</p></li>
</ul>
</div>
</section>
</section>
<hr class="docutils" />
<section id="rdkit-quick-start">
<h2><a class="toc-backref" href="#id4" role="doc-backlink">2. RDKit quick start</a><a class="headerlink" href="#rdkit-quick-start" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">rdkit</span><span class="w"> </span><span class="kn">import</span> <span class="n">Chem</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">rdkit.Chem</span><span class="w"> </span><span class="kn">import</span> <span class="n">Draw</span><span class="p">,</span> <span class="n">Descriptors</span><span class="p">,</span> <span class="n">Crippen</span><span class="p">,</span> <span class="n">rdMolDescriptors</span>

<span class="n">smi</span> <span class="o">=</span> <span class="s2">&quot;CC(=O)OC1=CC=CC=C1C(=O)O&quot;</span>  <span class="c1"># aspirin</span>
<span class="n">mol</span> <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">MolFromSmiles</span><span class="p">(</span><span class="n">smi</span><span class="p">)</span>
<span class="n">Draw</span><span class="o">.</span><span class="n">MolToImage</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">350</span><span class="p">,</span> <span class="mi">250</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/e0b244388fd46aa368caee33600535024aba671cd2d87d9b2991e0d7e9ba37ee.png" src="_images/e0b244388fd46aa368caee33600535024aba671cd2d87d9b2991e0d7e9ba37ee.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Add hydrogens for clarity</span>
<span class="n">mol_H</span> <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">AddHs</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
<span class="n">Draw</span><span class="o">.</span><span class="n">MolToImage</span><span class="p">(</span><span class="n">mol_H</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">350</span><span class="p">,</span> <span class="mi">250</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/94ea06b951da92be7ef3a18488fc9bf4bfaaa6acd9c946d7918c77ee69866d71.png" src="_images/94ea06b951da92be7ef3a18488fc9bf4bfaaa6acd9c946d7918c77ee69866d71.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Quick properties in one place</span>
<span class="n">mw</span> <span class="o">=</span> <span class="n">Descriptors</span><span class="o">.</span><span class="n">MolWt</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
<span class="n">logp</span> <span class="o">=</span> <span class="n">Crippen</span><span class="o">.</span><span class="n">MolLogP</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
<span class="n">hbd</span> <span class="o">=</span> <span class="n">rdMolDescriptors</span><span class="o">.</span><span class="n">CalcNumHBD</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
<span class="n">hba</span> <span class="o">=</span> <span class="n">rdMolDescriptors</span><span class="o">.</span><span class="n">CalcNumHBA</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
<span class="n">tpsa</span> <span class="o">=</span> <span class="n">rdMolDescriptors</span><span class="o">.</span><span class="n">CalcTPSA</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;MolWt&quot;</span><span class="p">,</span> <span class="nb">round</span><span class="p">(</span><span class="n">mw</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="s2">&quot;LogP&quot;</span><span class="p">,</span> <span class="nb">round</span><span class="p">(</span><span class="n">logp</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="s2">&quot;HBD&quot;</span><span class="p">,</span> <span class="n">hbd</span><span class="p">,</span> <span class="s2">&quot;HBA&quot;</span><span class="p">,</span> <span class="n">hba</span><span class="p">,</span> <span class="s2">&quot;TPSA&quot;</span><span class="p">,</span> <span class="nb">round</span><span class="p">(</span><span class="n">tpsa</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>MolWt 180.16 LogP 1.31 HBD 1 HBA 3 TPSA 63.6
</pre></div>
</div>
</div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><strong>MolWt</strong> → The molecular weight (molar mass) of the compound, measured in grams per mole.</p>
<p><strong>LogP</strong> → The logarithm of the partition coefficient (octanol/water); higher values mean more lipophilic (hydrophobic).</p>
<p><strong>HBD</strong> (Hydrogen Bond Donors) → Atoms (often OH or NH groups) that can donate a hydrogen in hydrogen bonding.</p>
<p><strong>HBA</strong> (Hydrogen Bond Acceptors) → Atoms (such as oxygen or nitrogen) that can accept a hydrogen bond.</p>
<p><strong>TPSA</strong> (Topological Polar Surface Area) → A measure of the molecule’s polar area, correlated with solubility and permeability.</p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Show atom numbers to plan edits</span>
<span class="n">img</span> <span class="o">=</span> <span class="n">Draw</span><span class="o">.</span><span class="n">MolToImage</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">350</span><span class="p">,</span> <span class="mi">250</span><span class="p">),</span> <span class="n">includeAtomNumbers</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">img</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/e0b244388fd46aa368caee33600535024aba671cd2d87d9b2991e0d7e9ba37ee.png" src="_images/e0b244388fd46aa368caee33600535024aba671cd2d87d9b2991e0d7e9ba37ee.png" />
</div>
</div>
<div class="admonition-practice admonition">
<p class="admonition-title">Practice</p>
<p>Change <code class="docutils literal notranslate"><span class="pre">smi</span></code> to caffeine or acetaminophen. Compare MolWt and TPSA.</p>
</div>
</section>
<hr class="docutils" />
<section id="small-edits-in-rdkit">
<h2><a class="toc-backref" href="#id5" role="doc-backlink">3. Small edits in RDKit</a><a class="headerlink" href="#small-edits-in-rdkit" title="Link to this heading">#</a></h2>
<p>We will avoid pattern languages here. We will use plain molecules to find and replace common pieces.</p>
<section id="replace-atom-type-by-matching-a-small-molecule">
<h3>3.1 Replace atom type by matching a small molecule<a class="headerlink" href="#replace-atom-type-by-matching-a-small-molecule" title="Link to this heading">#</a></h3>
<p>Replace all chlorine atoms with fluorine in an aryl chloride.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">rdkit</span><span class="w"> </span><span class="kn">import</span> <span class="n">Chem</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">rdkit.Chem</span><span class="w"> </span><span class="kn">import</span> <span class="n">Draw</span>

<span class="n">qry</span> <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">MolFromSmiles</span><span class="p">(</span><span class="s2">&quot;Cl&quot;</span><span class="p">)</span>     <span class="c1"># what to find</span>
<span class="n">rep</span> <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">MolFromSmiles</span><span class="p">(</span><span class="s2">&quot;F&quot;</span><span class="p">)</span>      <span class="c1"># what to place</span>
<span class="n">mol</span> <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">MolFromSmiles</span><span class="p">(</span><span class="s2">&quot;Clc1ccc(cc1)C(=O)O&quot;</span><span class="p">)</span>

<span class="n">out</span> <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">ReplaceSubstructs</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">qry</span><span class="p">,</span> <span class="n">rep</span><span class="p">,</span> <span class="n">replaceAll</span><span class="o">=</span><span class="kc">True</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">Draw</span><span class="o">.</span><span class="n">MolToImage</span><span class="p">(</span><span class="n">out</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">350</span><span class="p">,</span> <span class="mi">250</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/96a64de8ab6de3cba9bdeb085779432c65dde405ede31f9884814f235d701bda.png" src="_images/96a64de8ab6de3cba9bdeb085779432c65dde405ede31f9884814f235d701bda.png" />
</div>
</div>
</section>
<section id="neutralize-a-carboxylate">
<h3>3.2 Neutralize a carboxylate<a class="headerlink" href="#neutralize-a-carboxylate" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mol</span> <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">MolFromSmiles</span><span class="p">(</span><span class="s2">&quot;CC(=O)[O-]&quot;</span><span class="p">)</span>
<span class="n">find</span> <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">MolFromSmiles</span><span class="p">(</span><span class="s2">&quot;[O-]&quot;</span><span class="p">)</span>  <span class="c1"># anionic oxygen as a molecule</span>
<span class="n">put</span>  <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">MolFromSmiles</span><span class="p">(</span><span class="s2">&quot;O&quot;</span><span class="p">)</span>
<span class="n">mol_neutral</span> <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">ReplaceSubstructs</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">find</span><span class="p">,</span> <span class="n">put</span><span class="p">,</span> <span class="n">replaceAll</span><span class="o">=</span><span class="kc">True</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">Draw</span><span class="o">.</span><span class="n">MolToImage</span><span class="p">(</span><span class="n">mol_neutral</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">320</span><span class="p">,</span> <span class="mi">220</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/c830c8f543f1ff01bdf8936713c61d629e106732a4e22bcb14c2d8933beca490.png" src="_images/c830c8f543f1ff01bdf8936713c61d629e106732a4e22bcb14c2d8933beca490.png" />
</div>
</div>
</section>
<section id="add-a-methyl-group-with-a-graph-edit">
<h3>3.3 Add a methyl group with a graph edit<a class="headerlink" href="#add-a-methyl-group-with-a-graph-edit" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mol</span> <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">MolFromSmiles</span><span class="p">(</span><span class="s2">&quot;c1ccccc1&quot;</span><span class="p">)</span>  <span class="c1"># benzene</span>
<span class="n">em</span> <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">EditableMol</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>

<span class="n">idx_C</span> <span class="o">=</span> <span class="n">em</span><span class="o">.</span><span class="n">AddAtom</span><span class="p">(</span><span class="n">Chem</span><span class="o">.</span><span class="n">Atom</span><span class="p">(</span><span class="s2">&quot;C&quot;</span><span class="p">))</span>
<span class="n">idx_H1</span> <span class="o">=</span> <span class="n">em</span><span class="o">.</span><span class="n">AddAtom</span><span class="p">(</span><span class="n">Chem</span><span class="o">.</span><span class="n">Atom</span><span class="p">(</span><span class="s2">&quot;H&quot;</span><span class="p">))</span>
<span class="n">idx_H2</span> <span class="o">=</span> <span class="n">em</span><span class="o">.</span><span class="n">AddAtom</span><span class="p">(</span><span class="n">Chem</span><span class="o">.</span><span class="n">Atom</span><span class="p">(</span><span class="s2">&quot;H&quot;</span><span class="p">))</span>
<span class="n">idx_H3</span> <span class="o">=</span> <span class="n">em</span><span class="o">.</span><span class="n">AddAtom</span><span class="p">(</span><span class="n">Chem</span><span class="o">.</span><span class="n">Atom</span><span class="p">(</span><span class="s2">&quot;H&quot;</span><span class="p">))</span>

<span class="n">em</span><span class="o">.</span><span class="n">AddBond</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">idx_C</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="n">Chem</span><span class="o">.</span><span class="n">BondType</span><span class="o">.</span><span class="n">SINGLE</span><span class="p">)</span>  <span class="c1"># attach at atom index 2</span>
<span class="n">em</span><span class="o">.</span><span class="n">AddBond</span><span class="p">(</span><span class="n">idx_C</span><span class="p">,</span> <span class="n">idx_H1</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="n">Chem</span><span class="o">.</span><span class="n">BondType</span><span class="o">.</span><span class="n">SINGLE</span><span class="p">)</span>
<span class="n">em</span><span class="o">.</span><span class="n">AddBond</span><span class="p">(</span><span class="n">idx_C</span><span class="p">,</span> <span class="n">idx_H2</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="n">Chem</span><span class="o">.</span><span class="n">BondType</span><span class="o">.</span><span class="n">SINGLE</span><span class="p">)</span>
<span class="n">em</span><span class="o">.</span><span class="n">AddBond</span><span class="p">(</span><span class="n">idx_C</span><span class="p">,</span> <span class="n">idx_H3</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="n">Chem</span><span class="o">.</span><span class="n">BondType</span><span class="o">.</span><span class="n">SINGLE</span><span class="p">)</span>

<span class="n">mol2</span> <span class="o">=</span> <span class="n">em</span><span class="o">.</span><span class="n">GetMol</span><span class="p">()</span>
<span class="n">Chem</span><span class="o">.</span><span class="n">SanitizeMol</span><span class="p">(</span><span class="n">mol2</span><span class="p">)</span>
<span class="n">Draw</span><span class="o">.</span><span class="n">MolToImage</span><span class="p">(</span><span class="n">mol2</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">350</span><span class="p">,</span> <span class="mi">250</span><span class="p">),</span> <span class="n">includeAtomNumbers</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/740e404a58d6f2880b124dcd97f5809abd087f30f63ec0cb3b8dfbdd52f45e1f.png" src="_images/740e404a58d6f2880b124dcd97f5809abd087f30f63ec0cb3b8dfbdd52f45e1f.png" />
</div>
</div>
<div class="admonition-tip admonition">
<p class="admonition-title">Tip</p>
<p>After graph edits, call <code class="docutils literal notranslate"><span class="pre">Chem.SanitizeMol</span></code> to check valence and aromaticity.</p>
</div>
</section>
</section>
<hr class="docutils" />
<section id="why-use-editablemol-instead-of-just-smiles-edits">
<h2><a class="toc-backref" href="#id6" role="doc-backlink">3.4 Why use <code class="docutils literal notranslate"><span class="pre">EditableMol</span></code> instead of just SMILES edits?</a><a class="headerlink" href="#why-use-editablemol-instead-of-just-smiles-edits" title="Link to this heading">#</a></h2>
<p>Text edits to SMILES can hit the wrong atom or make an invalid string. <code class="docutils literal notranslate"><span class="pre">EditableMol</span></code> lets you target an atom index, keep valence correct, and apply the same change across many molecules in a repeatable way.</p>
<p>Now consider below example:
<strong>add a methyl group to atom index 2 across 7 inputs</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">smiles_list</span> <span class="o">=</span> <span class="p">[</span>  
    <span class="s2">&quot;c1ccccc1&quot;</span><span class="p">,</span>            <span class="c1"># benzene</span>
    <span class="s2">&quot;Oc1ccccc1&quot;</span><span class="p">,</span>           <span class="c1"># phenol</span>
    <span class="s2">&quot;Nc1ccccc1&quot;</span><span class="p">,</span>           <span class="c1"># aniline</span>
    <span class="s2">&quot;Clc1ccccc1&quot;</span><span class="p">,</span>          <span class="c1"># chlorobenzene</span>
    <span class="s2">&quot;c1ccncc1&quot;</span><span class="p">,</span>            <span class="c1"># pyridine</span>
    <span class="s2">&quot;O=C(O)c1ccccc1&quot;</span><span class="p">,</span>      <span class="c1"># benzoic acid</span>
    <span class="s2">&quot;OCCc1ccccc1&quot;</span><span class="p">,</span>         <span class="c1"># benzyl alcohol</span>
<span class="p">]</span>  
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">add_methyl</span><span class="p">(</span><span class="n">smi</span><span class="p">):</span>  
    <span class="n">mol</span> <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">MolFromSmiles</span><span class="p">(</span><span class="n">smi</span><span class="p">)</span>  <span class="c1"># parse SMILES to molecule</span>
    <span class="k">if</span> <span class="n">mol</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">mol</span><span class="o">.</span><span class="n">GetNumAtoms</span><span class="p">()</span> <span class="o">&lt;</span> <span class="mi">3</span><span class="p">:</span>  <span class="c1"># quick guard for bad/short inputs</span>
        <span class="k">return</span> <span class="kc">None</span>  <span class="c1"># signal failure</span>
    <span class="n">em</span> <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">EditableMol</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>  <span class="c1"># enter editable graph mode</span>
    <span class="n">c_idx</span> <span class="o">=</span> <span class="n">em</span><span class="o">.</span><span class="n">AddAtom</span><span class="p">(</span><span class="n">Chem</span><span class="o">.</span><span class="n">Atom</span><span class="p">(</span><span class="s2">&quot;C&quot;</span><span class="p">))</span>  <span class="c1"># add the methyl carbon</span>
    <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>  <span class="c1"># add three hydrogens</span>
        <span class="n">h</span> <span class="o">=</span> <span class="n">em</span><span class="o">.</span><span class="n">AddAtom</span><span class="p">(</span><span class="n">Chem</span><span class="o">.</span><span class="n">Atom</span><span class="p">(</span><span class="s2">&quot;H&quot;</span><span class="p">))</span>  <span class="c1"># create a hydrogen atom</span>
        <span class="n">em</span><span class="o">.</span><span class="n">AddBond</span><span class="p">(</span><span class="n">c_idx</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">Chem</span><span class="o">.</span><span class="n">BondType</span><span class="o">.</span><span class="n">SINGLE</span><span class="p">)</span>  <span class="c1"># connect H to C</span>
    <span class="n">em</span><span class="o">.</span><span class="n">AddBond</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">c_idx</span><span class="p">,</span> <span class="n">Chem</span><span class="o">.</span><span class="n">BondType</span><span class="o">.</span><span class="n">SINGLE</span><span class="p">)</span>  <span class="c1"># attach methyl C to atom index 2</span>
    <span class="n">newmol</span> <span class="o">=</span> <span class="n">em</span><span class="o">.</span><span class="n">GetMol</span><span class="p">()</span>  <span class="c1"># exit edit mode</span>
    <span class="n">Chem</span><span class="o">.</span><span class="n">SanitizeMol</span><span class="p">(</span><span class="n">newmol</span><span class="p">)</span>  <span class="c1"># check valence/aromaticity</span>
    <span class="k">return</span> <span class="n">newmol</span>  <span class="c1"># return edited molecule</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">smi</span> <span class="ow">in</span> <span class="n">smiles_list</span><span class="p">:</span>  <span class="c1"># iterate over the 7 SMILES</span>
    <span class="n">mol2</span> <span class="o">=</span> <span class="n">add_methyl</span><span class="p">(</span><span class="n">smi</span><span class="p">)</span>  <span class="c1"># attempt the methyl add</span>
    <span class="n">out</span> <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">MolToSmiles</span><span class="p">(</span><span class="n">mol2</span><span class="p">)</span> <span class="k">if</span> <span class="n">mol2</span> <span class="k">else</span> <span class="s2">&quot;failed&quot;</span>  <span class="c1"># convert to output SMILES or flag</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;IN :&quot;</span><span class="p">,</span> <span class="n">smi</span><span class="p">)</span>  <span class="c1"># show input</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;---------------------&quot;</span><span class="p">)</span>  
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;OUT:&quot;</span><span class="p">,</span> <span class="n">out</span><span class="p">)</span>  <span class="c1"># show output</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;---------------------&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>IN : c1ccccc1
---------------------
OUT: [H]C([H])([H])c1ccccc1
---------------------
IN : Oc1ccccc1
---------------------
OUT: [H]C([H])([H])c1ccccc1O
---------------------
IN : Nc1ccccc1
---------------------
OUT: [H]C([H])([H])c1ccccc1N
---------------------
IN : Clc1ccccc1
---------------------
OUT: [H]C([H])([H])c1ccccc1Cl
---------------------
IN : c1ccncc1
---------------------
OUT: [H]C([H])([H])c1ccccn1
---------------------
IN : O=C(O)c1ccccc1
---------------------
OUT: [H]C([H])([H])OC(=O)c1ccccc1
---------------------
IN : OCCc1ccccc1
---------------------
OUT: [H]C([H])([H])C(CO)c1ccccc1
---------------------
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mols_in</span>  <span class="o">=</span> <span class="p">[</span><span class="n">Chem</span><span class="o">.</span><span class="n">MolFromSmiles</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">smiles_list</span><span class="p">]</span>  <span class="c1"># make inputs as mols</span>
<span class="n">mols_out</span> <span class="o">=</span> <span class="p">[</span><span class="n">add_methyl</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">smiles_list</span><span class="p">]</span>  <span class="c1"># make edited outputs</span>

<span class="n">Draw</span><span class="o">.</span><span class="n">MolsToGridImage</span><span class="p">(</span>  <span class="c1"># draw a grid to compare</span>
    <span class="n">mols_in</span> <span class="o">+</span> <span class="n">mols_out</span><span class="p">,</span>  <span class="c1"># originals then edits</span>
    <span class="n">molsPerRow</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>  <span class="c1"># how many per row</span>
    <span class="n">subImgSize</span><span class="o">=</span><span class="p">(</span><span class="mi">200</span><span class="p">,</span><span class="mi">180</span><span class="p">),</span>  <span class="c1"># image size</span>
    <span class="n">legends</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;in&quot;</span><span class="p">]</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">mols_in</span><span class="p">)</span><span class="o">+</span><span class="p">[</span><span class="s2">&quot;out&quot;</span><span class="p">]</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">mols_out</span><span class="p">),</span>  <span class="c1"># labels</span>
    <span class="n">useSVG</span><span class="o">=</span><span class="kc">True</span>  <span class="c1"># SVG for crisp display</span>
<span class="p">)</span>  <span class="c1"># end drawing</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/53996e732bd6a8177b95fa825d8342d221f338aebbeec9371b41a632a6b6064b.svg" src="_images/53996e732bd6a8177b95fa825d8342d221f338aebbeec9371b41a632a6b6064b.svg" />
</div>
</div>
</section>
<hr class="docutils" />
<section id="pubchem-and-url">
<h2><a class="toc-backref" href="#id7" role="doc-backlink">4. PubChem and URL</a><a class="headerlink" href="#pubchem-and-url" title="Link to this heading">#</a></h2>
<div class="highlight-note notranslate"><div class="highlight"><pre><span></span>Goal: given a common name or a PubChem CID, get a SMILES string you can feed into RDKit.
</pre></div>
</div>
<section id="install-and-imports">
<h3>4.1 Install and imports<a class="headerlink" href="#install-and-imports" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Install requests if you do not have it</span>
<span class="k">try</span><span class="p">:</span>
    <span class="kn">import</span><span class="w"> </span><span class="nn">requests</span>
<span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
    <span class="o">%</span><span class="k">pip</span> -q install requests
    <span class="kn">import</span><span class="w"> </span><span class="nn">requests</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">urllib.parse</span><span class="w"> </span><span class="kn">import</span> <span class="n">quote_plus</span>  
</pre></div>
</div>
</div>
</div>
<p>Instead of going to <a class="reference external" href="https://pubchem.ncbi.nlm.nih.gov">PubChem’s main site</a> and manually searching for a compound, we can also use a <strong>direct URL</strong> to query PubChem’s REST API. This allows us to send structured requests and retrieve data in machine-readable formats such as JSON, XML, or plain text.</p>
<p>The figure below illustrates the general workflow of PUG-REST: provide an input (like a compound name), choose an operation (for example, retrieving a CID), and specify the output format. Using URLs in this way not only automates lookups but also integrates PubChem data smoothly into code and analysis.</p>
<p><img alt="PubChem PUG-REST Figure" src="https://iupac.github.io/WFChemCookbook/_images/pubchem_pugrest_fig1.jpg" /></p>
<p>Here are some example URLs you can click and explore directly in a browser:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://pubchem.ncbi.nlm.nih.gov/rest/pug/compound/name/aspirin/cids/JSON">https://pubchem.ncbi.nlm.nih.gov/rest/pug/compound/name/aspirin/cids/JSON</a>: Returns the PubChem Compound ID (CID) for aspirin.</p></li>
<li><p><a class="reference external" href="https://pubchem.ncbi.nlm.nih.gov/rest/pug/compound/cid/2244/property/IUPACName/JSON">https://pubchem.ncbi.nlm.nih.gov/rest/pug/compound/cid/2244/property/IUPACName/JSON</a>: Returns the standardized IUPAC name.</p></li>
<li><p><a class="reference external" href="https://pubchem.ncbi.nlm.nih.gov/rest/pug/compound/cid/2244/property/CanonicalSMILES/JSON">https://pubchem.ncbi.nlm.nih.gov/rest/pug/compound/cid/2244/property/CanonicalSMILES/JSON</a>: Returns the canonical SMILES string representation.</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The key idea is that PubChem is not only a website but also a programmatic data service. A well-formed URL acts like a query to their database.</p>
</div>
<p>If you are interested in learning more about PubChem URL, please read:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://iupac.github.io/WFChemCookbook/datasources/pubchem_pugrest1.html">IUPAC FAIR Chemistry Cookbook guide</a></p></li>
</ul>
</section>
<hr class="docutils" />
<section id="resolve-a-name-to-a-cid">
<h3>4.2 Resolve a <strong>name</strong> to a CID<a class="headerlink" href="#resolve-a-name-to-a-cid" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">requests</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">urllib.parse</span><span class="w"> </span><span class="kn">import</span> <span class="n">quote_plus</span>

<span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;acetaminophen&quot;</span>

<span class="c1"># Step 1: resolve the name to one or more PubChem CIDs</span>
<span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;https://pubchem.ncbi.nlm.nih.gov/rest/pug/compound/name/</span><span class="si">{</span><span class="n">quote_plus</span><span class="p">(</span><span class="n">name</span><span class="p">)</span><span class="si">}</span><span class="s2">/cids/JSON&quot;</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;URL:&quot;</span><span class="p">,</span> <span class="n">url</span><span class="p">)</span>  <span class="c1"># helps debug if you get HTTP 400</span>

<span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span>
<span class="n">r</span><span class="o">.</span><span class="n">raise_for_status</span><span class="p">()</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">r</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>

<span class="n">cid_list</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;IdentifierList&quot;</span><span class="p">,</span> <span class="p">{})</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;CID&quot;</span><span class="p">,</span> <span class="p">[])</span>
<span class="k">if</span> <span class="ow">not</span> <span class="n">cid_list</span><span class="p">:</span>
    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;No CID found for </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="n">cid</span> <span class="o">=</span> <span class="n">cid_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>  <span class="c1"># take the first hit</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;CID:&quot;</span><span class="p">,</span> <span class="n">cid</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>URL: https://pubchem.ncbi.nlm.nih.gov/rest/pug/compound/name/acetaminophen/cids/JSON
CID: 1983
</pre></div>
</div>
</div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>CID is PubChem’s numeric identifier for a molecule. Taking the first hit is simple and works well for common drugs.
Try to copy and paste the output URL from above copy to your browser and hit enter to see what it looks like!</p>
</div>
<p>Essentially, we first get the JSON format from the URL</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">r</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>
<span class="n">data</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;IdentifierList&#39;: {&#39;CID&#39;: [1983]}}
</pre></div>
</div>
</div>
</div>
<p>Then we use <code class="docutils literal notranslate"><span class="pre">data.get()</span></code> to search for <code class="docutils literal notranslate"><span class="pre">&quot;IdentifierList&quot;</span></code></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;IdentifierList&quot;</span><span class="p">,</span> <span class="p">{}))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;CID&#39;: [1983]}
</pre></div>
</div>
</div>
</div>
</section>
<hr class="docutils" />
<section id="get-properties-from-the-cid">
<h3>4.3 Get properties from the CID<a class="headerlink" href="#get-properties-from-the-cid" title="Link to this heading">#</a></h3>
<section id="get-the-iupac-name">
<h4>4.3.1 Get the <strong>IUPAC name</strong><a class="headerlink" href="#get-the-iupac-name" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fields</span> <span class="o">=</span> <span class="s2">&quot;IUPACName&quot;</span>
<span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;https://pubchem.ncbi.nlm.nih.gov/rest/pug/compound/cid/</span><span class="si">{</span><span class="n">cid</span><span class="si">}</span><span class="s2">/property/</span><span class="si">{</span><span class="n">fields</span><span class="si">}</span><span class="s2">/JSON&quot;</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;URL:&quot;</span><span class="p">,</span> <span class="n">url</span><span class="p">)</span>

<span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span>
<span class="n">r</span><span class="o">.</span><span class="n">raise_for_status</span><span class="p">()</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">r</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>

<span class="n">props</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;PropertyTable&quot;</span><span class="p">][</span><span class="s2">&quot;Properties&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;IUPAC:&quot;</span><span class="p">,</span> <span class="n">props</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;IUPACName&quot;</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>URL: https://pubchem.ncbi.nlm.nih.gov/rest/pug/compound/cid/1983/property/IUPACName/JSON
IUPAC: N-(4-hydroxyphenyl)acetamide
</pre></div>
</div>
</div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The IUPAC name is the standardized systematic name for the compound, defined by the International Union of Pure and Applied Chemistry.</p>
</div>
<p>Let’s break it down again:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;PropertyTable&quot;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;Properties&#39;: [{&#39;CID&#39;: 1983, &#39;IUPACName&#39;: &#39;N-(4-hydroxyphenyl)acetamide&#39;}]}
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;PropertyTable&quot;</span><span class="p">][</span><span class="s2">&quot;Properties&quot;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[{&#39;CID&#39;: 1983, &#39;IUPACName&#39;: &#39;N-(4-hydroxyphenyl)acetamide&#39;}]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;PropertyTable&quot;</span><span class="p">][</span><span class="s2">&quot;Properties&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;CID&#39;: 1983, &#39;IUPACName&#39;: &#39;N-(4-hydroxyphenyl)acetamide&#39;}
</pre></div>
</div>
</div>
</div>
</section>
<hr class="docutils" />
<section id="get-the-canonical-smiles">
<h4>4.3.2 Get the <strong>Canonical SMILES</strong><a class="headerlink" href="#get-the-canonical-smiles" title="Link to this heading">#</a></h4>
<p>Now, we can even condense everything within one line:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Canonical SMILES:&quot;</span><span class="p">,</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;https://pubchem.ncbi.nlm.nih.gov/rest/pug/compound/cid/</span><span class="si">{</span><span class="n">cid</span><span class="si">}</span><span class="s2">/property/CanonicalSMILES/TXT&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Canonical SMILES: CC(=O)NC1=CC=C(C=C1)O
</pre></div>
</div>
</div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Canonical SMILES is a normalized form of the molecule’s SMILES string.<br />
It provides a unique representation but does not retain stereochemistry.</p>
</div>
</section>
<hr class="docutils" />
<section id="get-the-isomeric-smiles">
<h4>4.3.3 Get the <strong>Isomeric SMILES</strong><a class="headerlink" href="#get-the-isomeric-smiles" title="Link to this heading">#</a></h4>
<p>Similar:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Isomeric SMILES:&quot;</span><span class="p">,</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;https://pubchem.ncbi.nlm.nih.gov/rest/pug/compound/cid/</span><span class="si">{</span><span class="n">cid</span><span class="si">}</span><span class="s2">/property/IsomericSMILES/TXT&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Isomeric SMILES: CC(=O)NC1=CC=C(C=C1)O
</pre></div>
</div>
</div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Isomeric SMILES includes stereochemistry and isotopic information if PubChem has it.<br />
This is useful for distinguishing molecules that have the same atoms but different spatial arrangements.</p>
</div>
</section>
</section>
<hr class="docutils" />
<section id="make-it-safe-minimal-error-handling">
<h3>4.4 Make it safe: minimal error handling<a class="headerlink" href="#make-it-safe-minimal-error-handling" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">requests</span>  <span class="c1"># HTTP client</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">urllib.parse</span><span class="w"> </span><span class="kn">import</span> <span class="n">quote_plus</span>  <span class="c1"># safe URL encoding</span>

<span class="k">def</span><span class="w"> </span><span class="nf">safe_get_json</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">30</span><span class="p">):</span>  <span class="c1"># fetch JSON safely</span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="n">timeout</span><span class="p">)</span>  <span class="c1"># send request</span>
    <span class="n">r</span><span class="o">.</span><span class="n">raise_for_status</span><span class="p">()</span>  <span class="c1"># raise if HTTP error</span>
    <span class="k">return</span> <span class="n">r</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>  <span class="c1"># parse and return JSON</span>

<span class="k">def</span><span class="w"> </span><span class="nf">safe_get_text</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">30</span><span class="p">):</span>  <span class="c1"># fetch plain text safely</span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="n">timeout</span><span class="p">)</span>  <span class="c1"># send request</span>
    <span class="n">r</span><span class="o">.</span><span class="n">raise_for_status</span><span class="p">()</span>  <span class="c1"># raise if HTTP error</span>
    <span class="k">return</span> <span class="n">r</span><span class="o">.</span><span class="n">text</span>  <span class="c1"># return raw text</span>
</pre></div>
</div>
</div>
</div>
<div class="highlight-note notranslate"><div class="highlight"><pre><span></span>If you see HTTP 400, print the URL and check if the name was encoded.  
Timeouts keep notebooks from hanging.
</pre></div>
</div>
</section>
</section>
<hr class="docutils" />
<section id="function-by-name">
<h2><a class="toc-backref" href="#id8" role="doc-backlink">4.5 Function: by <strong>name</strong></a><a class="headerlink" href="#function-by-name" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">pubchem_smiles_by_name</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">isomeric</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>  <span class="c1"># look up by common name</span>
    <span class="n">nm</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">name</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>  <span class="c1"># clean input</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">nm</span><span class="p">:</span>  <span class="c1"># empty string check</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Empty name&quot;</span><span class="p">)</span>  <span class="c1"># clear message</span>
    <span class="n">enc</span> <span class="o">=</span> <span class="n">quote_plus</span><span class="p">(</span><span class="n">nm</span><span class="p">)</span>  <span class="c1"># URL encode the name</span>
    <span class="n">kind</span> <span class="o">=</span> <span class="s2">&quot;IsomericSMILES&quot;</span> <span class="k">if</span> <span class="n">isomeric</span> <span class="k">else</span> <span class="s2">&quot;CanonicalSMILES&quot;</span>  <span class="c1"># choose field</span>
    <span class="c1"># get SMILES as plain text</span>
    <span class="n">smi_url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;https://pubchem.ncbi.nlm.nih.gov/rest/pug/compound/name/</span><span class="si">{</span><span class="n">enc</span><span class="si">}</span><span class="s2">/property/</span><span class="si">{</span><span class="n">kind</span><span class="si">}</span><span class="s2">/TXT&quot;</span>  <span class="c1"># TXT endpoint</span>
    <span class="n">smiles</span> <span class="o">=</span> <span class="n">safe_get_text</span><span class="p">(</span><span class="n">smi_url</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>  <span class="c1"># fetch and strip whitespace</span>
    <span class="c1"># get CID via JSON</span>
    <span class="n">cid_url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;https://pubchem.ncbi.nlm.nih.gov/rest/pug/compound/name/</span><span class="si">{</span><span class="n">enc</span><span class="si">}</span><span class="s2">/cids/JSON&quot;</span>  <span class="c1"># CID list</span>
    <span class="n">cid_list</span> <span class="o">=</span> <span class="n">safe_get_json</span><span class="p">(</span><span class="n">cid_url</span><span class="p">)</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;IdentifierList&quot;</span><span class="p">,</span> <span class="p">{})</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;CID&quot;</span><span class="p">,</span> <span class="p">[])</span>  <span class="c1"># pick from JSON</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">cid_list</span><span class="p">:</span>  <span class="c1"># handle no hits</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;No CID found for name: </span><span class="si">{</span><span class="n">nm</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>  <span class="c1"># message</span>
    <span class="n">cid</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">cid_list</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>  <span class="c1"># first hit</span>
    <span class="c1"># get IUPAC name as text</span>
    <span class="n">iupac_url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;https://pubchem.ncbi.nlm.nih.gov/rest/pug/compound/cid/</span><span class="si">{</span><span class="n">cid</span><span class="si">}</span><span class="s2">/property/IUPACName/TXT&quot;</span>  <span class="c1"># TXT endpoint</span>
    <span class="n">iupac</span> <span class="o">=</span> <span class="n">safe_get_text</span><span class="p">(</span><span class="n">iupac_url</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>  <span class="c1"># fetch IUPAC</span>
    <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="n">nm</span><span class="p">,</span> <span class="s2">&quot;cid&quot;</span><span class="p">:</span> <span class="n">cid</span><span class="p">,</span> <span class="s2">&quot;smiles&quot;</span><span class="p">:</span> <span class="n">smiles</span><span class="p">,</span> <span class="s2">&quot;iupac&quot;</span><span class="p">:</span> <span class="n">iupac</span><span class="p">}</span>  <span class="c1"># result dict</span>
</pre></div>
</div>
</div>
</div>
<p><strong>Example</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pubchem_smiles_by_name</span><span class="p">(</span><span class="s2">&quot;ibuprofen&quot;</span><span class="p">)</span>  <span class="c1"># quick demo</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;name&#39;: &#39;ibuprofen&#39;,
 &#39;cid&#39;: 3672,
 &#39;smiles&#39;: &#39;CC(C)CC1=CC=C(C=C1)C(C)C(=O)O&#39;,
 &#39;iupac&#39;: &#39;2-[4-(2-methylpropyl)phenyl]propanoic acid&#39;}
</pre></div>
</div>
</div>
</div>
</section>
<hr class="docutils" />
<section id="function-by-cid">
<h2><a class="toc-backref" href="#id9" role="doc-backlink">4.6 Function: by <strong>CID</strong></a><a class="headerlink" href="#function-by-cid" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">pubchem_smiles_by_cid</span><span class="p">(</span><span class="n">cid</span><span class="p">,</span> <span class="n">isomeric</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>  <span class="c1"># look up by CID</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">cid_int</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">cid</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span>  <span class="c1"># coerce to int</span>
    <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Bad CID: </span><span class="si">{</span><span class="n">cid</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>  <span class="c1"># clear message</span>
    <span class="n">kind</span> <span class="o">=</span> <span class="s2">&quot;IsomericSMILES&quot;</span> <span class="k">if</span> <span class="n">isomeric</span> <span class="k">else</span> <span class="s2">&quot;CanonicalSMILES&quot;</span>  <span class="c1"># choose field</span>
    <span class="n">smi_url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;https://pubchem.ncbi.nlm.nih.gov/rest/pug/compound/cid/</span><span class="si">{</span><span class="n">cid_int</span><span class="si">}</span><span class="s2">/property/</span><span class="si">{</span><span class="n">kind</span><span class="si">}</span><span class="s2">/TXT&quot;</span>  <span class="c1"># TXT endpoint</span>
    <span class="n">smiles</span> <span class="o">=</span> <span class="n">safe_get_text</span><span class="p">(</span><span class="n">smi_url</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>  <span class="c1"># fetch SMILES</span>
    <span class="n">iupac_url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;https://pubchem.ncbi.nlm.nih.gov/rest/pug/compound/cid/</span><span class="si">{</span><span class="n">cid_int</span><span class="si">}</span><span class="s2">/property/IUPACName/TXT&quot;</span>  <span class="c1"># TXT endpoint</span>
    <span class="n">iupac</span> <span class="o">=</span> <span class="n">safe_get_text</span><span class="p">(</span><span class="n">iupac_url</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>  <span class="c1"># fetch IUPAC</span>
    <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;cid&quot;</span><span class="p">:</span> <span class="n">cid_int</span><span class="p">,</span> <span class="s2">&quot;smiles&quot;</span><span class="p">:</span> <span class="n">smiles</span><span class="p">,</span> <span class="s2">&quot;iupac&quot;</span><span class="p">:</span> <span class="n">iupac</span><span class="p">}</span>  <span class="c1"># result dict</span>
</pre></div>
</div>
</div>
</div>
<p><strong>Example</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pubchem_smiles_by_cid</span><span class="p">(</span><span class="mi">2244</span><span class="p">)</span>  <span class="c1"># aspirin</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;cid&#39;: 2244,
 &#39;smiles&#39;: &#39;CC(=O)OC1=CC=CC=C1C(=O)O&#39;,
 &#39;iupac&#39;: &#39;2-acetyloxybenzoic acid&#39;}
</pre></div>
</div>
</div>
</div>
</section>
<hr class="docutils" />
<section id="use-with-rdkit-short">
<h2><a class="toc-backref" href="#id10" role="doc-backlink">4.7 Use with RDKit (short)</a><a class="headerlink" href="#use-with-rdkit-short" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">rdkit</span><span class="w"> </span><span class="kn">import</span> <span class="n">Chem</span>  <span class="c1"># RDKit core</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">rdkit.Chem</span><span class="w"> </span><span class="kn">import</span> <span class="n">Draw</span>  <span class="c1"># drawing</span>

<span class="n">res</span> <span class="o">=</span> <span class="n">pubchem_smiles_by_name</span><span class="p">(</span><span class="s2">&quot;acetaminophen&quot;</span><span class="p">)</span>  <span class="c1"># fetch SMILES by name</span>
<span class="n">mol</span> <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">MolFromSmiles</span><span class="p">(</span><span class="n">res</span><span class="p">[</span><span class="s2">&quot;smiles&quot;</span><span class="p">])</span>  <span class="c1"># make molecule</span>
<span class="n">Draw</span><span class="o">.</span><span class="n">MolToImage</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">180</span><span class="p">,</span> <span class="mi">180</span><span class="p">))</span>  <span class="c1"># draw image</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/d0f74da9e182c2ead69035d24e58730a62deb212bac9344bdaea2137ff8694fe.png" src="_images/d0f74da9e182c2ead69035d24e58730a62deb212bac9344bdaea2137ff8694fe.png" />
</div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If <code class="docutils literal notranslate"><span class="pre">MolFromSmiles</span></code> gives <code class="docutils literal notranslate"><span class="pre">None</span></code>, print the SMILES string and check for copy issues.</p>
</div>
</section>
<hr class="docutils" />
<section id="save-and-export">
<h2><a class="toc-backref" href="#id11" role="doc-backlink">5. Save and export</a><a class="headerlink" href="#save-and-export" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mol</span> <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">MolFromSmiles</span><span class="p">(</span><span class="s2">&quot;CC(=O)OC1=CC=CC=C1C(=O)O&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;canonical:&quot;</span><span class="p">,</span> <span class="n">Chem</span><span class="o">.</span><span class="n">MolToSmiles</span><span class="p">(</span><span class="n">mol</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;isomeric:&quot;</span><span class="p">,</span> <span class="n">Chem</span><span class="o">.</span><span class="n">MolToSmiles</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">isomericSmiles</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>canonical: CC(=O)Oc1ccccc1C(=O)O
isomeric: CC(=O)Oc1ccccc1C(=O)O
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># SDF with 2D coordinates</span>
<span class="n">m</span> <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">AddHs</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">rdkit.Chem</span><span class="w"> </span><span class="kn">import</span> <span class="n">AllChem</span>
<span class="n">AllChem</span><span class="o">.</span><span class="n">Compute2DCoords</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
<span class="n">w</span> <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">SDWriter</span><span class="p">(</span><span class="s2">&quot;molecule.sdf&quot;</span><span class="p">)</span>
<span class="n">w</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">m</span><span class="p">);</span> <span class="n">w</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
<span class="s2">&quot;Saved molecule.sdf&quot;</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;Saved molecule.sdf&#39;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># PNG depiction</span>
<span class="n">img</span> <span class="o">=</span> <span class="n">Draw</span><span class="o">.</span><span class="n">MolToImage</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">400</span><span class="p">,</span> <span class="mi">300</span><span class="p">))</span>
<span class="n">img</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s2">&quot;molecule.png&quot;</span><span class="p">)</span>
<span class="s2">&quot;Saved molecule.png&quot;</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;Saved molecule.png&#39;
</pre></div>
</div>
</div>
</div>
</section>
<hr class="docutils" />
<section id="quick-reference">
<h2><a class="toc-backref" href="#id12" role="doc-backlink">6. Quick reference</a><a class="headerlink" href="#quick-reference" title="Link to this heading">#</a></h2>
<div class="admonition-smiles admonition">
<p class="admonition-title">SMILES</p>
<ul class="simple">
<li><p>Atoms: upper case aliphatic, lower case aromatic</p></li>
<li><p>Bonds: implicit single, =, #</p></li>
<li><p>Branches: parentheses</p></li>
<li><p>Rings: digits to open and close</p></li>
<li><p>Charges: bracket the atom, e.g., [O-], [NH4+]</p></li>
<li><p>Salts: separate parts with a dot</p></li>
<li><p>E or Z: use slashes around the double bond</p></li>
</ul>
</div>
<div class="admonition-rdkit admonition">
<p class="admonition-title">RDKit</p>
<ul class="simple">
<li><p>Parse: <code class="docutils literal notranslate"><span class="pre">Chem.MolFromSmiles</span></code></p></li>
<li><p>Draw: <code class="docutils literal notranslate"><span class="pre">Draw.MolToImage(...,</span> <span class="pre">includeAtomNumbers=True)</span></code></p></li>
<li><p>Hydrogens: <code class="docutils literal notranslate"><span class="pre">Chem.AddHs</span></code></p></li>
<li><p>Properties: <code class="docutils literal notranslate"><span class="pre">Descriptors.MolWt</span></code>, <code class="docutils literal notranslate"><span class="pre">Crippen.MolLogP</span></code>, <code class="docutils literal notranslate"><span class="pre">CalcNumHBA/HBD</span></code>, <code class="docutils literal notranslate"><span class="pre">CalcTPSA</span></code></p></li>
<li><p>Replace piece with piece: <code class="docutils literal notranslate"><span class="pre">Chem.ReplaceSubstructs(mol,</span> <span class="pre">findMol,</span> <span class="pre">repMol)</span></code></p></li>
<li><p>Salt split: <code class="docutils literal notranslate"><span class="pre">Chem.GetMolFrags(...,</span> <span class="pre">asMols=True)</span></code></p></li>
<li><p>Graph edit: <code class="docutils literal notranslate"><span class="pre">Chem.EditableMol</span></code></p></li>
<li><p>Save: <code class="docutils literal notranslate"><span class="pre">Chem.MolToSmiles</span></code>, <code class="docutils literal notranslate"><span class="pre">SDWriter</span></code>, PNG via <code class="docutils literal notranslate"><span class="pre">MolToImage(...).save(...)</span></code></p></li>
</ul>
</div>
</section>
<hr class="docutils" />
<section id="glossary">
<h2><a class="toc-backref" href="#id13" role="doc-backlink">7. Glossary</a><a class="headerlink" href="#glossary" title="Link to this heading">#</a></h2>
<dl class="simple glossary">
<dt id="term-SMILES">SMILES<a class="headerlink" href="#term-SMILES" title="Link to this term">#</a></dt><dd><p>Text line notation for molecules. Example: ethanol is CCO.</p>
</dd>
<dt id="term-aromatic">aromatic<a class="headerlink" href="#term-aromatic" title="Link to this term">#</a></dt><dd><p>Conjugated ring system represented with lower case atom symbols in SMILES, for example c1ccccc1.</p>
</dd>
<dt id="term-CID">CID<a class="headerlink" href="#term-CID" title="Link to this term">#</a></dt><dd><p>PubChem Compound ID for a unique compound record.</p>
</dd>
<dt id="term-sanitize">sanitize<a class="headerlink" href="#term-sanitize" title="Link to this term">#</a></dt><dd><p>RDKit process that checks valence, aromaticity, and stereochemistry.</p>
</dd>
<dt id="term-descriptor">descriptor<a class="headerlink" href="#term-descriptor" title="Link to this term">#</a></dt><dd><p>Computed molecular property such as molecular weight or LogP.</p>
</dd>
<dt id="term-EditableMol">EditableMol<a class="headerlink" href="#term-EditableMol" title="Link to this term">#</a></dt><dd><p>RDKit object that exposes low level atom and bond editing.</p>
</dd>
</dl>
</section>
<hr class="docutils" />
<section id="in-class-activity">
<h2><a class="toc-backref" href="#id14" role="doc-backlink">8. In-class activity</a><a class="headerlink" href="#in-class-activity" title="Link to this heading">#</a></h2>
<p>Each task mirrors the examples above. Fill in the <code class="docutils literal notranslate"><span class="pre">...</span></code> lines. Work in pairs. Solutions are in Section 9.</p>
<section id="read-a-smiles-and-inspect">
<h3>8.1 Read a SMILES and inspect<a class="headerlink" href="#read-a-smiles-and-inspect" title="Link to this heading">#</a></h3>
<p>Given <code class="docutils literal notranslate"><span class="pre">smi</span> <span class="pre">=</span> <span class="pre">&quot;O=C(O)c1ccccc1Cl&quot;</span></code>.<br />
a) Draw with atom numbers.<br />
b) Count number of rings.<br />
c) Print the list of bonds with begin and end atom indices and bond orders.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">rdkit</span><span class="w"> </span><span class="kn">import</span> <span class="n">Chem</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">rdkit.Chem</span><span class="w"> </span><span class="kn">import</span> <span class="n">Draw</span>

<span class="n">smi</span> <span class="o">=</span> <span class="o">...</span>  <span class="c1"># TO DO</span>

<span class="n">mol</span> <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">MolFromSmiles</span><span class="p">(</span><span class="n">smi</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">Draw</span><span class="o">.</span><span class="n">MolToImage</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">350</span><span class="p">,</span> <span class="mi">250</span><span class="p">),</span> <span class="n">includeAtomNumbers</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>

<span class="n">num_rings</span> <span class="o">=</span> <span class="o">...</span>   <span class="c1"># TO DO: Chem.GetSSSR(mol)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;rings:&quot;</span><span class="p">,</span> <span class="n">num_rings</span><span class="p">)</span>

<span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">mol</span><span class="o">.</span><span class="n">GetBonds</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;bond&quot;</span><span class="p">,</span> <span class="n">b</span><span class="o">.</span><span class="n">GetIdx</span><span class="p">(),</span> <span class="n">b</span><span class="o">.</span><span class="n">GetBeginAtomIdx</span><span class="p">(),</span> <span class="s2">&quot;-&quot;</span><span class="p">,</span> <span class="n">b</span><span class="o">.</span><span class="n">GetEndAtomIdx</span><span class="p">(),</span> <span class="s2">&quot;order&quot;</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">b</span><span class="o">.</span><span class="n">GetBondTypeAsDouble</span><span class="p">()))</span>
</pre></div>
</div>
</section>
<hr class="docutils" />
<section id="make-a-small-properties-table">
<h3>8.2 Make a small properties table<a class="headerlink" href="#make-a-small-properties-table" title="Link to this heading">#</a></h3>
<p>Use names <code class="docutils literal notranslate"><span class="pre">[&quot;caffeine&quot;,</span> <span class="pre">&quot;acetaminophen&quot;,</span> <span class="pre">&quot;ibuprofen&quot;]</span></code>. For each, fetch SMILES from PubChem, then compute MolWt, LogP, HBD, HBA, and TPSA.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">rdkit.Chem</span><span class="w"> </span><span class="kn">import</span> <span class="n">Descriptors</span><span class="p">,</span> <span class="n">Crippen</span><span class="p">,</span> <span class="n">rdMolDescriptors</span>

<span class="n">names</span> <span class="o">=</span> <span class="o">...</span>  <span class="c1"># TO DO</span>
<span class="n">rows</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">nm</span> <span class="ow">in</span> <span class="n">names</span><span class="p">:</span>
    <span class="n">info</span> <span class="o">=</span> <span class="o">...</span>  <span class="c1"># TO DO: pubchem_smiles_by_name</span>
    <span class="n">smi</span> <span class="o">=</span> <span class="n">info</span><span class="p">[</span><span class="s2">&quot;smiles&quot;</span><span class="p">]</span>
    <span class="n">m</span> <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">MolFromSmiles</span><span class="p">(</span><span class="n">smi</span><span class="p">)</span>
    <span class="n">rows</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
        <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="n">nm</span><span class="p">,</span>
        <span class="s2">&quot;smiles&quot;</span><span class="p">:</span> <span class="n">smi</span><span class="p">,</span>
        <span class="s2">&quot;MolWt&quot;</span><span class="p">:</span> <span class="o">...</span><span class="p">,</span>
        <span class="s2">&quot;LogP&quot;</span><span class="p">:</span> <span class="o">...</span><span class="p">,</span>
        <span class="s2">&quot;HBD&quot;</span><span class="p">:</span> <span class="o">...</span><span class="p">,</span>
        <span class="s2">&quot;HBA&quot;</span><span class="p">:</span> <span class="o">...</span><span class="p">,</span>
        <span class="s2">&quot;TPSA&quot;</span><span class="p">:</span> <span class="o">...</span>
    <span class="p">})</span>

<span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">rows</span><span class="p">)</span>
</pre></div>
</div>
</section>
<hr class="docutils" />
<section id="replace-chlorine-with-fluorine">
<h3>8.3 Replace chlorine with fluorine<a class="headerlink" href="#replace-chlorine-with-fluorine" title="Link to this heading">#</a></h3>
<p>Replace Cl with F in <code class="docutils literal notranslate"><span class="pre">Clc1ccc(cc1)C(=O)O</span></code> and print the result SMILES.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">find</span> <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">MolFromSmiles</span><span class="p">(</span><span class="o">...</span> <span class="p">)</span>  <span class="c1"># TO DO</span>
<span class="n">put</span>  <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">MolFromSmiles</span><span class="p">(</span><span class="o">...</span> <span class="p">)</span>  <span class="c1"># TO DO</span>
<span class="n">mol</span>  <span class="o">=</span> <span class="o">...</span> <span class="c1"># TO DO</span>
<span class="n">out</span>  <span class="o">=</span> <span class="o">...</span> <span class="c1"># TO DO</span>
<span class="nb">print</span><span class="p">(</span><span class="n">Chem</span><span class="o">.</span><span class="n">MolToSmiles</span><span class="p">(</span><span class="n">out</span><span class="p">))</span>
</pre></div>
</div>
</section>
<hr class="docutils" />
<section id="id1">
<h3>8.4 Add a methyl group with a graph edit<a class="headerlink" href="#id1" title="Link to this heading">#</a></h3>
<p>Add a methyl at atom index 2 of benzene.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">mol</span> <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">MolFromSmiles</span><span class="p">(</span><span class="s2">&quot;c1ccccc1&quot;</span><span class="p">)</span>
<span class="n">em</span> <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">EditableMol</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
<span class="c1"># TO DO: add code</span>
<span class="n">Draw</span><span class="o">.</span><span class="n">MolToImage</span><span class="p">(</span><span class="o">...</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">350</span><span class="p">,</span> <span class="mi">250</span><span class="p">))</span>
</pre></div>
</div>
</section>
<hr class="docutils" />
<section id="pubchem-lookup-to-smiles-and-drawing">
<h3>8.5 PubChem lookup to SMILES and drawing<a class="headerlink" href="#pubchem-lookup-to-smiles-and-drawing" title="Link to this heading">#</a></h3>
<p>We often get inputs in different formats. Some may be PubChem CIDs (just digits) while others are SMILES strings.</p>
<p>Tasks:</p>
<ol class="arabic simple">
<li><p>For each name in <code class="docutils literal notranslate"><span class="pre">[&quot;446157&quot;,</span> <span class="pre">&quot;2244&quot;,</span> <span class="pre">&quot;CCO&quot;,</span> <span class="pre">&quot;482752&quot;,</span> <span class="pre">&quot;c1ccccc1&quot;]</span></code></p></li>
<li><p>Print a line: <code class="docutils literal notranslate"><span class="pre">name:</span> <span class="pre">...</span> <span class="pre">CID=...</span> <span class="pre">SMILES=...</span></code>.</p></li>
<li><p>Draw each molecule.</p></li>
</ol>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>    <span class="n">mixed</span> <span class="o">=</span> <span class="p">[</span><span class="o">...</span><span class="p">]</span>

<span class="k">for</span> <span class="o">...</span> <span class="ow">in</span> <span class="o">...</span><span class="p">:</span>
    <span class="k">if</span> <span class="o">...</span><span class="p">:</span>  <span class="c1"># looks like CID</span>
      <span class="o">...</span>
    <span class="k">else</span><span class="p">:</span> 
      <span class="o">...</span> 
    <span class="nb">print</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
    <span class="n">mol</span> <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">MolFromSmiles</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
    <span class="n">display</span><span class="p">(</span><span class="n">Draw</span><span class="o">.</span><span class="n">MolToImage</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">)))</span>

</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Hint:
Try <code class="docutils literal notranslate"><span class="pre">isdigit()</span></code> to distinguish between cid-like input and SMILES</p>
</div>
</section>
</section>
<hr class="docutils" />
<section id="solutions">
<h2><a class="toc-backref" href="#id15" role="doc-backlink">9. Solutions</a><a class="headerlink" href="#solutions" title="Link to this heading">#</a></h2>
<p>Open after you try Section 8.</p>
<section id="solution-8-1">
<h3>Solution 8.1<a class="headerlink" href="#solution-8-1" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">rdkit</span><span class="w"> </span><span class="kn">import</span> <span class="n">Chem</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">rdkit.Chem</span><span class="w"> </span><span class="kn">import</span> <span class="n">Draw</span>

<span class="n">smi</span> <span class="o">=</span> <span class="s2">&quot;O=C(O)c1ccccc1Cl&quot;</span>

<span class="n">mol</span> <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">MolFromSmiles</span><span class="p">(</span><span class="n">smi</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">Draw</span><span class="o">.</span><span class="n">MolToImage</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">350</span><span class="p">,</span> <span class="mi">250</span><span class="p">),</span> <span class="n">includeAtomNumbers</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>

<span class="n">num_rings</span> <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">GetSSSR</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;rings:&quot;</span><span class="p">,</span> <span class="n">num_rings</span><span class="p">)</span>

<span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">mol</span><span class="o">.</span><span class="n">GetBonds</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;bond&quot;</span><span class="p">,</span> <span class="n">b</span><span class="o">.</span><span class="n">GetIdx</span><span class="p">(),</span> <span class="n">b</span><span class="o">.</span><span class="n">GetBeginAtomIdx</span><span class="p">(),</span> <span class="s2">&quot;-&quot;</span><span class="p">,</span> <span class="n">b</span><span class="o">.</span><span class="n">GetEndAtomIdx</span><span class="p">(),</span> <span class="s2">&quot;order&quot;</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">b</span><span class="o">.</span><span class="n">GetBondTypeAsDouble</span><span class="p">()))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/8d684575496d592c6f31701af2168169b7e533b522ea4f1c2cb135e5381f14b4.png" src="_images/8d684575496d592c6f31701af2168169b7e533b522ea4f1c2cb135e5381f14b4.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>rings: &lt;rdkit.rdBase._vectclass std::vector&lt;int,class std::allocator&lt;int&gt; &gt; object at 0x000001E2588B0340&gt;
bond 0 0 - 1 order 2
bond 1 1 - 2 order 1
bond 2 1 - 3 order 1
bond 3 3 - 4 order 1
bond 4 4 - 5 order 1
bond 5 5 - 6 order 1
bond 6 6 - 7 order 1
bond 7 7 - 8 order 1
bond 8 8 - 9 order 1
bond 9 8 - 3 order 1
</pre></div>
</div>
</div>
</div>
</section>
<section id="solution-8-2">
<h3>Solution 8.2<a class="headerlink" href="#solution-8-2" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">rdkit.Chem</span><span class="w"> </span><span class="kn">import</span> <span class="n">Descriptors</span><span class="p">,</span> <span class="n">Crippen</span><span class="p">,</span> <span class="n">rdMolDescriptors</span>

<span class="n">names</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;caffeine&quot;</span><span class="p">,</span> <span class="s2">&quot;acetaminophen&quot;</span><span class="p">,</span> <span class="s2">&quot;ibuprofen&quot;</span><span class="p">]</span>
<span class="n">rows</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">nm</span> <span class="ow">in</span> <span class="n">names</span><span class="p">:</span>
    <span class="n">info</span> <span class="o">=</span> <span class="n">pubchem_smiles_by_name</span><span class="p">(</span><span class="n">nm</span><span class="p">)</span>
    <span class="n">smi</span> <span class="o">=</span> <span class="n">info</span><span class="p">[</span><span class="s2">&quot;smiles&quot;</span><span class="p">]</span>
    <span class="n">m</span> <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">MolFromSmiles</span><span class="p">(</span><span class="n">smi</span><span class="p">)</span>
    <span class="n">rows</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
        <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="n">nm</span><span class="p">,</span>
        <span class="s2">&quot;smiles&quot;</span><span class="p">:</span> <span class="n">smi</span><span class="p">,</span>
        <span class="s2">&quot;MolWt&quot;</span><span class="p">:</span> <span class="n">Descriptors</span><span class="o">.</span><span class="n">MolWt</span><span class="p">(</span><span class="n">m</span><span class="p">),</span>
        <span class="s2">&quot;LogP&quot;</span><span class="p">:</span> <span class="n">Crippen</span><span class="o">.</span><span class="n">MolLogP</span><span class="p">(</span><span class="n">m</span><span class="p">),</span>
        <span class="s2">&quot;HBD&quot;</span><span class="p">:</span> <span class="n">rdMolDescriptors</span><span class="o">.</span><span class="n">CalcNumHBD</span><span class="p">(</span><span class="n">m</span><span class="p">),</span>
        <span class="s2">&quot;HBA&quot;</span><span class="p">:</span> <span class="n">rdMolDescriptors</span><span class="o">.</span><span class="n">CalcNumHBA</span><span class="p">(</span><span class="n">m</span><span class="p">),</span>
        <span class="s2">&quot;TPSA&quot;</span><span class="p">:</span> <span class="n">rdMolDescriptors</span><span class="o">.</span><span class="n">CalcTPSA</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
    <span class="p">})</span>

<span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">rows</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>name</th>
      <th>smiles</th>
      <th>MolWt</th>
      <th>LogP</th>
      <th>HBD</th>
      <th>HBA</th>
      <th>TPSA</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>caffeine</td>
      <td>CN1C=NC2=C1C(=O)N(C(=O)N2C)C</td>
      <td>194.194</td>
      <td>-1.0293</td>
      <td>0</td>
      <td>6</td>
      <td>61.82</td>
    </tr>
    <tr>
      <th>1</th>
      <td>acetaminophen</td>
      <td>CC(=O)NC1=CC=C(C=C1)O</td>
      <td>151.165</td>
      <td>1.3506</td>
      <td>2</td>
      <td>2</td>
      <td>49.33</td>
    </tr>
    <tr>
      <th>2</th>
      <td>ibuprofen</td>
      <td>CC(C)CC1=CC=C(C=C1)C(C)C(=O)O</td>
      <td>206.285</td>
      <td>3.0732</td>
      <td>1</td>
      <td>1</td>
      <td>37.30</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="solution-8-3">
<h3>Solution 8.3<a class="headerlink" href="#solution-8-3" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">find</span> <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">MolFromSmiles</span><span class="p">(</span><span class="s2">&quot;Cl&quot;</span><span class="p">)</span>
<span class="n">put</span>  <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">MolFromSmiles</span><span class="p">(</span><span class="s2">&quot;F&quot;</span><span class="p">)</span>
<span class="n">mol</span>  <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">MolFromSmiles</span><span class="p">(</span><span class="s2">&quot;Clc1ccc(cc1)C(=O)O&quot;</span><span class="p">)</span>
<span class="n">out</span>  <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">ReplaceSubstructs</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">find</span><span class="p">,</span> <span class="n">put</span><span class="p">,</span> <span class="n">replaceAll</span><span class="o">=</span><span class="kc">True</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">Chem</span><span class="o">.</span><span class="n">MolToSmiles</span><span class="p">(</span><span class="n">out</span><span class="p">))</span>
<span class="n">Draw</span><span class="o">.</span><span class="n">MolToImage</span><span class="p">(</span><span class="n">out</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">350</span><span class="p">,</span> <span class="mi">250</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>O=C(O)c1ccc(F)cc1
</pre></div>
</div>
<img alt="_images/96a64de8ab6de3cba9bdeb085779432c65dde405ede31f9884814f235d701bda.png" src="_images/96a64de8ab6de3cba9bdeb085779432c65dde405ede31f9884814f235d701bda.png" />
</div>
</div>
</section>
<section id="solution-8-4">
<h3>Solution 8.4<a class="headerlink" href="#solution-8-4" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mol</span> <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">MolFromSmiles</span><span class="p">(</span><span class="s2">&quot;c1ccccc1&quot;</span><span class="p">)</span>
<span class="n">em</span> <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">EditableMol</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>

<span class="n">idx_C</span> <span class="o">=</span> <span class="n">em</span><span class="o">.</span><span class="n">AddAtom</span><span class="p">(</span><span class="n">Chem</span><span class="o">.</span><span class="n">Atom</span><span class="p">(</span><span class="s2">&quot;C&quot;</span><span class="p">))</span>
<span class="n">idx_H1</span> <span class="o">=</span> <span class="n">em</span><span class="o">.</span><span class="n">AddAtom</span><span class="p">(</span><span class="n">Chem</span><span class="o">.</span><span class="n">Atom</span><span class="p">(</span><span class="s2">&quot;H&quot;</span><span class="p">))</span>
<span class="n">idx_H2</span> <span class="o">=</span> <span class="n">em</span><span class="o">.</span><span class="n">AddAtom</span><span class="p">(</span><span class="n">Chem</span><span class="o">.</span><span class="n">Atom</span><span class="p">(</span><span class="s2">&quot;H&quot;</span><span class="p">))</span>
<span class="n">idx_H3</span> <span class="o">=</span> <span class="n">em</span><span class="o">.</span><span class="n">AddAtom</span><span class="p">(</span><span class="n">Chem</span><span class="o">.</span><span class="n">Atom</span><span class="p">(</span><span class="s2">&quot;H&quot;</span><span class="p">))</span>

<span class="n">em</span><span class="o">.</span><span class="n">AddBond</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">idx_C</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="n">Chem</span><span class="o">.</span><span class="n">BondType</span><span class="o">.</span><span class="n">SINGLE</span><span class="p">)</span>
<span class="n">em</span><span class="o">.</span><span class="n">AddBond</span><span class="p">(</span><span class="n">idx_C</span><span class="p">,</span> <span class="n">idx_H1</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="n">Chem</span><span class="o">.</span><span class="n">BondType</span><span class="o">.</span><span class="n">SINGLE</span><span class="p">)</span>
<span class="n">em</span><span class="o">.</span><span class="n">AddBond</span><span class="p">(</span><span class="n">idx_C</span><span class="p">,</span> <span class="n">idx_H2</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="n">Chem</span><span class="o">.</span><span class="n">BondType</span><span class="o">.</span><span class="n">SINGLE</span><span class="p">)</span>
<span class="n">em</span><span class="o">.</span><span class="n">AddBond</span><span class="p">(</span><span class="n">idx_C</span><span class="p">,</span> <span class="n">idx_H3</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="n">Chem</span><span class="o">.</span><span class="n">BondType</span><span class="o">.</span><span class="n">SINGLE</span><span class="p">)</span>

<span class="n">mol2</span> <span class="o">=</span> <span class="n">em</span><span class="o">.</span><span class="n">GetMol</span><span class="p">()</span>
<span class="n">Chem</span><span class="o">.</span><span class="n">SanitizeMol</span><span class="p">(</span><span class="n">mol2</span><span class="p">)</span>
<span class="n">Draw</span><span class="o">.</span><span class="n">MolToImage</span><span class="p">(</span><span class="n">mol2</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">350</span><span class="p">,</span> <span class="mi">250</span><span class="p">),</span> <span class="n">includeAtomNumbers</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/740e404a58d6f2880b124dcd97f5809abd087f30f63ec0cb3b8dfbdd52f45e1f.png" src="_images/740e404a58d6f2880b124dcd97f5809abd087f30f63ec0cb3b8dfbdd52f45e1f.png" />
</div>
</div>
</section>
<section id="solution-8-5">
<h3>Solution 8.5<a class="headerlink" href="#solution-8-5" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mixed</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;446157&quot;</span><span class="p">,</span> <span class="s2">&quot;2244&quot;</span><span class="p">,</span> <span class="s2">&quot;CCO&quot;</span><span class="p">,</span> <span class="s2">&quot;482752&quot;</span><span class="p">,</span> <span class="s2">&quot;c1ccccc1&quot;</span><span class="p">]</span>

<span class="k">for</span> <span class="n">q</span> <span class="ow">in</span> <span class="n">mixed</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">q</span><span class="o">.</span><span class="n">isdigit</span><span class="p">():</span>  <span class="c1"># looks like CID</span>
        <span class="n">info</span> <span class="o">=</span> <span class="n">pubchem_smiles_by_cid</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">q</span><span class="p">))</span>
        <span class="n">smi</span><span class="p">,</span> <span class="n">cid</span> <span class="o">=</span> <span class="n">info</span><span class="p">[</span><span class="s2">&quot;smiles&quot;</span><span class="p">],</span> <span class="n">info</span><span class="p">[</span><span class="s2">&quot;cid&quot;</span><span class="p">]</span>
    <span class="k">elif</span> <span class="n">Chem</span><span class="o">.</span><span class="n">MolFromSmiles</span><span class="p">(</span><span class="n">q</span><span class="p">):</span>  <span class="c1"># parses as SMILES</span>
        <span class="n">smi</span><span class="p">,</span> <span class="n">cid</span> <span class="o">=</span> <span class="n">q</span><span class="p">,</span> <span class="kc">None</span>
    <span class="k">else</span><span class="p">:</span>  <span class="c1"># treat as name</span>
        <span class="n">info</span> <span class="o">=</span> <span class="n">pubchem_smiles_by_name</span><span class="p">(</span><span class="n">q</span><span class="p">)</span>
        <span class="n">smi</span><span class="p">,</span> <span class="n">cid</span> <span class="o">=</span> <span class="n">info</span><span class="p">[</span><span class="s2">&quot;smiles&quot;</span><span class="p">],</span> <span class="n">info</span><span class="p">[</span><span class="s2">&quot;cid&quot;</span><span class="p">]</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;input=</span><span class="si">{</span><span class="n">q</span><span class="si">}</span><span class="s2"> CID=</span><span class="si">{</span><span class="n">cid</span><span class="si">}</span><span class="s2"> SMILES=</span><span class="si">{</span><span class="n">smi</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">mol</span> <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">MolFromSmiles</span><span class="p">(</span><span class="n">smi</span><span class="p">)</span>
    <span class="n">display</span><span class="p">(</span><span class="n">Draw</span><span class="o">.</span><span class="n">MolToImage</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">260</span><span class="p">,</span> <span class="mi">200</span><span class="p">)))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>input=446157 CID=446157 SMILES=CC(C)C1=NC(=NC(=C1/C=C/[C@H](C[C@H](CC(=O)O)O)O)C2=CC=C(C=C2)F)N(C)S(=O)(=O)C
</pre></div>
</div>
<img alt="_images/b1dc98d469c42a32735cff27ce66089e25fe87a9e610b61ff43b39ffa8c38b27.png" src="_images/b1dc98d469c42a32735cff27ce66089e25fe87a9e610b61ff43b39ffa8c38b27.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>input=2244 CID=2244 SMILES=CC(=O)OC1=CC=CC=C1C(=O)O
</pre></div>
</div>
<img alt="_images/48e4b149d4833864466a0e573590f68228e21a714297a0c83df764fbdb78be38.png" src="_images/48e4b149d4833864466a0e573590f68228e21a714297a0c83df764fbdb78be38.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>input=CCO CID=None SMILES=CCO
</pre></div>
</div>
<img alt="_images/62cc51fb89f64b5b89ea7d0c198a6439059e9b3b6126e6bf4ab5a45dac689b8b.png" src="_images/62cc51fb89f64b5b89ea7d0c198a6439059e9b3b6126e6bf4ab5a45dac689b8b.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>input=482752 CID=482752 SMILES=CC[N+]1=CC=C(C=C1)C2=C3C=CC(=C(C4=NC(=C(C5=CC=C([NH2+]5)C(=C6C=CC2=N6)C7=CC=[N+](C=C7)CC)C8=CC=[N+](C=C8)CC)C=C4)C9=CC=[N+](C=C9)CC)[NH2+]3.[Cl-]
</pre></div>
</div>
<img alt="_images/85c485517b00052d680d7b41a560bdd791b6634c26276b4eed063526dd2ec260.png" src="_images/85c485517b00052d680d7b41a560bdd791b6634c26276b4eed063526dd2ec260.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>input=c1ccccc1 CID=None SMILES=c1ccccc1
</pre></div>
</div>
<img alt="_images/69f8833c95e32f68fe360f6a9539c39e882b07ac9ac290acc3974807f1eb85c4.png" src="_images/69f8833c95e32f68fe360f6a9539c39e882b07ac9ac290acc3974807f1eb85c4.png" />
</div>
</div>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#learning-goals">Learning goals</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#smiles">1. SMILES</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#atoms">1.1 Atoms</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#bonds">1.2 Bonds</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#branches">1.3 Branches</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#rings">1.4 Rings</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#aromatic-vs-aliphatic">1.5 Aromatic vs aliphatic</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#charges-and-salts">1.6 Charges and salts</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#simple-stereochemistry">1.7 Simple stereochemistry</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#rdkit-quick-start">2. RDKit quick start</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#small-edits-in-rdkit">3. Small edits in RDKit</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#replace-atom-type-by-matching-a-small-molecule">3.1 Replace atom type by matching a small molecule</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#neutralize-a-carboxylate">3.2 Neutralize a carboxylate</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#add-a-methyl-group-with-a-graph-edit">3.3 Add a methyl group with a graph edit</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#why-use-editablemol-instead-of-just-smiles-edits">3.4 Why use <code class="docutils literal notranslate"><span class="pre">EditableMol</span></code> instead of just SMILES edits?</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#pubchem-and-url">4. PubChem and URL</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#install-and-imports">4.1 Install and imports</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#resolve-a-name-to-a-cid">4.2 Resolve a <strong>name</strong> to a CID</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#get-properties-from-the-cid">4.3 Get properties from the CID</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#get-the-iupac-name">4.3.1 Get the <strong>IUPAC name</strong></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#get-the-canonical-smiles">4.3.2 Get the <strong>Canonical SMILES</strong></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#get-the-isomeric-smiles">4.3.3 Get the <strong>Isomeric SMILES</strong></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#make-it-safe-minimal-error-handling">4.4 Make it safe: minimal error handling</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#function-by-name">4.5 Function: by <strong>name</strong></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#function-by-cid">4.6 Function: by <strong>CID</strong></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#use-with-rdkit-short">4.7 Use with RDKit (short)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#save-and-export">5. Save and export</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#quick-reference">6. Quick reference</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#glossary">7. Glossary</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#in-class-activity">8. In-class activity</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#read-a-smiles-and-inspect">8.1 Read a SMILES and inspect</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#make-a-small-properties-table">8.2 Make a small properties table</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#replace-chlorine-with-fluorine">8.3 Replace chlorine with fluorine</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">8.4 Add a methyl group with a graph edit</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pubchem-lookup-to-smiles-and-drawing">8.5 PubChem lookup to SMILES and drawing</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#solutions">9. Solutions</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#solution-8-1">Solution 8.1</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#solution-8-2">Solution 8.2</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#solution-8-3">Solution 8.3</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#solution-8-4">Solution 8.4</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#solution-8-5">Solution 8.5</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By The Jupyter Book Community
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>