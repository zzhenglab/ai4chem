Search.setIndex({"docnames": ["intro", "lecture-10", "lecture-11", "lecture-12", "lecture-15 autoencode and predict next smiles", "lecture-15 contrast back up", "lecture-solution copy"], "filenames": ["intro.md", "lecture-10.ipynb", "lecture-11.md", "lecture-12.md", "lecture-15 autoencode and predict next smiles.md", "lecture-15 contrast back up.md", "lecture-solution copy.md"], "titles": ["Welcome to CHEM 5080: AI for Chemistry", "Lecture 10 - Property &amp; Reaction Prediction", "Lecture 11 - Dimension Reduction for Data Visualization", "Lecture 12 - Self-supervised Learning", "Lecture 12 \u2014 Self-supervised Learning", "Lecture 12 \u2014 Self-supervised Learning", "7. Solution"], "terms": {"washington": 0, "univers": 0, "st": 0, "loui": 0, "fall": [0, 3, 5], "2025": [0, 1], "instructor": 0, "zhile": 0, "zach": 0, "zheng": 0, "he": 0, "him": 0, "offic": 0, "mcmillen": 0, "411": [0, 1], "email": 0, "z": [0, 2, 3, 4, 5], "wustl": 0, "edu": 0, "cours": 0, "format": 0, "when": [0, 1, 2, 3, 4, 5], "tue": 0, "thu": [0, 2], "1": [0, 6], "00": [0, 1, 3, 4], "2": [0, 6], "20": [0, 1, 2, 4, 5, 6], "pm": [0, 1], "where": [0, 1, 2, 3, 4, 5], "cuppl": 0, "ii": [0, 2], "room": 0, "200": [0, 2, 4, 5], "materi": 0, "deliveri": 0, "jupyt": 0, "book": [0, 1, 2, 3, 4, 5], "colab": [0, 1, 2], "notebook": [0, 1, 5], "bring": 0, "your": [0, 1, 2, 5], "laptop": 0, "curios": 0, "prepar": [0, 2, 4], "experi": [0, 5], "content": [0, 1], "lectur": 0, "python": [0, 2, 4], "primer": 0, "panda": [0, 1, 2, 3, 4, 5, 6], "plot": [0, 2, 4, 5, 6], "3": [0, 6], "smile": [0, 1, 2, 3, 5, 6], "rdkit": [0, 1, 2, 3, 4, 5, 6], "4": [0, 6], "chemic": [0, 1, 2, 3], "structur": [0, 1, 2, 3, 4], "identifi": 0, "5": [0, 6], "regress": [0, 5], "classif": 0, "6": [0, 4, 6], "cross": [0, 1, 2, 5], "valid": [0, 1, 4], "7": [0, 2], "decis": 0, "tree": [0, 1], "random": [0, 1, 2, 3, 4, 5], "forest": 0, "8": [0, 2, 3], "neural": [0, 2], "network": [0, 2, 5], "9": [0, 1, 2, 3, 4, 6], "graph": [0, 1, 2, 3], "10": [0, 4, 5, 6], "properti": [0, 4], "reaction": 0, "predict": [0, 2, 4, 5], "11": [0, 1, 3, 5], "dimens": [0, 3, 5], "reduct": 0, "data": 0, "visual": [0, 1, 3, 4], "aug": [0, 5], "26": [0, 1], "28": [0, 1, 3], "intro": 0, "basic": 0, "sept": 0, "molecular": [0, 1, 2, 3], "represent": [0, 1, 2], "16": [0, 1, 2, 3, 5], "18": [0, 1, 2, 3, 4, 5], "supervis": 0, "machin": 0, "learn": 0, "23": [0, 1, 3, 4], "25": [0, 1, 3, 4], "30": [0, 1, 2, 3, 4, 6], "oct": 0, "unsupervis": 0, "method": [0, 1, 2], "break": [0, 1, 4], "de": 0, "novo": 0, "molecul": [0, 1, 2, 3, 4], "gener": [0, 1, 2, 5], "14": [0, 1, 3, 4], "bayesian": 0, "optim": [0, 1, 2, 3, 4, 5], "21": [0, 1, 2], "No": [0, 1, 3], "class": [0, 5, 6], "contrast": 0, "comput": [0, 1, 2, 3, 4, 5], "vision": 0, "techniqu": 0, "nov": 0, "transform": [0, 1, 2, 3, 4, 5, 6], "larg": [0, 1, 2, 3], "languag": 0, "model": [0, 2, 3], "13": [0, 1, 4, 5], "multimod": 0, "literatur": 0, "mine": 0, "multi": [0, 1], "agent": 0, "lab": [0, 3, 5], "self": [0, 1, 2], "drive": [0, 1, 2], "27": [0, 1], "thanksgiv": 0, "dec": 0, "final": [0, 1], "present": [0, 1, 5], "date": 0, "due": [0, 1], "evalu": [0, 1, 2, 3, 5], "all": [0, 1, 2, 3, 5], "resourc": 0, "provid": [0, 1, 5], "via": [0, 2, 3, 5], "thi": [0, 1, 2, 3, 4, 5], "exercis": [0, 1, 4], "googl": 0, "recommend": [0, 1], "requir": [0, 3], "read": [0, 2], "introduct": 0, "scienc": 0, "engin": 0, "kitchin": 0, "janet": 0, "kulik": 0, "deep": 0, "white": [0, 2, 3], "outcom": [0, 1], "By": [0, 1], "end": [0, 1], "you": [0, 1, 2, 3, 4], "abl": 0, "select": [0, 2, 3, 5], "appli": [0, 1, 2, 3, 4, 5, 6], "ml": [0, 2, 3, 4], "problem": 0, "interpret": [0, 1, 2], "implement": [0, 1], "code": [0, 2, 5], "us": [0, 1, 3, 4, 5], "base": [0, 1, 2, 3, 5], "grade": 0, "homework": 0, "40": [0, 1, 2], "analysi": 0, "task": [0, 1, 2, 5], "midterm": 0, "mini": 0, "review": 0, "essai": 0, "ac": 0, "style": [0, 1, 2, 5], "team": 0, "execut": [0, 1, 4], "summari": [0, 1, 5], "peer": 0, "feedback": 0, "classmat": 0, "work": [0, 1, 2, 3, 5], "bonu": 0, "point": [0, 2, 3, 4], "up": [0, 1, 2, 3, 5], "In": [0, 5, 6], "poll": 0, "question": 0, "discuss": 0, "academ": 0, "polici": 0, "integr": 0, "cite": 0, "sourc": [0, 1, 5], "includ": [0, 2], "tool": 0, "record": [0, 3, 5], "unauthor": 0, "distribut": [0, 2, 5], "accommod": 0, "student": [0, 2], "need": [0, 1, 4, 5], "should": [0, 5], "contact": 0, "disabl": [0, 1], "equiti": 0, "support": [0, 1, 2], "harass": 0, "report": [0, 1, 3, 4, 5], "acknowledg": 0, "we": [0, 1, 2, 3, 4, 5], "thank": 0, "professor": 0, "robert": 0, "wexler": 0, "hi": [0, 1], "guidanc": 0, "build": [0, 3, 4], "websit": 0, "help": [0, 1, 3, 5], "also": [0, 1, 2, 3, 5], "bingcui": 0, "guo": 0, "whose": [0, 2], "contribut": [0, 2], "were": [0, 1], "tremend": 0, "valuabl": 0, "test": [0, 2, 4, 5, 6], "set": [1, 3, 4, 5], "v2": [1, 5], "our": [1, 2, 3, 5], "four": [1, 2, 5], "singl": [1, 2, 4, 5], "pka": [1, 3, 4], "an": [1, 2, 4, 5], "atom": 1, "level": 1, "predictor": 1, "shaplei": 1, "valu": [1, 2, 3, 4, 5], "shap": 1, "featur": [1, 3, 4], "node": 1, "For": [1, 2, 3, 4, 5], "i": [1, 2, 3, 4, 5, 6], "run": [1, 2, 3, 5], "everyth": [1, 2, 5], "On": [1, 2], "html": 1, "page": 1, "some": [1, 2, 3], "output": [1, 5], "ar": [1, 2, 3, 4, 5], "limit": [1, 5], "rais": [1, 4], "runtimeerror": 1, "intent": 1, "stop": [1, 3], "here": [1, 2, 3, 4], "traceback": [1, 4, 6], "most": [1, 2, 3, 4, 6], "recent": [1, 4, 6], "call": [1, 2, 4, 6], "last": [1, 3, 4, 6], "cell": [1, 2, 3, 4, 6], "relat": [1, 2], "label": [1, 2, 3, 4, 5, 6], "briefli": 1, "speak": 1, "As": [1, 3], "recal": 1, "from": [1, 2, 3, 4, 5, 6], "previou": [1, 2], "updat": [1, 3], "hidden": 1, "vector": [1, 2, 5], "edg": [1, 2], "local": [1, 2, 3, 4, 5], "neighbor": [1, 3], "inform": [1, 2, 4, 5], "aggreg": 1, "step": [1, 3, 5], "creat": [1, 2, 4, 5], "": [1, 2, 3, 4, 5, 6], "variant": [1, 5], "chang": [1, 2, 3, 5, 6], "wai": [1, 2, 3], "flow": 1, "instead": [1, 2, 3, 5], "back": [1, 3, 5], "forth": 1, "between": [1, 2, 3, 5], "assign": [1, 3], "state": [1, 2], "each": [1, 2, 3, 4, 5], "bond": 1, "j": [1, 2, 3, 4, 5, 6], "prevent": 1, "immedi": 1, "backtrack": 1, "totter": 1, "would": 1, "simpli": 1, "bounc": 1, "two": [1, 2, 3, 5], "without": [1, 2, 4], "captur": [1, 2], "new": [1, 2, 4], "context": [1, 4, 5], "distinguish": 1, "subtl": [1, 2], "environ": [1, 3, 5], "exampl": [1, 2, 3, 5], "carri": [1, 4], "carbon": 1, "toward": 1, "nitrogen": [1, 2], "can": [1, 2, 3, 4, 5], "differ": [1, 2, 3, 5, 6], "than": [1, 2, 3], "revers": 1, "which": [1, 3, 4, 5], "matter": [1, 3], "gnn": 1, "like": [1, 2], "number": [1, 2, 3, 6], "degre": 1, "aromat": [1, 2], "order": [1, 2, 3, 5], "stereo": 1, "initi": [1, 3], "h_": 1, "0": [1, 2, 3, 5, 6], "function": [1, 2, 3, 4], "t": [1, 5, 6], "sigma": [1, 2, 5], "big": [1, 5], "w": [1, 3, 5], "cdot": [1, 5], "sum_": [1, 2, 3], "k": [1, 2, 6], "mathcal": [1, 5], "n": [1, 2, 3, 5, 6], "setminu": 1, "b": [1, 2, 3, 5, 6], "\u03c3": 1, "relu": [1, 5], "weight": [1, 2], "x_": [1, 2], "input": [1, 2, 5], "concaten": [1, 5], "after": [1, 2, 5], "per": [1, 2, 3, 4, 5], "pool": [1, 5], "h_mol": 1, "sum": [1, 3, 4, 5], "mean": [1, 2, 3, 4, 5, 6], "attent": 1, "feed": [1, 2], "multitask": 1, "feedforward": 1, "head": [1, 2, 3, 4, 6], "have": [1, 2, 3], "been": 1, "follow": [1, 3], "quit": 1, "mani": [1, 3, 4, 5], "time": [1, 2, 3], "solubility_mol_per_l": [1, 3, 4], "continu": [1, 3], "loss": 1, "mse": 1, "mae": 1, "categor": 1, "non_tox": [1, 3, 4], "binari": [1, 2, 3, 5], "while": [1, 2, 5], "never": 1, "try": [1, 2, 3, 4, 5], "befor": [1, 2, 3, 5], "v": [1, 3, 6], "whether": [1, 2, 5], "substrat": 1, "undergo": 1, "site": [1, 3, 4], "indic": [1, 2, 3, 5], "insid": [1, 4], "under": [1, 2, 5], "certain": 1, "electrochem": 1, "condit": [1, 2], "express": [1, 2], "remind": 1, "below": [1, 2, 3, 4], "formula": 1, "text": [1, 2, 3, 5, 6], "frac": [1, 2, 3, 5], "sum_i": 1, "y_i": [1, 2], "hat": [1, 4], "qquad": [1, 2], "entropi": [1, 2, 5], "l": 1, "log": [1, 2, 4, 5], "p_i": 1, "saw": 1, "idea": [1, 2, 3, 4], "earlier": [1, 2], "The": [1, 2, 3, 4, 5], "part": [1, 3, 5], "offer": 1, "modul": [1, 5], "begin": [1, 3], "load": [1, 2, 4, 6], "inspect": [1, 3], "url": [1, 2, 3, 4, 5], "http": [1, 2, 3, 4, 5], "raw": [1, 2, 3, 4, 5], "githubusercont": [1, 2, 3, 4, 5], "com": [1, 2, 3, 4, 5], "zzhenglab": [1, 2, 3, 4, 5], "ai4chem": [1, 2, 3, 4, 5], "main": [1, 2, 3, 4, 5], "_data": [1, 2, 3, 4, 5], "c_h_oxidation_dataset": [1, 2, 3, 4], "csv": [1, 2, 3, 4, 5], "df_raw": [1, 2, 3, 4, 6], "pd": [1, 2, 3, 4, 5, 6], "read_csv": [1, 2, 3, 4, 5], "compound": [1, 2, 3, 4, 6], "name": [1, 2, 3, 4, 5, 6], "ca": [1, 3, 4], "dihydro": [1, 3, 4], "1h": [1, 3, 4], "isochromen": [1, 3, 4], "493": [1, 3, 4], "05": [1, 3, 4, 5], "c1ccc2c": [1, 3, 4], "c1": [1, 2, 3, 4], "ccoc2": [1, 3, 4], "103906": [1, 3, 4], "80": [1, 2, 3, 4, 6], "65": [1, 3, 4], "9h": [1, 3, 4], "fluoren": [1, 3, 4], "86": [1, 3, 4], "73": [1, 3, 4], "cc1ccccc1": [1, 2, 3, 4], "010460": [1, 3, 4], "82": [1, 3, 4], "90": [1, 3, 4], "tetrahydronaphthalen": [1, 3, 4], "119": [1, 3, 4], "64": [1, 3, 4, 5, 6], "cccc2": [1, 3, 4], "020589": [1, 3, 4], "74": [1, 3, 4], "69": [1, 3, 4], "ethylbenzen": [1, 2, 3], "100": [1, 2, 4, 5], "41": 1, "ccc1ccccc1": [1, 2, 3], "048107": 1, "87": 1, "cyclohexen": [1, 3], "110": 1, "83": 1, "ccccc1": [1, 3], "060688": 1, "66": 1, "96": [1, 3], "clean": 1, "copi": [1, 2, 3, 4, 5, 6], "normal": [1, 4, 5], "few": [1, 2, 4], "column": [1, 2, 3, 4, 5, 6], "df": [1, 3], "string": [1, 2, 3, 4], "tox_map": 1, "tox_bin": 1, "str": [1, 2, 3, 4, 5, 6], "lower": [1, 5], "map": [1, 2, 3, 5, 6], "react_bin": 1, "lambda": [1, 2, 3, 4, 5, 6], "x": [1, 2, 3, 4, 5], "els": [1, 3, 4, 5], "list": [1, 2, 3, 5, 6], "int": [1, 2, 3, 4, 5, 6], "def": [1, 2, 3, 4, 5, 6], "parse_sit": 1, "isinst": 1, "len": [1, 2, 3, 4, 5, 6], "strip": 1, "return": [1, 2, 3, 4, 5, 6], "split": [1, 2, 3], "site_list": 1, "take": [1, 2, 3, 5], "keep": [1, 2, 3, 4, 5], "same": [1, 2, 3, 4, 5], "np": [1, 2, 3, 4, 5, 6], "log10": 1, "1e": [1, 4, 5], "983356": 1, "980414": 1, "686343": 1, "317782": 1, "216890": 1, "c1ccsc1": 1, "917634": 1, "97": 1, "15": [1, 2, 3, 4], "cn1cccc1": 1, "o": [1, 2, 3, 5, 6], "499442": 1, "91": 1, "71": 1, "cocc1ccccc1": 1, "070756": 1, "61": 1, "108": 1, "count": [1, 2, 3, 4, 5], "postiv": 1, "neg": [1, 2, 4, 5], "moleculedatapoint": 1, "object": [1, 2, 3, 5], "target": [1, 2, 5], "loader": 1, "first": [1, 2, 3, 4, 5, 6], "datapoint": 1, "row": [1, 2, 3, 5, 6], "datafram": [1, 2, 3, 4, 6], "now": [1, 2], "repres": [1, 2, 5], "It": [1, 2, 3, 4, 5], "store": 1, "numer": [1, 5], "plu": [1, 5], "metadata": 1, "option": [1, 2], "unit": [1, 2, 3], "both": [1, 2, 3, 5], "df_sol": 1, "dropna": [1, 4], "smi": [1, 2, 3], "tolist": [1, 2, 4], "y": [1, 2, 3, 4, 5], "to_numpi": [1, 2, 3, 4, 5, 6], "reshap": 1, "sol_datapoint": 1, "from_smi": 1, "zip": [1, 2, 3, 4], "shape": [1, 2, 3, 4, 5], "575": [1, 3, 4], "mol": [1, 2, 3], "chem": [1, 2, 3, 4, 5, 6], "rdchem": 1, "0x797c8982cdd0": 1, "arrai": [1, 2, 3, 5, 6], "9833561": 1, "gt_mask": 1, "none": [1, 2, 3, 4, 5], "lt_mask": 1, "x_d": 1, "x_phase": 1, "v_f": 1, "e_f": 1, "v_d": 1, "val": [1, 3, 4], "divid": [1, 3], "three": [1, 2, 4], "fold": [1, 5], "fit": [1, 2, 4, 5, 6], "monitor": 1, "progress": 1, "earli": 1, "kept": 1, "blind": 1, "until": [1, 3], "even": [1, 2], "though": 1, "scaffold": [1, 2], "often": [1, 2, 3], "better": [1, 2, 3], "chemistri": [1, 2, 4], "dp": 1, "train_list": 1, "val_list": 1, "test_list": 1, "make_split_indic": 1, "size": [1, 2, 3, 4, 5], "seed": [1, 5], "num_repl": 1, "train_dpss": 1, "val_dpss": 1, "test_dpss": 1, "split_data_by_indic": 1, "print": [1, 3, 4, 5, 6], "460": 1, "57": 1, "58": 1, "scale": [1, 2, 3, 4, 5], "A": [1, 2, 3, 5], "moleculedataset": 1, "wrap": 1, "chosen": [1, 2, 3], "simplemoleculemolgraphfeatur": 1, "turn": [1, 2, 4], "subtract": 1, "std": [1, 2, 4, 5, 6], "so": [1, 2, 3, 5], "smoothli": 1, "scaler": [1, 2, 3, 4], "allow": [1, 2], "u": [1, 2, 3, 4, 5], "unscal": 1, "feat": [1, 5], "train_set": [1, 5], "normalize_target": 1, "var": [1, 2], "val_set": 1, "test_set": 1, "peek": [1, 3, 4], "one": [1, 2, 3, 4, 5], "item": [1, 3, 4, 5, 6], "item0": 1, "type": [1, 3], "__name__": 1, "mg": 1, "e": [1, 2, 3, 4, 5], "datum": 1, "42734608": 1, "72": 1, "24": [1, 2, 6], "uncom": 1, "look": [1, 2], "dataload": [1, 5], "pytorch": 1, "shuffl": [1, 5], "epoch": [1, 5], "do": [1, 2, 3, 4, 5], "consist": 1, "batch": [1, 5], "automat": [1, 3], "pack": [1, 5], "togeth": [1, 3, 5], "mask": [1, 5], "intern": [1, 4], "train_load": [1, 5], "build_dataload": 1, "num_work": 1, "val_load": 1, "fals": [1, 2, 3, 4, 5], "test_load": 1, "torch": 1, "util": [1, 2, 3, 5], "0x797c8a4251f0": 1, "configur": 1, "small": [1, 2, 3, 5], "particular": [1, 3], "choos": [1, 2, 3, 4, 6], "defin": [1, 2, 3, 6], "how": [1, 2, 3, 4, 5], "assembl": 1, "them": [1, 2], "complet": [1, 2], "loop": [1, 2, 4], "checkpoint": 1, "held": 1, "out": [1, 4, 5], "qualiti": [1, 3], "mp": 1, "nn": [1, 2, 3, 5], "bondmessagepass": 1, "agg": [1, 3, 6], "meanaggreg": 1, "regressionffn": 1, "simpl": [1, 2, 3, 4, 5], "ffn": 1, "output_transform": 1, "unscaletransform": 1, "from_standard_scal": 1, "batch_norm": 1, "true": [1, 2, 3, 4, 5, 6], "metric": [1, 2, 3, 4, 5, 6], "rmse": [1, 4], "across": [1, 2], "form": [1, 2, 3], "other": [1, 2, 3, 4, 5], "possibl": 1, "forward": [1, 5], "attach": 1, "origin": [1, 2, 3, 5], "improv": [1, 5], "stabil": [1, 3, 5], "dure": [1, 2, 3, 6], "let": [1, 2, 3], "root": 1, "squar": [1, 3, 4], "error": 1, "absolut": [1, 2], "more": [1, 2, 3, 5], "sensit": 1, "onc": [1, 2], "full": [1, 2, 5], "lightn": 1, "hood": 1, "modelcheckpoint": 1, "callback": 1, "save": [1, 5], "best": [1, 3, 4, 6], "version": 1, "cpu": [1, 5], "gpu": 1, "acceler": 1, "auto": [1, 2, 3, 5, 6], "go": [1, 2], "feel": 1, "too": [1, 3], "long": 1, "demonstr": [1, 3], "practic": [1, 2, 4], "might": 1, "extend": [1, 2], "depend": [1, 2, 3], "converg": 1, "mpnn_sol": 1, "checkpoint_dir": 1, "path": [1, 5], "checkpoints_sol": 1, "mkdir": 1, "exist_ok": 1, "ckpt": 1, "pl": 1, "dirpath": 1, "filenam": 1, "val_loss": 1, "3f": [1, 2, 4, 5, 6], "mode": 1, "min": [1, 2, 4], "save_last": 1, "logger": 1, "enable_checkpoint": 1, "devic": [1, 5], "max_epoch": 1, "mannual": 1, "put": 1, "make": [1, 2, 3, 4, 5], "faster": 1, "info": 1, "pytorch_lightn": 1, "rank_zero": 1, "avail": [1, 2, 3, 4, 5], "tpu": 1, "core": [1, 2, 3, 4], "hpu": 1, "message_pass": 1, "w_i": 1, "linear": [1, 2, 3], "in_featur": 1, "out_featur": 1, "300": [1, 5], "bia": 1, "w_h": 1, "w_o": 1, "372": 1, "dropout": [1, 5], "p": [1, 2, 4, 5], "inplac": 1, "tau": [1, 5], "v_d_transform": 1, "ident": [1, 5], "graph_transform": 1, "bn": 1, "batchnorm1d": 1, "ep": [1, 3, 5], "momentum": 1, "affin": 1, "track_running_stat": 1, "mlp": [1, 5], "sequenti": [1, 5], "criterion": 1, "task_weight": 1, "x_d_transform": 1, "modulelist": 1, "At": [1, 5], "stage": 1, "pipelin": [1, 5], "know": [1, 2], "sinc": [1, 2, 3, 5], "iter": [1, 3], "over": [1, 4, 5], "see": [1, 2, 3, 4, 5], "underfit": 1, "overfit": 1, "expect": [1, 2, 5], "train_dataload": 1, "estim": 1, "param": [1, 5], "227": 1, "600": [1, 2], "318": 1, "trainabl": 1, "non": [1, 3], "total": [1, 4], "276": [1, 3], "mb": 1, "eval": [1, 5], "model_summari": 1, "50": [1, 2], "reach": [1, 3], "hold": 1, "far": [1, 2], "result": [1, 2, 3], "gather": 1, "import": [1, 2, 3, 4, 5, 6], "inference_mod": 1, "pred": [1, 4], "axi": [1, 2, 3, 4, 5, 6], "ravel": [1, 3], "y_true": 1, "plt": [1, 2, 3, 4, 5, 6], "scatter": [1, 2, 3, 4, 5, 6], "alpha": [1, 2, 3, 4, 5, 6], "ax": [1, 2, 3], "rang": [1, 2, 3, 4, 5, 6], "lim": [1, 4], "xlim": 1, "ylim": 1, "xlabel": [1, 2, 3, 4, 5, 6], "ylabel": [1, 2, 3, 4, 5, 6], "titl": [1, 2, 3, 4, 5, 6], "grid": [1, 2, 3, 5, 6], "show": [1, 2, 3, 4, 5, 6], "28014591336250305": 1, "4139021337032318": 1, "mpnn_sol_2": 1, "sumaggreg": 1, "retrain": 1, "compar": [1, 2, 3, 4, 5], "what": [1, 2], "df_tox": 1, "astyp": [1, 3, 4, 5], "tox_dp": 1, "tr_idx": 1, "va_idx": 1, "te_idx": 1, "tr": [1, 5], "va": [1, 3], "te": [1, 5], "tox_tr": 1, "tox_va": 1, "tox_t": 1, "binaryclassificationffn": 1, "n_task": 1, "mpnn_tox": 1, "tr_loader": 1, "va_load": 1, "te_load": 1, "trainer_tox": 1, "tip": [1, 2, 3], "seamless": 1, "cloud": [1, 3], "upload": 1, "instal": [1, 2, 3, 4], "litmodel": 1, "pypi": [1, 4], "org": 1, "project": [1, 2, 3], "enabl": 1, "litmodelcheckpoint": 1, "sync": 1, "registri": 1, "273": 1, "8639456033706665": 1, "probabl": [1, 2, 4], "pred_chunk": 1, "proba": [1, 5], "auc": [1, 5], "roc_auc_scor": [1, 5], "acc": [1, 5], "accuracy_scor": [1, 5], "f": [1, 2, 3, 4, 5, 6], "accuraci": [1, 5], "fpr": 1, "tpr": 1, "thr": 1, "roc_curv": 1, "lw": 1, "864": 1, "862": 1, "helper": [1, 2, 3], "posit": [1, 3, 4, 5], "multipl": 1, "pick_repres": 1, "df_po": 1, "df_pos_multi": 1, "df_neg": 1, "rep": [1, 5], "empti": 1, "append": [1, 2, 3, 4, 5, 6], "iloc": [1, 2, 5], "ani": [1, 2, 3, 4], "If": [1, 2, 3, 4, 5], "fewer": 1, "exist": [1, 3, 6], "just": [1, 2, 4], "_": [1, 4, 5], "reader": 1, "row_view": 1, "r": [1, 2, 3, 4, 5], "rep_tabl": 1, "nc1c": 1, "oc2ccccc2": 1, "cc": [1, 2], "c2c1c": 1, "c1ccccc1c2": 1, "draw": [1, 2, 3], "rdmoldraw2d": 1, "make_annotated_copi": 1, "site_list_1bas": 1, "tag_c123": 1, "m": [1, 2, 3, 4, 5, 6], "assignatomchiraltagsfromstructur": 1, "kekul": 1, "cleararomaticflag": 1, "getnumatom": 1, "highlight": [1, 2], "convert": [1, 2], "safe": [1, 2], "hi_atom": 1, "idx1": 1, "alwai": [1, 3], "annot": 1, "index": [1, 2, 4, 5], "getatomwithidx": 1, "old": 1, "getprop": 1, "atomnot": 1, "hasprop": 1, "add": [1, 2, 3, 4, 5], "star": [1, 3], "setprop": 1, "draw_exampl": 1, "mol_siz": 1, "320": 1, "280": 1, "legend": [1, 2, 3, 5, 6], "molfromsmil": [1, 2, 3, 4, 5, 6], "m_annot": 1, "lbl": 1, "img": [1, 2, 3], "lg": 1, "moltoimag": [1, 2], "highlightatom": 1, "imag": 1, "manual": [1, 2], "re": [1, 4, 5], "molstogridimag": [1, 2, 3], "molsperrow": [1, 2, 3], "subimgs": [1, 2, 3], "highlightatomlist": 1, "grid_img": 1, "mirror": [1, 4], "workflow": [1, 2, 3], "df_rxn": 1, "rxn_dp": 1, "rxn_tr": 1, "rxn_va": 1, "rxn_te": 1, "mpnn_rxn": 1, "trainer_rxn": 1, "958184003829956": 1, "ast": 1, "atoms_labels_from_smil": 1, "positive_idx": 1, "zero": [1, 2, 3, 4, 5, 6], "dtype": [1, 2, 3, 4, 5, 6], "float": [1, 2, 3, 4, 5, 6], "idx": [1, 2, 3, 5, 6], "molatombonddatapoint": 1, "sel_row": 1, "sel_dp": 1, "itertupl": 1, "atom_i": 1, "reorder_atom": 1, "hasattr": 1, "directli": [1, 2, 5], "fallback": 1, "loc": [1, 3, 6], "tr_set": 1, "molatombonddataset": 1, "va_set": 1, "te_set": 1, "batch_siz": [1, 5], "warn": [1, 2, 3, 4, 5], "drop": [1, 3, 5, 6], "avoid": [1, 3, 5], "issu": 1, "mabbondmessagepass": 1, "d_v": 1, "atom_fdim": 1, "d_e": 1, "bond_fdim": 1, "d_h": [1, 5], "depth": 1, "atom_predictor": 1, "model_sel": 1, "molatombondmpnn": 1, "mol_predictor": 1, "bond_predictor": 1, "binaryauroc": 1, "trainer_sel": 1, "322": 1, "metricss": 1, "413": 1, "654": 1, "atom_test": 1, "8670018315315247": 1, "grab": 1, "alreadi": [1, 2, 6], "give": [1, 2, 3], "single_d": 1, "get": [1, 2, 3, 4, 5], "its": [1, 3, 4, 5], "single_load": 1, "next": [1, 3, 4], "match": [1, 2, 4, 5], "collat": 1, "molgraphbatch": 1, "unpack": 1, "atom_logit": 1, "atom_prob": 1, "sigmoid": 1, "numpi": [1, 2, 3, 4, 5, 6], "align": [1, 2, 5], "m2": 1, "enumer": [1, 2, 3, 4, 6], "getatom": 1, "2f": [1, 3], "400": 1, "displai": [1, 2, 3, 6], "5000001": 1, "5000006": 1, "503788": 1, "5000002": 1, "7055641": 1, "50000006": 1, "abov": [1, 4], "section": [1, 2, 3], "ask": 1, "why": [1, 3], "find": [1, 2, 3], "substructur": [1, 2], "simplifi": 1, "mont": 1, "carlo": 1, "search": 1, "mct": 1, "extract": 1, "start": [1, 2, 3], "whole": 1, "systemat": 1, "remov": [1, 3, 5], "fragment": 1, "ring": [1, 2, 3], "check": [1, 3, 4, 5], "remain": [1, 2, 3, 5], "subgraph": 1, "candid": [1, 2, 4], "ones": 1, "still": [1, 5], "strongli": [1, 3], "interest": [1, 3], "smallest": [1, 3], "share": [1, 2], "dataclass": [1, 5], "field": 1, "callabl": 1, "tupl": 1, "union": [1, 2, 3], "math": [1, 2, 4], "ipython": 1, "make_predict": 1, "models_in": 1, "trainer_in": 1, "ndarrai": 1, "test_data": 1, "test_dset": 1, "pred_batch": 1, "tensor": [1, 5], "cat": [1, 5], "as_tensor": 1, "pb": 1, "dim": [1, 2, 3, 5], "compon": [1, 4], "tutori": 1, "safer": [1, 2], "handl": [1, 3], "mctsnode": 1, "children": 1, "default_factori": 1, "__post_init__": 1, "q": [1, 2, 4, 6], "c_puct": 1, "sqrt": [1, 2, 4], "find_clust": 1, "cluster": [1, 2, 6], "getbond": 1, "getbeginatomidx": 1, "getendatomidx": 1, "isinr": 1, "ssr": 1, "getsymmsssr": 1, "atom_cl": 1, "cl": 1, "extract_subgraph_from_mol": 1, "selected_atom": 1, "sel": 1, "nei": 1, "getidx": 1, "getneighbor": 1, "rw": 1, "rwmol": 1, "setatommapnum": 1, "aroma": 1, "getbondtyp": 1, "bondtyp": 1, "getbeginatom": 1, "getendatom": 1, "setisaromat": 1, "sort": [1, 4], "removeatom": 1, "getmol": 1, "extract_subgraph": 1, "mk": 1, "sub": 1, "moltosmil": 1, "kekulesmil": 1, "except": [1, 2, 3, 4, 5], "hassubstructmatch": 1, "mcts_rollout": 1, "state_map": 1, "orig_smil": 1, "nei_cl": 1, "scoring_fn": 1, "min_atom": 1, "cur": 1, "cur_cl": 1, "leaf_atom": 1, "new_atom": 1, "new_smi": 1, "score": [1, 2, 4], "child": 1, "sc": [1, 2], "totaln": 1, "nxt": [1, 4], "max": [1, 3, 4], "kei": [1, 2, 3, 4], "run_mcts_for_smil": 1, "rollout": 1, "max_atom": 1, "clusters_raw": 1, "atom_cls_raw": 1, "neigh": 1, "rat": 1, "cannot": [1, 3], "anyth": 1, "find_frag": 1, "frag": 1, "fragment_top1": 1, "cand": 1, "aset": 1, "sub_smi": 1, "dict": [1, 3], "fromkei": 1, "argmax": [1, 2, 4, 6], "visualize_rationale_on_par": 1, "parent_smi": 1, "rationale_smi": 1, "520": 1, "420": 1, "rm": 1, "invalid": [1, 2, 3], "getsubstructmatch": 1, "drawer": 1, "moldraw2dcairo": 1, "opt": [1, 5], "drawopt": 1, "attr": 1, "atomlabelfonts": 1, "fontsiz": [1, 2, 3, 6], "scalingfactor": 1, "setattr": 1, "prepareanddrawmolecul": 1, "finishdraw": 1, "png": 1, "getdrawingtext": 1, "becaus": [1, 2, 3], "done": 1, "standalon": 1, "mai": [1, 2, 3], "parent": 1, "\u03b4": 1, "much": [1, 2, 3], "tabl": [1, 2, 3, 4, 6], "rationale_0": 1, "react_prob": 1, "rationale_0_scor": 1, "rationale_0_delta": 1, "top": [1, 2, 3, 4, 5], "models_sol": 1, "must": 1, "prop_nam": 1, "scoring_fn_sol": 1, "smiles_list": 1, "summar": [1, 2], "sample_smi": 1, "t0": [1, 3], "awar": [1, 5], "60": 1, "highest": [1, 3], "r0": 1, "top1": [1, 4], "elaps": 1, "built": [1, 3], "solubility_rational": 1, "48": 1, "195756": 1, "c1c": 1, "ch": [1, 2, 4, 6], "co1": 1, "505139": 1, "719822": 1, "c1cc": 1, "771889": 1, "534268": 1, "092782": 1, "301932": 1, "ch3": 1, "297537": 1, "878732": 1, "318836": 1, "ch2": 1, "264910": 1, "092736": 1, "coc": 1, "250766": 1, "ccccn1cc2ccccc2c1": 1, "399117": 1, "nh": [1, 2], "487650": 1, "cccc1ccccc1": [1, 2], "500662": 1, "ccccccccocc1ccc": 1, "oc": 1, "cc1": [1, 2], "007931": 1, "ccocc1ccccc1": 1, "739935": 1, "12": [1, 2], "427984": 1, "cccc1": 1, "500649": 1, "037244": 1, "notna": 1, "5051385164260864": 1, "models_rxn": 1, "trainer_cl": 1, "scoring_fn_rxn": 1, "logit": [1, 5], "prob": [1, 4, 5], "outsid": [1, 2], "exp": [1, 2, 5], "sample_smis_rxn": 1, "rows_rxn": 1, "base_p": 1, "reactivity_rational": 1, "944441": 1, "916721": 1, "867228": 1, "841032": 1, "966502": 1, "960123": 1, "908582": 1, "825776": 1, "963128": 1, "877834": 1, "958719": 1, "876020": 1, "841456": 1, "945808": 1, "ccc": [1, 2], "916729": 1, "923266": 1, "920641": 1, "949148": 1, "906913": 1, "958145": 1, "955647": 1, "952870": 1, "9167211055755615": 1, "minim": [1, 2, 3], "write": 1, "reg_col": 1, "df_reg": 1, "disk": 1, "to_csv": [1, 5], "mp_data": 1, "common": [1, 2], "mp_model": 1, "num": 1, "replic": 1, "r2": [1, 4], "track": 1, "09": 1, "21t02": 1, "36": 1, "17": [1, 4], "arg": [1, 3, 4], "smiles_column": 1, "reaction_column": 1, "no_header_row": 1, "rxn_mode": 1, "reac_diff": 1, "multi_hot_atom_featurizer_mod": 1, "keep_h": 1, "add_h": 1, "ignore_stereo": 1, "molecule_featur": 1, "descriptors_path": 1, "descriptors_column": 1, "no_descriptor_sc": 1, "no_atom_feature_sc": 1, "no_atom_descriptor_sc": 1, "no_bond_feature_sc": 1, "no_bond_descriptor_sc": 1, "atom_features_path": 1, "atom_descriptors_path": 1, "bond_features_path": 1, "bond_descriptors_path": 1, "constraints_path": 1, "constraints_to_target": 1, "use_cuikmolmaker_featur": 1, "config_path": 1, "data_path": 1, "posixpath": 1, "output_dir": 1, "remove_checkpoint": 1, "freeze_encod": 1, "model_frzn": 1, "frzn_ffn_layer": 1, "from_found": 1, "ensemble_s": 1, "message_hidden_dim": 1, "message_bia": 1, "undirect": 1, "mpn_share": 1, "norm": [1, 2, 5], "aggregation_norm": 1, "atom_messag": 1, "activation_arg": 1, "ffn_hidden_dim": 1, "ffn_num_lay": 1, "multiclass_num_class": 1, "atom_task_weight": 1, "atom_ffn_hidden_dim": 1, "atom_ffn_num_lay": 1, "atom_multiclass_num_class": 1, "bond_task_weight": 1, "bond_ffn_hidden_dim": 1, "bond_ffn_num_lay": 1, "bond_multiclass_num_class": 1, "atom_constrainer_ffn_hidden_dim": 1, "atom_constrainer_ffn_num_lay": 1, "bond_constrainer_ffn_hidden_dim": 1, "bond_constrainer_ffn_num_lay": 1, "weight_column": 1, "target_column": 1, "mol_target_column": 1, "atom_target_column": 1, "bond_target_column": 1, "ignore_column": 1, "no_cach": 1, "splits_column": 1, "task_typ": 1, "loss_funct": 1, "v_kl": 1, "08": 1, "tracking_metr": 1, "show_individual_scor": 1, "warmup_epoch": 1, "init_lr": 1, "0001": 1, "max_lr": 1, "001": 1, "final_lr": 1, "patienc": 1, "grad_clip": 1, "class_bal": 1, "split_siz": 1, "split_key_molecul": 1, "num_fold": 1, "save_smiles_split": 1, "splits_fil": 1, "data_se": 1, "pytorch_se": 1, "wrote": 1, "config": 1, "file": [1, 4], "toml": 1, "pull": [1, 5], "ha": [1, 2, 3, 4], "split_0": 1, "statist": [1, 4], "nan": [1, 2, 3, 4, 5], "133": [1, 3], "dev": [1, 5], "51": 1, "median": [1, 2], "129": 1, "within": [1, 3], "75": 1, "123": [1, 5], "43": 1, "124": 1, "67": 1, "130": 1, "117": [1, 3], "79": 1, "93": 1, "13913042": 1, "15911504": 1, "cach": 1, "wa": 1, "specifi": 1, "default": [1, 2], "graphtransform": 1, "v_transform": 1, "e_transform": 1, "normaggreg": 1, "r2score": 1, "02": [1, 3, 5, 6], "19": [1, 2, 3], "170674": 1, "extern": 1, "local_xla": 1, "xla": 1, "stream_executor": 1, "cuda": [1, 5], "cuda_fft": 1, "467": 1, "unabl": 1, "regist": 1, "cufft": 1, "factori": 1, "attempt": 1, "plugin": 1, "absl": 1, "initializelog": 1, "written": 1, "stderr": 1, "e0000": 1, "1758422179": 1, "210367": 1, "58576": 1, "cuda_dnn": 1, "8579": 1, "cudnn": 1, "222474": 1, "cuda_bla": 1, "1407": 1, "cubla": 1, "w0000": 1, "251528": 1, "computation_plac": 1, "177": 1, "placer": 1, "pleas": [1, 2], "linkag": [1, 3, 6], "link": 1, "251595": 1, "251605": 1, "251613": 1, "259832": 1, "tensorflow": 1, "platform": 1, "cpu_feature_guard": 1, "210": 1, "instruct": 1, "perform": [1, 5], "critic": 1, "oper": 1, "To": [1, 2, 3, 5], "avx2": 1, "fma": 1, "rebuild": [1, 3, 4], "appropri": 1, "compil": 1, "flag": 1, "usr": 1, "lib": [1, 4], "python3": 1, "dist": [1, 2], "packag": [1, 4], "model_checkpoint": 1, "py": [1, 4], "751": 1, "directori": 1, "model_0": 1, "fit_loop": 1, "310": 1, "smaller": [1, 2, 3, 5], "interv": 1, "log_every_n_step": 1, "want": [1, 2, 3, 5], "363": 1, "skip": [1, 2, 3], "paramet": [1, 5], "dump": 1, "yaml": 1, "01": [1, 5], "54it": 1, "v_num": 1, "train_loss_step": 1, "551": 1, "31it": 1, "80it": 1, "150": 1, "797": 1, "train_loss_epoch": 1, "986": 1, "24it": 1, "85it": 1, "346": 1, "800": 1, "898": 1, "55it": 1, "86it": 1, "496": 1, "766": 1, "821": 1, "17it": 1, "481": 1, "651": 1, "757": 1, "50it": 1, "83it": 1, "368": 1, "709": 1, "718": 1, "00it": 1, "88it": 1, "544": 1, "540": 1, "605": 1, "23it": 1, "59it": 1, "953": 1, "487": 1, "582": 1, "82it": 1, "650": 1, "631": 1, "564": 1, "69it": 1, "39it": 1, "360": 1, "472": 1, "494": 1, "47it": 1, "92it": 1, "527": 1, "37it": 1, "77it": 1, "214": 1, "422": 1, "424": 1, "64it": 1, "87it": 1, "253": 1, "436": 1, "385": 1, "470": 1, "371": [1, 3], "56it": 1, "608": 1, "323": 1, "338": 1, "19it": 1, "01it": 1, "187": 1, "376": 1, "326": 1, "43it": 1, "98it": 1, "254": 1, "301": 1, "99it": 1, "292": 1, "325": [1, 3], "288": 1, "84it": 1, "05it": 1, "365": [1, 3], "267": 1, "34it": 1, "197": 1, "279": 1, "246": 1, "73it": 1, "189": 1, "255": 1, "249": 1, "63it": 1, "263": [1, 3], "268": 1, "76it": 1, "22": [1, 6], "68it": 1, "206": [1, 3, 4], "375": 1, "216": 1, "12it": 1, "78it": 1, "242": 1, "235": 1, "89it": 1, "287": 1, "232": 1, "215": 1, "97it": 1, "0736": 1, "207": 1, "53it": 1, "166": [1, 3, 4], "309": 1, "226": 1, "26it": 1, "03it": 1, "0895": 1, "278": 1, "52it": 1, "0522": 1, "233": 1, "194": 1, "79it": 1, "29": 1, "36it": 1, "290": 1, "224": 1, "178": [1, 3, 4], "250": [1, 2, 3], "219": 1, "173": 1, "35it": 1, "31": 1, "94it": 1, "137": 1, "240": 1, "198": 1, "32": [1, 2, 3, 5], "247": 1, "186": 1, "40it": 1, "33": 1, "180": 1, "34": 1, "217": [1, 3], "15it": 1, "35": [1, 2], "02it": 1, "311": [1, 3], "256": [1, 5], "159": 1, "201": 1, "222": 1, "160": 1, "57it": 1, "37": [1, 3], "0628": 1, "221": 1, "163": 1, "96it": 1, "38": 1, "153": 1, "237": 1, "39": 1, "27it": 1, "191": 1, "243": 1, "164": 1, "81it": 1, "399": 1, "248": 1, "155": 1, "16it": 1, "165": 1, "60it": 1, "42": [1, 2, 3, 4], "154": [1, 3], "218": 1, "156": 1, "286": 1, "61it": 1, "44": 1, "0866": 1, "231": 1, "45": [1, 5], "67it": 1, "265": 1, "152": 1, "46": 1, "95it": 1, "0487": 1, "47": 1, "170": [1, 3], "149": 1, "148": 1, "234": 1, "49": 1, "32it": 1, "143": 1, "45it": 1, "102": 1, "258": 1, "142": 1, "132": [1, 3, 4], "65it": 1, "52": 1, "90it": 1, "114": 1, "220": [1, 2], "53": 1, "115": 1, "223": [1, 3, 4], "144": 1, "54": 1, "0449": 1, "75it": 1, "55": 1, "230": 1, "141": 1, "56": 1, "140": [1, 3], "10it": 1, "139": 1, "59": 1, "174": [1, 3], "44it": 1, "168": [1, 3], "138": 1, "0818": 1, "62": 1, "162": 1, "229": 1, "135": [1, 3], "63": [1, 3], "0715": 1, "134": [1, 3, 4], "128": [1, 3, 5], "136": 1, "58it": 1, "225": [1, 2], "93it": 1, "118": 1, "131": 1, "68": 1, "161": [1, 3], "46it": 1, "208": 1, "241": 1, "70": 1, "29it": 1, "66it": 1, "239": 1, "25it": 1, "284": [1, 3], "28it": 1, "76": 1, "0589": 1, "77": 1, "099": 1, "78": 1, "0862": 1, "116": 1, "238": 1, "127": 1, "81": [1, 3], "228": 1, "07it": 1, "0917": 1, "84": 1, "70it": 1, "20it": 1, "85": [1, 6], "126": [1, 3], "30it": 1, "125": 1, "88": 1, "49it": 1, "89": 1, "74it": 1, "0796": 1, "0883": 1, "92": [1, 3], "94": 1, "0656": 1, "95": [1, 3, 4], "106": [1, 3], "98": [1, 3], "18it": 1, "99": [1, 3], "connector": 1, "checkpoint_connector": 1, "ckpt_path": 1, "silenc": 1, "restor": 1, "val_r2": 1, "21it": 1, "6578369140625": 1, "868921279907227": 1, "826757027488992": 1, "pt": 1, "co": [1, 2], "ccccccccc": 1, "ccn": 1, "custom_smiles_reg": 1, "mp_pred": 1, "test_path": 1, "drop_extra_column": 1, "model_path": 1, "cal_path": 1, "uncertainty_method": 1, "calibration_method": 1, "evaluation_method": 1, "uncertainty_dropout_p": 1, "dropout_sampling_s": 1, "calibration_interval_percentil": 1, "conformal_alpha": 1, "cal_descriptors_path": 1, "cal_atom_features_path": 1, "cal_atom_descriptors_path": 1, "cal_bond_features_path": 1, "cal_bond_descriptors_path": 1, "cal_constraints_path": 1, "238464": 1, "600280": 1, "757965": 1, "074980": 1, "reactivity_bin": 1, "replac": [1, 4, 5], "reactivity_data_bin": 1, "saniti": 1, "balanc": [1, 2], "value_count": [1, 3], "to_dict": [1, 3], "264": [1, 3], "short": [1, 4, 5], "reactivity_model": 1, "prc": 1, "percent": 1, "205": 1, "bceloss": 1, "binaryauprc": 1, "binaryaccuraci": 1, "974383": 1, "1758421816": 1, "001418": 1, "57061": 1, "009690": 1, "031522": 1, "031593": 1, "031602": 1, "031610": 1, "037344": 1, "687": 1, "595": 1, "685": 1, "689": 1, "91it": 1, "512": 1, "656": 1, "38it": 1, "473": 1, "536": 1, "433": 1, "603": 1, "504": 1, "266": 1, "573": 1, "443": 1, "408": 1, "532": 1, "434": 1, "652": 1, "526": [1, 3], "405": 1, "306": 1, "515": 1, "387": 1, "13it": 1, "373": 1, "06it": 1, "479": 1, "367": 1, "358": 1, "291": 1, "461": 1, "349": 1, "48it": 1, "295": 1, "454": 1, "343": 1, "448": 1, "339": 1, "439": 1, "329": [1, 3], "val_roc": 1, "9510154724121094": 1, "9459617137908936": 1, "8793103694915771": 1, "cco": [1, 2], "c1ccccc1c": 1, "2c": 1, "c2": [1, 3], "c1cccc": 1, "custom_smil": 1, "custom_pr": 1, "192": 1, "588819": 1, "690307": 1, "899083": 1, "461047": 1, "745579": 1, "628841": 1, "ignor": [1, 2, 3, 4, 5], "mix": 1, "learnabl": 1, "encod": 1, "focu": [1, 2], "combin": [1, 2], "own": [1, 3, 4], "readout": 1, "compress": [1, 2], "destin": 1, "librari": 1, "independ": [1, 5], "ensembl": 1, "compens": 1, "skew": 1, "proport": 1, "least": [1, 3], "choic": [1, 5], "TO": [1, 2, 3, 4], "toxicity_bin": 1, "tox_data": 1, "mp_model_q4": 1, "c1ccccc1": [1, 2], "q4_smile": 1, "replicate_0": 1, "q4_pred": 1, "tox_model": 1, "clccl": 1, "q5_smile": 1, "q5_pred": 1, "understand": [2, 3], "explain": [2, 4, 6], "intuit": [2, 3], "varianc": [2, 3, 4, 5, 6], "emb": [2, 3], "high": [2, 3, 5], "dimension": [2, 3], "2d": [2, 3, 4, 5, 6], "reus": [2, 5, 6], "c": [2, 3, 4, 6], "h": [2, 3, 4, 5], "oxid": [2, 3, 4], "dataset": [2, 3, 4], "6cda9aa": 2, "0929": 2, "tag": 2, "hide": [2, 4], "matplotlib": [2, 3, 4, 5, 6], "pyplot": [2, 3, 4, 5, 6], "sklearn": [2, 3, 4, 5, 6], "preprocess": [2, 3, 4, 5, 6], "standardscal": [2, 3, 4, 5, 6], "decomposit": [2, 3, 4, 5, 6], "manifold": [2, 3, 5, 6], "tsne": [2, 3, 5, 6], "kmean": [2, 6], "agglomerativeclust": [2, 3, 6], "dbscan": [2, 6], "silhouette_scor": [2, 3, 6], "silhouette_sampl": [2, 3], "pairwise_dist": [2, 3, 6], "umap_": 2, "pip": [2, 3, 4], "filterwarn": [2, 3, 4, 5], "crippen": [2, 3, 4, 5, 6], "rdmoldescriptor": [2, 3, 4, 5, 6], "rd": [2, 3, 5], "line": [2, 4, 6], "syntaxerror": 2, "syntax": 2, "quick": [2, 3, 4, 5], "everyon": 2, "did": [2, 3], "previous": 2, "onli": [2, 3, 5], "anoth": [2, 3], "calc_descriptor": 2, "seri": [2, 3, 4, 5, 6], "molwt": [2, 3, 5, 6], "logp": [2, 3, 4, 5, 6], "tpsa": [2, 3, 4, 5, 6], "numr": [2, 3, 4, 5, 6], "mollogp": [2, 3, 4, 5, 6], "calctpsa": [2, 3, 4, 5, 6], "calcnumr": [2, 3, 4, 5, 6], "calc_descriptors10": [2, 3, 4, 6], "numhacceptor": [2, 4, 6], "calcnumhba": [2, 4, 6], "numhdonor": [2, 4, 6], "calcnumhbd": [2, 4, 6], "numrotatablebond": [2, 4, 6], "calcnumrotatablebond": [2, 4, 6], "heavyatomcount": [2, 4, 6], "fix": [2, 4, 5], "fractioncsp3": [2, 4, 6], "calcfractioncsp3": [2, 4, 6], "numaromaticr": [2, 4, 6], "calcnumaromaticr": [2, 4, 6], "usag": 2, "desc4": 2, "desc10": [2, 4, 6], "df4": 2, "concat": [2, 3, 4, 5, 6], "df10": [2, 4, 6], "col": [2, 3, 4, 6], "desc": [2, 3, 4, 5], "bit": [2, 3, 5, 6], "rdfingerprintgener": [2, 3, 4, 5], "datastruct": [2, 3, 4, 5, 6], "morgan_bit": [2, 3, 4, 5, 6], "n_bit": [2, 3, 4, 5, 6], "radiu": [2, 3, 4, 5, 6], "gen": [2, 3, 4, 5], "getmorgangener": [2, 3, 4, 5], "fpsize": [2, 3, 4, 5], "fp": [2, 3, 4, 5, 6], "getfingerprint": [2, 3, 4, 5], "arr": [2, 3, 4, 5, 6], "converttonumpyarrai": [2, 3, 4, 5], "join": [2, 4], "0101": 2, "1024bit": 2, "df_morgan_1024": 2, "1024": 2, "df_morgan": 2, "x_small": 2, "good": [2, 3], "stori": 2, "x_fp": [2, 3, 6], "veri": [2, 3], "4d": 2, "10d": [2, 6], "64d": 2, "pick": [2, 4], "sample_indic": 2, "sure": 2, "readi": 2, "df_all": 2, "add_prefix": 2, "d10_": 2, "through": [2, 5], "d4": 2, "round": [2, 3, 4, 5, 6], "d10_kei": 2, "d10": 2, "easi": 2, "presenc": 2, "absenc": 2, "neighborhood": 2, "With": [2, 5], "desciptor": 2, "easier": 2, "mpl_toolkit": 2, "mplot3d": 2, "axes3d": 2, "specif": 2, "df_sel": 2, "3d": 2, "fig": [2, 3], "figur": [2, 3, 5, 6], "figsiz": [2, 3, 6], "add_subplot": 2, "111": 2, "cmap": 2, "viridi": 2, "iterrow": 2, "shift": 2, "overlap": [2, 3], "right": [2, 3, 5], "set_xlabel": 2, "set_ylabel": [2, 3], "set_zlabel": 2, "colorbar": 2, "entir": 2, "4th": 2, "And": 2, "xyz": 2, "color_dim": 2, "axes_dim": 2, "d": [2, 3, 4, 5], "xcol": 2, "ycol": 2, "zcol": 2, "cividi": 2, "set_titl": [2, 3], "color": [2, 3, 4, 5, 6], "horizont": 2, "subplot": [2, 3], "cbar": 2, "orient": 2, "pad": [2, 3], "shrink": 2, "set_label": 2, "suptitl": [2, 3], "permut": 2, "tight_layout": [2, 3, 6], "But": [2, 3], "come": 2, "someth": 2, "nearli": 2, "imposs": 2, "becom": 2, "harder": 2, "neigbor": 2, "human": 2, "grasp": 2, "beyond": [2, 3], "pair": 2, "relationship": [2, 4], "quickli": [2, 5], "hard": 2, "character": 2, "seaborn": 2, "sn": 2, "sharex": 2, "scatterplot": 2, "g": [2, 3, 6], "expand": [2, 3], "integ": [2, 5], "fp_matrix": 2, "fp_df": 2, "heatmap": 2, "grei": 2, "That": [2, 3, 4], "cheminformat": 2, "usual": 2, "visualiz": 2, "todai": [2, 3], "switch": 2, "mathbb": [2, 5], "coordin": [2, 5], "ll": 2, "group": [2, 3, 6], "sampl": [2, 4, 5], "similar": [2, 3, 5], "rule": 2, "again": 2, "toxic": [2, 3, 4], "algorithm": [2, 3], "melt": [2, 3, 4], "downstream": [2, 5], "scalar": [2, 5], "macc": 2, "those": 2, "move": 2, "direct": [2, 5], "address": 2, "challeng": 2, "greatest": 2, "These": 2, "orthogon": 2, "uncorrel": 2, "rank": 2, "pc1": [2, 3, 4, 5, 6], "pc2": [2, 3, 4, 5, 6], "second": 2, "mathemat": [2, 3], "piec": 2, "tild": [2, 5], "covari": 2, "matrix": [2, 3, 4, 5, 6], "either": [2, 3], "eigen": 2, "decompos": 2, "eigenvector": 2, "Or": 2, "svd": 2, "v_k": 2, "contain": [2, 4], "thei": [2, 3], "hundr": 2, "fairli": 2, "Then": [2, 3, 5], "pc3": 2, "approach": 2, "2048": 2, "reduc": [2, 3, 5], "down": [2, 3], "matric": 2, "x_desc": [2, 3, 6], "x_morgan": 2, "x_desc_std": [2, 6], "fit_transform": [2, 3, 5, 6], "x_morgan_std": 2, "pca_desc": 2, "pca_morgan": 2, "scree": 2, "cumsum": [2, 4, 6], "explained_variance_ratio_": [2, 4, 6], "marker": [2, 3, 5, 6], "pc": [2, 4, 6], "cumul": [2, 4, 6], "desc_2d": 2, "morgan_2d": 2, "blue": [2, 5, 6], "green": [2, 6], "desc_3d": 2, "morgan_3d": 2, "ax1": 2, "121": 2, "ax2": 2, "122": [2, 3], "essenc": 2, "space": [2, 3, 4, 5], "concret": 2, "closest": [2, 3], "accord": [2, 3], "farthest": 2, "dissimilar": 2, "connect": [2, 3], "itertool": [2, 3], "n_compon": [2, 3, 5, 6], "x_pca": 2, "linalg": 2, "argmin": 2, "manual_pair": 2, "pairs_to_show": 2, "red": [2, 3, 5], "edgecolor": [2, 3], "black": [2, 3], "interact": 2, "plotli": 2, "px": 2, "desc_col": [2, 4, 6], "df_pca": 2, "custom": 2, "hover_data": 2, "width": 2, "1200": 2, "height": 2, "wide": [2, 3], "tall": 2, "happen": 2, "mistak": 2, "influenc": 2, "leak": 2, "pattern": [2, 3, 4], "train": [2, 4], "subset": [2, 4], "truli": 2, "unseen": 2, "model_select": [2, 4, 5], "train_test_split": [2, 4], "x_train": 2, "x_test": 2, "test_siz": [2, 4], "random_st": [2, 3, 4, 5, 6], "x_train_std": 2, "x_test_std": 2, "x_train_pca": 2, "x_test_pca": 2, "purpl": 2, "orang": [2, 6], "reason": [2, 3], "sign": 2, "deriv": 2, "lie": 2, "could": 2, "didn": 2, "well": [2, 3], "pure": 2, "case": 2, "risk": 2, "afterward": 2, "disciplin": 2, "cover": 2, "live": 2, "euclidean": [2, 3, 4, 6], "domin": [2, 3], "center": [2, 3], "minmaxscal": 2, "rescal": 2, "bound": [2, 4, 5], "robustscal": 2, "iqr": 2, "outlier": 2, "cols2": 2, "x2": [2, 5], "x2_std": 2, "ddof": 2, "cosin": [2, 5], "focus": 2, "rather": [2, 3], "magnitud": 2, "overal": 2, "vari": [2, 3], "lot": 2, "1024d": 2, "tanimoto": [2, 3, 6], "informat": 2, "bitset": 2, "equat": 2, "x_i": [2, 3, 5], "x_j": [2, 5], "d_": [2, 3], "euc": 2, "left": [2, 3, 5, 6], "_2": 2, "ik": 2, "jk": 2, "minu": 2, "lvert": 2, "rvert_2": 2, "b_i": 2, "b_j": 2, "s_": [2, 3], "tan": [2, 3], "cap": [2, 3], "clear": 2, "demo": 2, "tini": [2, 4, 5], "readabl": 2, "xsmall": 2, "pairwis": [2, 4], "d_eu": [2, 6], "d_co": 2, "side": 2, "im0": 2, "imshow": 2, "aspect": 2, "fraction": [2, 5], "046": 2, "04": [2, 3], "im1": 2, "eu_nn": 2, "argsort": [2, 3, 6], "co_nn": 2, "queri": [2, 6], "care": 2, "about": 2, "offset": 2, "fp_string": 2, "fp_string_to_bitvect": 2, "fp_str": [2, 6], "bv": [2, 6], "explicitbitvect": [2, 6], "setbit": [2, 6], "bulktanimotosimilar": [2, 6], "d_tan": [2, 6], "im": 2, "nn_tan": 2, "strong": 2, "reflect": 2, "kind": 2, "calcul": 2, "bitvec": 2, "fp_bv": 2, "xfp": 2, "s_tani": 2, "d_tani": 2, "ham": 2, "stabl": 2, "exclud": [2, 5], "topk_neighbor": 2, "mergesort": 2, "196": 2, "nn_tani": 2, "nn_co": 2, "nn_eu": 2, "panel": 2, "coord": 2, "lightgrei": 2, "tab": [2, 6], "knn": 2, "found": 2, "q_name": 2, "q_smile": 2, "q_mol": 2, "tanimoto_r": 2, "cosine_r": 2, "euclidean_r": 2, "add_neighbor": 2, "metric_nam": 2, "nn_idx": 2, "col_mol": 2, "col_leg": 2, "nidx": 2, "m_tani": 2, "l_tani": 2, "m_co": 2, "l_co": 2, "m_eu": 2, "l_eu": 2, "interleav": 2, "tani": 2, "euclid": 2, "fast": 2, "global": 2, "curv": [2, 3, 5], "heavi": 2, "reveal": 2, "notion": 2, "layout": [2, 3], "tri": [2, 5], "close": [2, 5], "sai": 2, "low": [2, 3, 4, 5], "gaussian": [2, 5], "kernel": 2, "p_": 2, "mid": 2, "rvert": 2, "sigma_i": 2, "ne": 2, "x_k": 2, "quad": [2, 5], "perplex": [2, 3, 5, 6], "user": [2, 4], "roughli": [2, 3], "effect": 2, "symmetr": [2, 5], "ij": 2, "2n": 2, "tail": 2, "q_": 2, "y_j": 2, "ell": [2, 5], "y_k": 2, "y_": 2, "kullback": 2, "leibler": 2, "diverg": 2, "operatornam": [2, 5], "kl": 2, "parallel": 2, "500": [2, 3], "speed": 2, "x_fp_50": 2, "tsne_desc": [2, 6], "learning_r": [2, 3, 5, 6], "init": [2, 3, 5, 6], "n_iter": [2, 6], "1000": [2, 6], "y_desc": [2, 6], "tsne_fp": [2, 6], "y_fp": [2, 6], "fuzzi": 2, "preserv": [2, 5], "exactli": [2, 3], "signific": 2, "membership": 2, "mu_": 2, "differenti": 2, "likelihood": [2, 4], "control": [2, 5], "spread": 2, "min_dist": [2, 3], "n_neighbor": [2, 3], "fine": 2, "detail": 2, "larger": [2, 5], "tight": 2, "tighter": 2, "blob": [2, 3], "place": 2, "jaccard": [2, 3], "term": 2, "coars": 2, "higher": [2, 3], "distort": 2, "separ": [2, 3, 5], "clearli": 2, "tend": 2, "rel": [2, 5], "decid": [2, 3, 4], "famili": 2, "plan": 2, "great": 2, "domain": 2, "knowledg": 2, "correct": 2, "pictur": 2, "maximum": [2, 3], "bar": 2, "ratio": 2, "scenario": 2, "screen": 2, "bio": 2, "inhibitor": 2, "chemotyp": 2, "view": 2, "assai": 2, "mol_record": 2, "hydrophob": 2, "toluen": 2, "a_hydrophobic_aromat": [2, 6], "propylbenzen": 2, "xylen": 2, "cc1ccc": 2, "cumen": 2, "mesitylen": 2, "cc1cc": 2, "isobutylbenzen": 2, "polar": 2, "alcohol": 2, "acid": 2, "acet": 2, "b_polar_alc_acid": [2, 6], "propion": 2, "butano": 2, "cccc": 2, "ethanol": 2, "propanol": 2, "ccco": 2, "butanol": 2, "cccco": 2, "ethylen": 2, "glycol": 2, "occo": 2, "hetero": 2, "amin": 2, "pyridin": 2, "n1ccccc1": 2, "c_n_hetero_amin": [2, 6], "anilin": 2, "nc1ccccc1": 2, "dimethylanilin": 2, "cn": 2, "imidazol": 2, "c1ncc": 2, "morpholin": 2, "o1ccncc1": 2, "piperidin": 2, "df_20": [2, 6], "df_fp_20": [2, 6], "itself": 2, "respect": 2, "justifi": 3, "distanc": [3, 4], "fingerprint": [3, 4, 6], "pca": [3, 5, 6], "adjusted_rand_scor": 3, "normalized_mutual_info_scor": 3, "allchem": 3, "guard": [3, 5], "have_umap": 3, "compact": [3, 4, 5], "calc_desc4": [3, 5], "reactiv": [3, 4], "later": [3, 5], "fp_bit": [3, 5], "fp_mat": 3, "vstack": [3, 5], "tidi": 3, "cols_x": 3, "frame": 3, "reset_index": [3, 5, 6], "fp_": [3, 5], "fp_0": 3, "fp_1": 3, "fp_2": 3, "fp_118": 3, "fp_119": 3, "fp_120": 3, "fp_121": 3, "fp_122": 3, "fp_123": 3, "fp_124": 3, "fp_125": 3, "fp_126": 3, "fp_127": 3, "7593": [3, 4], "2578": [3, 4], "5654": [3, 4], "2490": 3, "146": 3, "1166": 3, "standard": [3, 4, 5, 6], "block": [3, 5], "startswith": 3, "y_reac": 3, "medium": 3, "9608755": 3, "73344493": 3, "77292513": 3, "18998544": 3, "61504052": 3, "1485916": 3, "07637154": 3, "49277473": 3, "chemist": 3, "prefer": 3, "preview": [3, 6], "simplest": 3, "baselin": [3, 4], "nearest": 3, "c_j": 3, "min_j": 3, "s_j": 3, "process": 3, "repeat": [3, 4, 5], "wcss": 3, "min_": 3, "c_1": 3, "dot": 3, "c_k": 3, "affect": 3, "n_cluster": [3, 6], "n_init": [3, 6], "labels_km": 3, "labels_": [3, 6], "sort_index": 3, "353": 3, "int64": [3, 5], "plane": [3, 6], "uniqu": [3, 6], "invers": 3, "centroids_std": 3, "cluster_centers_": 3, "centroids_orig": 3, "inverse_transform": [3, 4], "cent_tab": 3, "155421": 3, "928251": 3, "210000": 3, "126984": 3, "262": 3, "400417": 3, "721370": 3, "844167": 3, "562500": 3, "739895": 3, "668183": 3, "575467": 3, "541076": 3, "centroid": 3, "cent_pca": 3, "sometim": [3, 5], "methoxymethylbenzen": 3, "16699999999996": 3, "8330000000000002": 3, "091": 3, "773": 3, "873": 3, "embed_descriptor": 3, "use_umap": 3, "z_desc": [3, 6], "name_desc": 3, "embed": [3, 5, 6], "km_desc": 3, "labs_desc": 3, "pick_two_per_clust": 3, "show_molecul": 3, "smiles_col": 3, "names_col": 3, "returnpng": 3, "picks_desc": 3, "ndescriptor": [3, 6], "linewidth": 3, "bbox_to_anchor": [3, 6], "upper": [3, 6], "c0": 3, "descritor": 3, "cup": 3, "s_t": 3, "embed_fingerprint": 3, "x_bits_bool": 3, "d_jac": 3, "precomput": 3, "x_fp_bool": 3, "bool": [3, 5], "z_fp": 3, "name_fp": 3, "km_fp": 3, "labs_fp": 3, "picks_fp": 3, "nfingerprint": [3, 6], "central": 3, "distinct": 3, "forc": [3, 5], "natur": 3, "unnecessarili": 3, "denot": 3, "w_k": 3, "increas": [3, 4, 5], "decreas": 3, "rate": [3, 4], "slow": 3, "mark": 3, "trade": 3, "off": 3, "ad": 3, "yield": [3, 5], "littl": 3, "gain": 3, "inertia": [3, 6], "kk": 3, "km": [3, 6], "inertia_": [3, 6], "measur": [3, 5], "averag": 3, "intra": 3, "minimum": 3, "approx": 3, "closer": 3, "boundari": 3, "misclassifi": 3, "home": 3, "messga": 3, "sil": 3, "296": 3, "plot_silhouett": 3, "s_sort": 3, "lbl_sort": 3, "y0": 3, "y1": 3, "barh": 3, "arang": [3, 4, 5], "axvlin": 3, "linestyl": [3, 4], "calcuat": 3, "assum": [3, 6], "spheric": 3, "real": 3, "explor": 3, "adapt": 3, "hierarch": 3, "predefin": 3, "treat": [3, 4], "merg": 3, "repeatedli": 3, "definit": 3, "caus": 3, "formal": 3, "reassign": 3, "lab_agg": 3, "fit_predict": [3, 6], "nuniqu": 3, "ari": 3, "nmi": 3, "018": 3, "075": 3, "unlik": 3, "densiti": 3, "spatial": 3, "applic": 3, "nois": [3, 5], "advanc": 3, "spars": 3, "min_sampl": 3, "varepsilon": 3, "epsilon": [3, 5], "outward": 3, "reachabl": 3, "moon": 3, "explicitli": 3, "everi": 3, "db": 3, "lab_db": 3, "return_count": 3, "tune": [3, 5], "scan": 3, "eps_grid": 3, "n_nois": 3, "n_clu": 3, "567": 3, "cycl": 3, "islic": 3, "make_moon": 3, "make_circl": 3, "make_blob": 3, "kneighbors_graph": 3, "toi": 3, "n_sampl": 3, "1500": 3, "rng_seed": 3, "noisy_circl": 3, "factor": [3, 5], "noisy_moon": 3, "anisotrop": 3, "x_aniso": 3, "y_aniso": 3, "aniso": 3, "cluster_std": 3, "randomst": [3, 4], "no_structur": 3, "rand": 3, "varied_blob": 3, "aniso_blob": 3, "base_color": 3, "1f77b4": 3, "ff7f0e": 3, "2ca02c": 3, "d62728": 3, "9467bd": 3, "8c564b": 3, "e377c2": 3, "7f7f7f": 3, "bcbd22": 3, "colors_for_label": 3, "y_pred": 3, "noise_color": 3, "000000": 3, "asarrai": 3, "po": [3, 4, 5], "n_label": 3, "palett": 3, "clip": 3, "safe_silhouett": 3, "otherwis": 3, "uniq": 3, "1e9": 3, "produc": [3, 5], "select_kmean": 3, "k_rang": 3, "fit_tim": 3, "fit_t": 3, "select_ward": 3, "encourag": [3, 5], "include_self": 3, "select_dbscan": 3, "min_samples_grid": 3, "given": 3, "linspac": 3, "n_row": 3, "n_col": 3, "subplots_adjust": 3, "bottom": 3, "wspace": 3, "07": 3, "hspace": 3, "col_titl": 3, "plot_idx": 3, "row_i": 3, "ds_name": 3, "fair": 3, "catch_warn": 3, "simplefilt": 3, "best_km": 3, "set_xtick": 3, "set_ytick": 3, "transax": 3, "bbox": 3, "boxstyl": 3, "facecolor": 3, "best_wd": 3, "best_db": 3, "nsil": 3, "galleri": 3, "enough": 3, "don": 3, "belong": 3, "dens": 3, "region": 3, "heurist": 3, "diminish": 3, "bad": 3, "chemoinformat": 3, "hint": 3, "forget": 3, "solut": 3, "refit": 3, "sy": [4, 5], "subprocess": 4, "simpleimput": 4, "linear_model": [4, 5], "linearregress": 4, "r2_score": 4, "mean_squared_error": 4, "cosine_similar": 4, "miss": [4, 5], "check_cal": 4, "bitstr": [4, 6], "morgan": [4, 5, 6], "333333": 4, "076923": 4, "400000": 4, "light": [4, 5], "experiment": 4, "intermedi": 4, "randomli": [4, 5], "x_desc_al": 4, "col_scor": 4, "x_tr": 4, "x_te": 4, "y_tr": 4, "y_te": 4, "x_trm": 4, "x_tem": 4, "imp": 4, "strategi": 4, "x_trf": 4, "x_tef": 4, "x_tr_use": 4, "delet": 4, "x_te_us": 4, "reg": 4, "y_hat": 4, "sort_valu": 4, "ascend": 4, "indexerror": 4, "__array_function__": 4, "kwarg": 4, "52377": 4, "appdata": 4, "program": 4, "python38": 4, "function_bas": 4, "5211": 4, "obj": 4, "5208": 4, "single_valu": 4, "5209": 4, "5210": 4, "5212": 4, "5213": 4, "5214": 4, "5215": 4, "rest": 4, "signal": 4, "redund": 4, "pariti": 4, "best_col": 4, "less": 4, "weaker": 4, "comment": 4, "gram": 4, "token": 4, "pretrain": 4, "collect": [4, 5], "counter": 4, "all_text": 4, "char": 4, "trigram": 4, "defaultdict": 4, "s2": 4, "smooth": 4, "vocab_plu": 4, "context_prob": 4, "sequenc": 4, "sequence_nl": 4, "nll": 4, "ctx": 4, "suggest": 4, "topk_next": 4, "pr": 4, "sample_smil": 4, "rng": [4, 5], "max_len": 4, "120": 4, "cum": 4, "searchsort": 4, "goal": [4, 5], "teach": 4, "appear": 4, "guess": 4, "decod": 4, "studi": 4, "reconstruct": 4, "xz": 4, "evr": [4, 6], "ge": 4, "xz_hat": 4, "components_": 4, "x_hat": 4, "recon": 4, "col_rms": 4, "per_mol_err": 4, "describ": 4, "hist": [4, 5], "bin": [4, 5], "recomput": 4, "hardest": 4, "trend": 4, "noisi": 4, "xz_noisi": 4, "row_argmax": 4, "princip": 4, "z2": [4, 5], "refer": 4, "ridge_scor": 4, "rr": 4, "weak_col": 4, "molwt_t": 4, "axhlin": 4, "mean_nll_n4": 4, "masked_hit_at_5": 4, "randint": 4, "true_char": 4, "hit_at_5": 4, "z3": 4, "xz_hat3": 4, "x_hat3": 4, "recon3": 4, "rmse3": 4, "per_mol_err3": 4, "euclidean_dist": 4, "top1_rate_cosin": 4, "std_nois": 4, "top1_rate_euclid_lik": 4, "rates_": 4, "handout": 5, "walk": 5, "tailor": 5, "metal": 5, "organ": 5, "framework": 5, "construct": 5, "frozen": 5, "design": 5, "complementari": 5, "perturb": 5, "plausibl": 5, "variabl": 5, "simclr": 5, "instanc": 5, "infonc": 5, "invari": 5, "notat": 5, "compos": 5, "f_": 5, "theta": 5, "g_": 5, "phi": 5, "d_z": 5, "stochast": 5, "z_i": 5, "free": 5, "pursu": 5, "synthet": 5, "variat": 5, "robust": 5, "classifi": 5, "runtim": 5, "access": 5, "mof_yield_dataset": 5, "df_full": 5, "linker_smil": 5, "temperatur": 5, "time_h": 5, "concentration_m": 5, "solvent_dmf": 5, "renam": 5, "yield_pct": 5, "reproduc": 5, "default_rng": 5, "df_small": 5, "small_url_hint": 5, "mof_yield_dataset_100": 5, "linker": 5, "runnabl": 5, "int8": 5, "stai": 5, "proc_col": 5, "chem_col": 5, "x_proc_raw": 5, "x_chem_raw": 5, "sc_proc": 5, "x_proc": 5, "sc_chem_desc": 5, "x_desc4": 5, "x_bit": 5, "x_chem": 5, "hstack": 5, "underli": 5, "yet": 5, "think": 5, "nuisanc": 5, "jitter": 5, "simul": 5, "setpoint": 5, "sim": 5, "imput": 5, "mimic": 5, "wet": 5, "toler": 5, "imperfect": 5, "percept": 5, "uniform": 5, "mixup": 5, "synthes": 5, "beta": 5, "blend": 5, "augmentparam": 5, "proc_noise_std": 5, "proc_mask_p": 5, "chanc": 5, "chem_desc_noise_std": 5, "fp_dropout_p": 5, "p_weak": 5, "03": [5, 6], "p_strong": 5, "p_default": 5, "augment_for_contrast": 5, "correl": 5, "mixup_row": 5, "aug_proc_onc": 5, "x_proc_z": 5, "equal": 5, "aug_chem_onc": 5, "remaind": 5, "x_chem_ful": 5, "v1": 5, "v1_proc": 5, "v2_proc": 5, "v1_chem": 5, "v2_chem": 5, "n_new": 5, "lam": 5, "histogram": 5, "sne": [5, 6], "embed_2d": 5, "use_tsn": 5, "comparison": 5, "x_orig": 5, "x_aug": 5, "z0": 5, "z1": 5, "m_succ": 5, "m_fail": 5, "lightblu": 5, "orig": 5, "yellow": 5, "geometri": 5, "make_augmented_pool": 5, "xp": 5, "xc": 5, "n_aug_per_row": 5, "x_aug_pool": 5, "src_idx": 5, "src": 5, "xpp": 5, "xcc": 5, "float32": 5, "x_aug5": 5, "src5": 5, "z5": 5, "5x": 5, "y5": 5, "m5_succ": 5, "m5_fail": 5, "x5": 5, "t_1": 5, "t_2": 5, "2b": 5, "limits_": 5, "anchor": 5, "suffici": 5, "mutual": 5, "freez": 5, "logist": 5, "transfer": 5, "is_avail": 5, "consum": 5, "x_base": 5, "y_success": 5, "contrastivepair": 5, "__init__": 5, "__len__": 5, "__getitem__": 5, "fly": 5, "x1p": 5, "x2p": 5, "x1c": 5, "x2c": 5, "x1": 5, "from_numpi": 5, "params_train": 5, "drop_last": 5, "latent": 5, "mlpencod": 5, "in_dim": 5, "hid": 5, "super": 5, "net": 5, "projector": 5, "enc": 5, "proj": 5, "numel": 5, "nt_xent": 5, "temp": 5, "l2": 5, "keepdim": 5, "mm": 5, "ey": 5, "masked_fil": 5, "9e15": 5, "crossentropyloss": 5, "friendli": 5, "watch": 5, "adam": 5, "lr": 5, "weight_decai": 5, "loss_hist": 5, "h1": 5, "h2": 5, "zero_grad": 5, "backward": 5, "no_grad": 5, "stratifi": 5, "f1": 5, "roc": 5, "logisticregress": 5, "stratifiedkfold": 5, "f1_score": 5, "skf": 5, "n_split": 5, "clf": 5, "max_it": 5, "solver": 5, "lbfg": 5, "predict_proba": 5, "nanmean": 5, "against": 5, "clarifi": 5, "make_pipelin": 5, "x_raw": 5, "accs0": 5, "f1s0": 5, "aucs0": 5, "base_clf": 5, "p0": 5, "proba0": 5, "enlarg": 5, "eval_probe_with_augmult": 5, "h_all": 5, "htr": 5, "ytr": 5, "hte": 5, "yte": 5, "xp_tr": 5, "xc_tr": 5, "h_aug": 5, "y_aug": 5, "1x": 5, "one_x": 5, "five_x": 5, "0x": 5, "acc_m": 5, "acc_": 5, "f1_m": 5, "f1_": 5, "auc_m": 5, "soft": 5, "softmax": 5, "repuls": 5, "modest": 5, "correspond": 5, "beat": 5, "linearli": 5, "empir": 5, "collaps": 5, "trivial": 5, "descriptor": 6, "desc10_20": 6, "df10_20": 6, "fp_preview": 6, "slice": 6, "stat": 6, "nameerror": 6, "pca_desc_ful": 6, "group_to_color": 6, "pca_fp": 6, "z_fp_pca": 6, "order_eu": 6, "nn_eu_idx": 6, "nnearest": 6, "fp_string_to_bvect": 6, "s_tan": 6, "order_tan": 6, "nn_tan_idx": 6, "cols10": 6, "scaler10": 6, "x10": 6, "tsne10": 6, "z10": 6, "elbow": 6, "silhouett": 6, "sil_scor": 6, "best_k_sil": 6, "agglom": 6, "sweep": 6, "sil_agg": 6, "ward": 6, "labels_agg": 6, "best_k_agg": 6, "agg_best": 6, "labels_agg_best": 6}, "objects": {}, "objtypes": {}, "objnames": {}, "titleterms": {"welcom": 0, "chem": 0, "5080": 0, "ai": 0, "chemistri": [0, 5], "weekli": 0, "schedul": 0, "assign": 0, "project": [0, 5], "submiss": 0, "canva": 0, "lectur": [1, 2, 3, 4, 5, 6], "10": [1, 2, 3], "properti": 1, "reaction": 1, "predict": 1, "learn": [1, 2, 3, 4, 5], "goal": [1, 2, 3], "1": [1, 2, 3, 4, 5], "direct": 1, "messag": 1, "pass": 1, "neural": 1, "network": 1, "d": 1, "mpnn": 1, "2": [1, 2, 3, 4, 5], "data": [1, 2, 3, 5], "prepar": 1, "3": [1, 2, 3, 4, 5], "regress": 1, "pick": [1, 3], "block": 1, "build": [1, 2, 5], "model": [1, 4, 5], "trainer": 1, "train": [1, 5], "4": [1, 2, 3, 4, 5], "test": 1, "pariti": 1, "plot": [1, 3], "classif": 1, "dataset": [1, 5], "roc": 1, "curv": 1, "5": [1, 2, 3, 4, 5], "reactiv": 1, "select": 1, "classifi": 1, "6": [1, 2, 3, 5], "rational": 1, "solubl": 1, "7": [1, 3, 4, 5, 6], "chemprop": 1, "cli": 1, "command": 1, "line": 1, "interfac": 1, "c": 1, "h": 1, "oxid": 1, "quick": 1, "refer": 1, "8": [1, 4, 5, 6], "glossari": [1, 2, 3], "In": [1, 2, 3, 4], "class": [1, 2, 3, 4], "activ": [1, 2, 3, 4], "q1": [1, 2, 3, 6], "melt": 1, "point": 1, "q2": [1, 2, 3, 6], "toxic": 1, "student": 1, "challeng": 1, "solut": [1, 4, 6], "11": 2, "dimens": 2, "reduct": 2, "visual": [2, 5], "setup": [2, 3, 4, 5], "choic": 2, "supervis": [2, 3, 4, 5], "v": [2, 4, 5], "unsupervis": 2, "exercis": [2, 3], "princip": 2, "compon": 2, "analysi": 2, "pca": [2, 4], "leakag": 2, "set": 2, "standard": 2, "distanc": 2, "why": [2, 5], "which": 2, "us": 2, "note": [2, 4, 5], "nonlinear": 2, "embed": 2, "t": [2, 3], "sne": [2, 3], "umap": [2, 3], "featur": [2, 5], "print": 2, "compact": 2, "summari": 2, "descriptor": [2, 3, 4, 5], "q3": [2, 3, 6], "q4": [2, 3, 6], "morgan": 2, "64": 2, "fingerprint": [2, 5], "q5": [2, 6], "nearest": 2, "neighbor": 2, "12": [3, 4, 5, 6], "self": [3, 4, 5], "load": [3, 5], "kmean": 3, "cluster": 3, "fit": 3, "singl": 3, "k": [3, 4], "what": 3, "doe": 3, "sampl": 3, "look": 3, "like": 3, "valid": 3, "elbow": 3, "silhouett": 3, "score": 3, "altern": 3, "method": 3, "agglom": 3, "ward": 3, "dbscan": 3, "sweep": [3, 4], "0": 4, "section": [4, 5], "mask": 4, "imput": 4, "pretext": 4, "task": 4, "tip": 4, "charact": 4, "languag": 4, "smile": 4, "linear": [4, 5], "autoencod": 4, "via": 4, "contrast": [4, 5], "two": 4, "view": [4, 5], "cosin": 4, "option": [4, 5], "map": 4, "encod": [4, 5], "code": 4, "ridg": 4, "residu": 4, "n": 4, "hit": 4, "error": 4, "molwt": 4, "nois": 4, "alt": 4, "similar": 4, "augment": 5, "pretrain": 5, "mof": 5, "synthesi": 5, "tabular": 5, "molecular": 5, "subset": 5, "split": 5, "process": 5, "oper": 5, "inspect": 5, "effect": 5, "math": 5, "pair": 5, "probe": 5, "torch": 5, "wrapper": 5, "head": 5, "nt": 5, "xent": 5, "loss": 5, "represent": 5, "success": 5, "failur": 5, "baselin": 5, "without": 5, "time": 5, "multipl": 5, "practic": 5, "equat": 5, "glanc": 5}, "envversion": {"sphinx.domains.c": 3, "sphinx.domains.changeset": 1, "sphinx.domains.citation": 1, "sphinx.domains.cpp": 9, "sphinx.domains.index": 1, "sphinx.domains.javascript": 3, "sphinx.domains.math": 2, "sphinx.domains.python": 4, "sphinx.domains.rst": 2, "sphinx.domains.std": 2, "sphinx.ext.intersphinx": 1, "sphinxcontrib.bibtex": 9, "sphinx": 58}, "alltitles": {"Welcome to CHEM 5080: AI for Chemistry": [[0, "welcome-to-chem-5080-ai-for-chemistry"]], "Weekly Schedule": [[0, null]], "Assignments & Project Submissions (Canvas)  ": [[0, null]], "Lecture 10 - Property & Reaction Prediction": [[1, "lecture-10-property-reaction-prediction"]], "Learning goals": [[1, "learning-goals"], [2, "learning-goals"], [3, "learning-goals"]], "1. Directed message-passing neural network (D-MPNN)": [[1, "directed-message-passing-neural-network-d-mpnn"]], "2. Data preparation": [[1, "data-preparation"]], "3. Property prediction (regression)": [[1, "property-prediction-regression"]], "3.1 Pick blocks": [[1, "pick-blocks"]], "3.2 Build model and trainer": [[1, "build-model-and-trainer"]], "3.3 Train": [[1, "train"]], "3.4 Test and parity plot": [[1, "test-and-parity-plot"]], "4. Property prediction (classification)": [[1, "property-prediction-classification"]], "4.1 Build classification dataset": [[1, "build-classification-dataset"]], "4.2 Model and training": [[1, "model-and-training"]], "4.3 ROC curve": [[1, "roc-curve"]], "5. Reactivity and selectivity": [[1, "reactivity-and-selectivity"]], "5.1 Reactivity classifier": [[1, "reactivity-classifier"]], "6. Rationale": [[1, "rationale"]], "6.1 Solubility prediction rationale": [[1, "solubility-prediction-rationale"]], "6.2 Reactivity prediction rationale": [[1, "reactivity-prediction-rationale"]], "7. Chemprop CLI (Command-Line Interface)": [[1, "chemprop-cli-command-line-interface"]], "7.3 Reactivity classification (C\u2013H oxidation dataset)": [[1, "reactivity-classification-ch-oxidation-dataset"]], "7. Quick Reference": [[1, "quick-reference"]], "8. Glossary": [[1, "glossary"]], "10. In\u2011class activity": [[1, "inclass-activity"]], "Q1. Chemprop regression on melting point": [[1, "q1-chemprop-regression-on-melting-point"]], "Q2. Chemprop classification on toxicity (student challenge)": [[1, "q2-chemprop-classification-on-toxicity-student-challenge"]], "Solution Q1:": [[1, "solution-q1"]], "Solution Q2": [[1, "solution-q2"]], "Lecture 11 - Dimension Reduction for Data Visualization": [[2, "lecture-11-dimension-reduction-for-data-visualization"]], "1. Setup and data": [[2, "setup-and-data"]], "Data choices": [[2, null]], "2. Supervised vs unsupervised": [[2, "supervised-vs-unsupervised"]], "\u23f0 Exercise 2": [[2, null]], "2.1 Principal Component Analysis (PCA)": [[2, "principal-component-analysis-pca"]], "2.2 Data leakage in unsupervised settings": [[2, "data-leakage-in-unsupervised-settings"]], "3. Standardization and distance": [[2, "standardization-and-distance"]], "3.1 Why standardize": [[2, "why-standardize"]], "3.2 Which distance to use": [[2, "which-distance-to-use"]], "Note": [[2, null], [2, null], [2, null], [4, null]], "4. Nonlinear embeddings: t-SNE and UMAP": [[2, "nonlinear-embeddings-t-sne-and-umap"]], "4.1 t-SNE": [[2, "t-sne"]], "4.2 UMAP": [[2, "umap"]], "5. Glossary": [[2, "glossary"]], "6. In-class activity": [[2, "in-class-activity"]], "Q1. Build feature sets and print compact summaries": [[2, "q1-build-feature-sets-and-print-compact-summaries"]], "Q2. PCA on 10 descriptors": [[2, "q2-pca-on-10-descriptors"]], "Q3. t-SNE on 10 descriptors": [[2, "q3-t-sne-on-10-descriptors"]], "Q4. PCA and t-SNE on Morgan-64 fingerprints": [[2, "q4-pca-and-t-sne-on-morgan-64-fingerprints"]], "Q5. Nearest 5 neighbors - descriptors vs fingerprints": [[2, "q5-nearest-5-neighbors-descriptors-vs-fingerprints"]], "Lecture 12 - Self-supervised Learning": [[3, "lecture-12-self-supervised-learning"]], "1. Setup": [[3, "setup"]], "2. Data Loading": [[3, "data-loading"]], "3. KMeans on clustering": [[3, "kmeans-on-clustering"]], "3.1 Fit KMeans for a single k": [[3, "fit-kmeans-for-a-single-k"]], "\u23f0 Exercise": [[3, null], [3, null]], "3.2 What does a single sample look like": [[3, "what-does-a-single-sample-look-like"]], "3.3 KMeans on t-SNE and UMAP": [[3, "kmeans-on-t-sne-and-umap"]], "4. Picking k and validating clusters": [[3, "picking-k-and-validating-clusters"]], "4.1 Elbow plot": [[3, "elbow-plot"]], "4.2 Silhouette score": [[3, "silhouette-score"]], "\u23f0 Exercise 4": [[3, null]], "5. Alternative clustering methods": [[3, "alternative-clustering-methods"]], "5.1 Agglomerative (Ward)": [[3, "agglomerative-ward"]], "5.2 DBSCAN": [[3, "dbscan"]], "6. Glossary": [[3, "glossary"]], "7. In-class activity": [[3, "in-class-activity"]], "Q1. t-SNE on 10 descriptors": [[3, "q1-t-sne-on-10-descriptors"]], "Q2. Elbow on KMeans": [[3, "q2-elbow-on-kmeans"]], "Q3. Silhouette on KMeans": [[3, "q3-silhouette-on-kmeans"]], "Q4. Agglomerative sweep with plots": [[3, "q4-agglomerative-sweep-with-plots"]], "Lecture 12 \u2014 Self-supervised Learning": [[4, "lecture-12-self-supervised-learning"], [5, "lecture-12-self-supervised-learning"]], "0. Setup for sections 7\u20138": [[4, "setup-for-sections-78"]], "7. In-class activities": [[4, "in-class-activities"]], "7.1 Masked descriptor imputation (pretext task)": [[4, "masked-descriptor-imputation-pretext-task"]], "Tip": [[4, null]], "7.2 Character language model for SMILES": [[4, "character-language-model-for-smiles"]], "7.3 Linear autoencoder via PCA on descriptors": [[4, "linear-autoencoder-via-pca-on-descriptors"]], "7.4 Contrast of two descriptor views with cosine": [[4, "contrast-of-two-descriptor-views-with-cosine"]], "7.5 Optional: map the encoder codes": [[4, "optional-map-the-encoder-codes"]], "8. Solutions": [[4, "solutions"], [6, "solutions"]], "Solution 7.1 Ridge and residuals": [[4, "solution-7-1-ridge-and-residuals"]], "Solution 7.2 n=4 and masked hit@5": [[4, "solution-7-2-n-4-and-masked-hit-5"]], "Solution 7.3 k=3 and error vs MolWt": [[4, "solution-7-3-k-3-and-error-vs-molwt"]], "Solution 7.4 Noise sweep and alt similarity": [[4, "solution-7-4-noise-sweep-and-alt-similarity"]], "Solution 7.5 Code map": [[4, "solution-7-5-code-map"]], "Sections 6 and 7: Data augmentation and contrastive pretraining for MOF synthesis": [[5, "sections-6-and-7-data-augmentation-and-contrastive-pretraining-for-mof-synthesis"]], "6. Data augmentation for MOF synthesis (tabular + molecular)": [[5, "data-augmentation-for-mof-synthesis-tabular-molecular"]], "6.1 Load and subset the MOF dataset": [[5, "load-and-subset-the-mof-dataset"]], "6.2 Descriptor and fingerprint features": [[5, "descriptor-and-fingerprint-features"]], "6.3 Split into process and chemistry views": [[5, "split-into-process-and-chemistry-views"]], "6.4 Why these augmentations": [[5, "why-these-augmentations"]], "6.5 Augmentation operators": [[5, "augmentation-operators"]], "6.6 Inspect the effect of augmentation": [[5, "inspect-the-effect-of-augmentation"]], "6.7 Math for contrastive pairs": [[5, "math-for-contrastive-pairs"]], "7. Contrastive pretraining and a linear probe": [[5, "contrastive-pretraining-and-a-linear-probe"]], "7.1 Torch setup and data wrappers": [[5, "torch-setup-and-data-wrappers"]], "7.2 Encoder and projection head": [[5, "encoder-and-projection-head"]], "7.3 NT-Xent loss": [[5, "nt-xent-loss"]], "7.4 Train the contrastive model": [[5, "train-the-contrastive-model"]], "7.5 Build representations and visualize": [[5, "build-representations-and-visualize"]], "7.6 Linear probe: success vs failure": [[5, "linear-probe-success-vs-failure"]], "7.7 Baseline without pretraining": [[5, "baseline-without-pretraining"]], "7.8 Optional: training-time augmentation multiplicity for the probe": [[5, "optional-training-time-augmentation-multiplicity-for-the-probe"]], "Practical notes and equations at a glance": [[5, "practical-notes-and-equations-at-a-glance"]], "7. Solution": [[6, "solution"]], "Q1": [[6, "q1"]], "Q2": [[6, "q2"]], "Q3": [[6, "q3"]], "Q4": [[6, "q4"]], "Q5": [[6, "q5"]], "Lecture 12": [[6, "lecture-12"]]}, "indexentries": {"pca": [[2, "term-PCA"]], "umap": [[2, "term-UMAP"]], "dimension reduction": [[2, "term-dimension-reduction"]], "loading": [[2, "term-loading"]], "scree plot": [[2, "term-scree-plot"]], "t-sne": [[2, "term-t-SNE"]], "agglomerative clustering": [[3, "term-Agglomerative-clustering"]], "dbscan (density-based spatial clustering of applications with noise)": [[3, "term-DBSCAN-Density-Based-Spatial-Clustering-of-Applications-with-Noise"]], "kmeans": [[3, "term-KMeans"]], "tanimoto / jaccard similarity": [[3, "term-Tanimoto-Jaccard-similarity"]], "clustering": [[3, "term-clustering"]], "elbow method": [[3, "term-elbow-method"]], "silhouette score": [[3, "term-silhouette-score"]]}})