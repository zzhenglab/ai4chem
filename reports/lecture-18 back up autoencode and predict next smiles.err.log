Traceback (most recent call last):
  File "C:\Users\52377\AppData\Local\Programs\Python\Python313\Lib\site-packages\jupyter_core\utils\__init__.py", line 154, in wrapped
    asyncio.get_running_loop()
    ~~~~~~~~~~~~~~~~~~~~~~~~^^
RuntimeError: no running event loop

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\52377\AppData\Local\Programs\Python\Python313\Lib\site-packages\jupyter_cache\executors\utils.py", line 58, in single_nb_execution
    executenb(
    ~~~~~~~~~^
        nb,
        ^^^
    ...<4 lines>...
        **kwargs,
        ^^^^^^^^^
    )
    ^
  File "C:\Users\52377\AppData\Local\Programs\Python\Python313\Lib\site-packages\nbclient\client.py", line 1319, in execute
    return NotebookClient(nb=nb, resources=resources, km=km, **kwargs).execute()
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\52377\AppData\Local\Programs\Python\Python313\Lib\site-packages\jupyter_core\utils\__init__.py", line 158, in wrapped
    return loop.run_until_complete(inner)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\52377\AppData\Local\Programs\Python\Python313\Lib\asyncio\base_events.py", line 725, in run_until_complete
    return future.result()
           ~~~~~~~~~~~~~^^
  File "C:\Users\52377\AppData\Local\Programs\Python\Python313\Lib\site-packages\nbclient\client.py", line 709, in async_execute
    await self.async_execute_cell(
        cell, index, execution_count=self.code_cells_executed + 1
    )
  File "C:\Users\52377\AppData\Local\Programs\Python\Python313\Lib\site-packages\nbclient\client.py", line 1062, in async_execute_cell
    await self._check_raise_for_error(cell, cell_index, exec_reply)
  File "C:\Users\52377\AppData\Local\Programs\Python\Python313\Lib\site-packages\nbclient\client.py", line 918, in _check_raise_for_error
    raise CellExecutionError.from_cell_and_msg(cell, exec_reply_content)
nbclient.exceptions.CellExecutionError: An error occurred while executing the following cell:
------------------
from sklearn.impute import SimpleImputer
from sklearn.linear_model import LinearRegression
from sklearn.metrics import r2_score

col_scores = {}
for j, col in enumerate(desc_cols):
    X_tr, X_te = train_test_split(X, test_size=0.25, random_state=42)
    y_tr, y_te = X_tr[:, j].copy(), X_te[:, j].copy()

    X_trm = X_tr.copy(); X_trm[:, j] = np.nan
    X_tem = X_te.copy(); X_tem[:, j] = np.nan

    imp = SimpleImputer(strategy="mean").fit(X_trm)
    X_trf = imp.transform(X_trm)
    X_tef = imp.transform(X_tem)

    X_tr_use = np.delete(X_trf, j, axis=1)
    X_te_use = np.delete(X_tef, j, axis=1)

    reg = LinearRegression().fit(X_tr_use, y_tr)
    y_hat = reg.predict(X_te_use)
    col_scores[col] = r2_score(y_te, y_hat)

pd.Series(col_scores).sort_values(ascending=False).round(3)
------------------


[31m---------------------------------------------------------------------------[39m
[31mIndexError[39m                                Traceback (most recent call last)
[36mCell[39m[36m [39m[32mIn[6][39m[32m, line 17[39m
[32m     14[39m X_trf = imp.transform(X_trm)
[32m     15[39m X_tef = imp.transform(X_tem)
[32m---> [39m[32m17[39m X_tr_use = [43mnp[49m[43m.[49m[43mdelete[49m[43m([49m[43mX_trf[49m[43m,[49m[43m [49m[43mj[49m[43m,[49m[43m [49m[43maxis[49m[43m=[49m[32;43m1[39;49m[43m)[49m
[32m     18[39m X_te_use = np.delete(X_tef, j, axis=[32m1[39m)
[32m     20[39m reg = LinearRegression().fit(X_tr_use, y_tr)

[36mFile [39m[32m~\AppData\Local\Programs\Python\Python313\Lib\site-packages\numpy\lib\_function_base_impl.py:5437[39m, in [36mdelete[39m[34m(arr, obj, axis)[39m
[32m   5434[39m [38;5;28;01mif[39;00m single_value:
[32m   5435[39m     [38;5;66;03m# optimization for a single value[39;00m
[32m   5436[39m     [38;5;28;01mif[39;00m (obj < -N [38;5;129;01mor[39;00m obj >= N):
[32m-> [39m[32m5437[39m         [38;5;28;01mraise[39;00m [38;5;167;01mIndexError[39;00m(
[32m   5438[39m             [33mf[39m[33m"[39m[33mindex [39m[38;5;132;01m{[39;00mobj[38;5;132;01m}[39;00m[33m is out of bounds for axis [39m[38;5;132;01m{[39;00maxis[38;5;132;01m}[39;00m[33m with [39m[33m"[39m
[32m   5439[39m             [33mf[39m[33m"[39m[33msize [39m[38;5;132;01m{[39;00mN[38;5;132;01m}[39;00m[33m"[39m)
[32m   5440[39m     [38;5;28;01mif[39;00m (obj < [32m0[39m):
[32m   5441[39m         obj += N

[31mIndexError[39m: index 9 is out of bounds for axis 1 with size 9

