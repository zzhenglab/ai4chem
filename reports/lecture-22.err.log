Traceback (most recent call last):
  File "C:\Users\52377\AppData\Local\Programs\Python\Python313\Lib\site-packages\jupyter_core\utils\__init__.py", line 154, in wrapped
    asyncio.get_running_loop()
    ~~~~~~~~~~~~~~~~~~~~~~~~^^
RuntimeError: no running event loop

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\52377\AppData\Local\Programs\Python\Python313\Lib\site-packages\jupyter_cache\executors\utils.py", line 58, in single_nb_execution
    executenb(
    ~~~~~~~~~^
        nb,
        ^^^
    ...<4 lines>...
        **kwargs,
        ^^^^^^^^^
    )
    ^
  File "C:\Users\52377\AppData\Local\Programs\Python\Python313\Lib\site-packages\nbclient\client.py", line 1319, in execute
    return NotebookClient(nb=nb, resources=resources, km=km, **kwargs).execute()
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\52377\AppData\Local\Programs\Python\Python313\Lib\site-packages\jupyter_core\utils\__init__.py", line 158, in wrapped
    return loop.run_until_complete(inner)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\52377\AppData\Local\Programs\Python\Python313\Lib\asyncio\base_events.py", line 725, in run_until_complete
    return future.result()
           ~~~~~~~~~~~~~^^
  File "C:\Users\52377\AppData\Local\Programs\Python\Python313\Lib\site-packages\nbclient\client.py", line 709, in async_execute
    await self.async_execute_cell(
        cell, index, execution_count=self.code_cells_executed + 1
    )
  File "C:\Users\52377\AppData\Local\Programs\Python\Python313\Lib\site-packages\nbclient\client.py", line 1062, in async_execute_cell
    await self._check_raise_for_error(cell, cell_index, exec_reply)
  File "C:\Users\52377\AppData\Local\Programs\Python\Python313\Lib\site-packages\nbclient\client.py", line 918, in _check_raise_for_error
    raise CellExecutionError.from_cell_and_msg(cell, exec_reply_content)
nbclient.exceptions.CellExecutionError: An error occurred while executing the following cell:
------------------
# pip installs are kept separate so you can see which step fails.
try:
    import torch, torchvision, PIL, sklearn, matplotlib, numpy  # quick smoke test
except Exception as e:
    print("Installing required packages...")
#     %pip -q install torch torchvision --index-url https://download.pytorch.org/whl/cpu
#     %pip -q install ftfy regex tqdm onnxruntime matplotlib scikit-learn pillow einops requests

# Install CLIP from the official repository
try:
    import clip  # noqa
except Exception:
    %pip -q install git+https://github.com/openai/CLIP.git

from openai import OpenAI  # noqa

#     %pip -q install openai>=1.40.0
# 0.2 Imports and basic config
import os, json, math, random, io, textwrap, time, pathlib, itertools
import numpy as np
import pandas as pd
import torch
import torch.nn as nn
import torch.nn.functional as F
import matplotlib.pyplot as plt
from PIL import Image
from sklearn.metrics import classification_report, confusion_matrix, accuracy_score
from sklearn.linear_model import LogisticRegression
from sklearn.metrics import confusion_matrix, ConfusionMatrixDisplay, roc_curve, auc
from sklearn.decomposition import PCA
from sklearn.manifold import TSNE
import requests
from sklearn.model_selection import StratifiedShuffleSplit, train_test_split
from matplotlib.offsetbox import OffsetImage, AnnotationBbox
from openai import OpenAI
from io import BytesIO

import clip  # OpenAI CLIP
SEED = 42
random.seed(SEED); np.random.seed(SEED); torch.manual_seed(SEED)

device = "cuda" if torch.cuda.is_available() else "cpu"
print("Device:", device)
------------------

----- stderr -----
  DEPRECATION: Building 'clip' using the legacy setup.py bdist_wheel mechanism, which will be removed in a future version. pip 25.3 will enforce this behaviour change. A possible replacement is to use the standardized build interface by setting the `--use-pep517` option, (possibly combined with `--no-build-isolation`), or adding a `pyproject.toml` file to the source tree of 'clip'. Discussion can be found at https://github.com/pypa/pip/issues/6334

[notice] A new release of pip is available: 25.1.1 -> 25.3
[notice] To update, run: python.exe -m pip install --upgrade pip
----- stdout -----
Note: you may need to restart the kernel to use updated packages.
------------------

[31m---------------------------------------------------------------------------[39m
[31mModuleNotFoundError[39m                       Traceback (most recent call last)
[36mCell[39m[36m [39m[32mIn[1][39m[32m, line 15[39m
[32m     12[39m [38;5;28;01mexcept[39;00m [38;5;167;01mException[39;00m:
[32m     13[39m     get_ipython().run_line_magic([33m'[39m[33mpip[39m[33m'[39m, [33m'[39m[33m-q install git+https://github.com/openai/CLIP.git[39m[33m'[39m)
[32m---> [39m[32m15[39m [38;5;28;01mfrom[39;00m[38;5;250m [39m[34;01mopenai[39;00m[38;5;250m [39m[38;5;28;01mimport[39;00m OpenAI  [38;5;66;03m# noqa[39;00m
[32m     17[39m [38;5;66;03m#     %pip -q install openai>=1.40.0[39;00m
[32m     18[39m [38;5;66;03m# 0.2 Imports and basic config[39;00m
[32m     19[39m [38;5;28;01mimport[39;00m[38;5;250m [39m[34;01mos[39;00m,[38;5;250m [39m[34;01mjson[39;00m,[38;5;250m [39m[34;01mmath[39;00m,[38;5;250m [39m[34;01mrandom[39;00m,[38;5;250m [39m[34;01mio[39;00m,[38;5;250m [39m[34;01mtextwrap[39;00m,[38;5;250m [39m[34;01mtime[39;00m,[38;5;250m [39m[34;01mpathlib[39;00m,[38;5;250m [39m[34;01mitertools[39;00m

[31mModuleNotFoundError[39m: No module named 'openai'

