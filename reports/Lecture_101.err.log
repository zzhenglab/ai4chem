Traceback (most recent call last):
  File "c:\users\52377\appdata\local\programs\python\python38\lib\site-packages\jupyter_core\utils\__init__.py", line 154, in wrapped
    asyncio.get_running_loop()
RuntimeError: no running event loop

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\users\52377\appdata\local\programs\python\python38\lib\site-packages\jupyter_cache\executors\utils.py", line 58, in single_nb_execution
    executenb(
  File "c:\users\52377\appdata\local\programs\python\python38\lib\site-packages\nbclient\client.py", line 1305, in execute
    return NotebookClient(nb=nb, resources=resources, km=km, **kwargs).execute()
  File "c:\users\52377\appdata\local\programs\python\python38\lib\site-packages\jupyter_core\utils\__init__.py", line 158, in wrapped
    return loop.run_until_complete(inner)
  File "c:\users\52377\appdata\local\programs\python\python38\lib\asyncio\base_events.py", line 616, in run_until_complete
    return future.result()
  File "c:\users\52377\appdata\local\programs\python\python38\lib\site-packages\nbclient\client.py", line 705, in async_execute
    await self.async_execute_cell(
  File "c:\users\52377\appdata\local\programs\python\python38\lib\site-packages\nbclient\client.py", line 1058, in async_execute_cell
    await self._check_raise_for_error(cell, cell_index, exec_reply)
  File "c:\users\52377\appdata\local\programs\python\python38\lib\site-packages\nbclient\client.py", line 914, in _check_raise_for_error
    raise CellExecutionError.from_cell_and_msg(cell, exec_reply_content)
nbclient.exceptions.CellExecutionError: An error occurred while executing the following cell:
------------------
# 1. Setup

EPOCHS = 50  # you can change this number by your own

import warnings, math, os, sys, json, time, random
warnings.filterwarnings("ignore")

import numpy as np
import pandas as pd
import matplotlib.pyplot as plt
import networkx as nx
from pathlib import Path
import torch



# Sklearn bits for splitting and metrics
from sklearn.model_selection import train_test_split
from sklearn.preprocessing import StandardScaler
from sklearn.pipeline import Pipeline
from sklearn.compose import TransformedTargetRegressor
from sklearn.tree import DecisionTreeRegressor
from sklearn.ensemble import RandomForestRegressor
from sklearn.neural_network import MLPRegressor


from sklearn.metrics import (mean_squared_error, mean_absolute_error, r2_score,
                             accuracy_score, precision_score, recall_score,
                             f1_score, roc_auc_score, roc_curve, confusion_matrix)
# chemprop
try:
    import chemprop
    try:
      from chemprop import data, featurizers, models, nn
    except:
      from chemprop import data, features, models
    try:
        from lightning import pytorch as pl
    except ImportError:
        import pytorch_lightning as pl
    from chemprop.data import make_split_indices, split_data_by_indices

except Exception:
    %pip -q install chemprop
    try:
        from chemprop import data, featurizers, models
    except:
        from chemprop import data, features, models
    import pytorch_lightning as pl
    from chemprop.data import make_split_indices, split_data_by_indices


import logging
logging.getLogger("chemprop.data.splitting").setLevel(logging.ERROR)

# RDKit
try:
    from rdkit import Chem
    from rdkit.Chem import Draw, Descriptors, Crippen, rdMolDescriptors, AllChem
except Exception:
    try:
        %pip install rdkit
        from rdkit import Chem
        from rdkit.Chem import Draw, Descriptors, Crippen, rdMolDescriptors, AllChem
    except Exception as e:
        print("RDKit is not available in this environment. Drawing and descriptors will be skipped.")
        Chem = None

------------------

----- stdout -----
Note: you may need to restart the kernel to use updated packages.
------------------

[1;31m---------------------------------------------------------------------------[0m
[1;31mImportError[0m                               Traceback (most recent call last)
Cell [1;32mIn[1], line 41[0m
[0;32m     40[0m         [38;5;28;01mimport[39;00m[38;5;250m [39m[38;5;21;01mpytorch_lightning[39;00m[38;5;250m [39m[38;5;28;01mas[39;00m[38;5;250m [39m[38;5;21;01mpl[39;00m
[1;32m---> 41[0m     [38;5;28;01mfrom[39;00m[38;5;250m [39m[38;5;21;01mchemprop[39;00m[38;5;21;01m.[39;00m[38;5;21;01mdata[39;00m[38;5;250m [39m[38;5;28;01mimport[39;00m make_split_indices, split_data_by_indices
[0;32m     43[0m [38;5;28;01mexcept[39;00m [38;5;167;01mException[39;00m:

[1;31mImportError[0m: cannot import name 'make_split_indices' from 'chemprop.data' (c:\users\52377\appdata\local\programs\python\python38\lib\site-packages\chemprop\data\__init__.py)

During handling of the above exception, another exception occurred:

[1;31mImportError[0m                               Traceback (most recent call last)
Cell [1;32mIn[1], line 50[0m
[0;32m     48[0m         [38;5;28;01mfrom[39;00m[38;5;250m [39m[38;5;21;01mchemprop[39;00m[38;5;250m [39m[38;5;28;01mimport[39;00m data, features, models
[0;32m     49[0m     [38;5;28;01mimport[39;00m[38;5;250m [39m[38;5;21;01mpytorch_lightning[39;00m[38;5;250m [39m[38;5;28;01mas[39;00m[38;5;250m [39m[38;5;21;01mpl[39;00m
[1;32m---> 50[0m     [38;5;28;01mfrom[39;00m[38;5;250m [39m[38;5;21;01mchemprop[39;00m[38;5;21;01m.[39;00m[38;5;21;01mdata[39;00m[38;5;250m [39m[38;5;28;01mimport[39;00m make_split_indices, split_data_by_indices
[0;32m     53[0m [38;5;28;01mimport[39;00m[38;5;250m [39m[38;5;21;01mlogging[39;00m
[0;32m     54[0m logging[38;5;241m.[39mgetLogger([38;5;124m"[39m[38;5;124mchemprop.data.splitting[39m[38;5;124m"[39m)[38;5;241m.[39msetLevel(logging[38;5;241m.[39mERROR)

[1;31mImportError[0m: cannot import name 'make_split_indices' from 'chemprop.data' (c:\users\52377\appdata\local\programs\python\python38\lib\site-packages\chemprop\data\__init__.py)

